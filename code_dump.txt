-e 

===== ./tutor/dashboard/gdpr.php =====



<?php
/**
 * Tutor LMS Dashboard – GDPR Tab
 */

// Use the abstracted template loading function

yiontech_lms_load_template('inc/features/gdpr/templates/template.php');-e 

===== ./tutor/dashboard/registration.php =====

<?php
/**
 * Tutor LMS Dashboard – Registration Tab
 */

// Use the abstracted template loading function
yiontech_lms_load_template('inc/features/registration-modifier/templates/registration-blank-template.php');
-e 

===== ./tutor/dashboard/document-upload.php =====

<?php
/**
 * Tutor LMS Dashboard – Documents Tab
 */

// Use the abstracted template loading function
yiontech_lms_load_template('inc/features/document-upload/template.php');
-e 

===== ./tutor/dashboard/my-profile.php =====

<?php
/**
 * My Profile Page with UK-style Registration Number (No Dashes, Year as 2 digits)
 *
 * @package Yiontech_LMS
 */

if (!defined('ABSPATH')) {
    exit;
}

$uid  = get_current_user_id();
$user = get_userdata( $uid );

if (!$user) {
    echo '<div class="tutor-alert tutor-warning">' . esc_html__( 'User not found.', 'yiontech-lms' ) . '</div>';
    return;
}

// Site info
$site_name = get_bloginfo('name');
$site_code = strtoupper( wp_trim_words( preg_replace('/[^A-Za-z]/', '', $site_name), 1, '' ) );
$site_code = substr( str_pad( $site_code, 3, 'X' ), 0, 3 ); // ensure 3 letters

// User info
$rdate = $user->user_registered;
$year  = $rdate ? date_i18n( 'y', strtotime( $rdate ) ) : date_i18n( 'y' ); // last 2 digits of the year
$fname = $user->first_name;
$lname = $user->last_name;
$uname = $user->user_login;
$email = $user->user_email;
$phone = get_user_meta( $uid, 'phone_number', true );
$job   = wp_kses( get_user_meta( $uid, '_tutor_profile_job_title', true ), array( 'br' => array() ) ) ?: '-';
$bio   = get_user_meta( $uid, '_tutor_profile_bio', true );

// Generate UK-style Registration Number without dashes: ABCYYXXXXX
$reg_number = sprintf( '%s%s%05d', esc_html( $site_code ), esc_html( $year ), intval( $uid ) );

$profile_data = array(
    array( __( 'Registration Number', 'yiontech-lms' ), $reg_number ),
    array( __( 'Registration Date', 'yiontech-lms' ), ( $rdate ? esc_html( date_i18n( get_option( 'date_format' ), strtotime( $rdate ) ) ) : '' ) ),
    array( __( 'First Name', 'yiontech-lms' ), ( $fname ? esc_html( $fname ) : esc_html( '-' ) ) ),
    array( __( 'Last Name', 'yiontech-lms' ), ( $lname ? esc_html( $lname ) : esc_html( '-' ) ) ),
    array( __( 'Username', 'yiontech-lms' ), esc_html( $uname ) ),
    array( __( 'Email', 'yiontech-lms' ), esc_html( $email ) ),
    array( __( 'Phone Number', 'yiontech-lms' ), ( $phone ? esc_html( $phone ) : esc_html( '-' ) ) ),
    array( __( 'Skill/Occupation', 'yiontech-lms' ), wp_kses_post( $job ) ),
    array( __( 'Biography', 'yiontech-lms' ), $bio ? wp_kses_post( $bio ) : esc_html( '-' ) ),
);
?>

<div class="tutor-fs-5 tutor-fw-medium tutor-color-black tutor-mb-24"><?php esc_html_e( 'My Profile', 'yiontech-lms' ); ?></div>
<div class="tutor-dashboard-content-inner tutor-dashboard-profile-data">
    <?php
    foreach ( $profile_data as $key => $data ) :
        ?>
        <div class="tutor-row tutor-mb-24">
            <div class="tutor-col-12 tutor-col-sm-5 tutor-col-lg-3">
                <span class="tutor-fs-6 tutor-color-secondary"><?php echo esc_html( $data[0] ); ?></span>
            </div>
            <div class="tutor-col-12 tutor-col-sm-7 tutor-col-lg-9">
            <?php
            if ( 'Biography' === $data[0] || __( 'Biography', 'yiontech-lms' ) === $data[0] ) {
                echo '<span class="tutor-fs-6 tutor-color-secondary">' . wp_kses_post( $data[1] ) . '</span>';
            } else {
                echo '<span class="tutor-fs-6 tutor-fw-medium tutor-color-black">' . esc_html( $data[1] ) . '</span>';
            }
            ?>
            </div>
        </div>
    <?php endforeach; ?>
</div>
-e 

===== ./tutor/login.php =====

<?php
/**
 * Tutor LMS redirect to Custom Login 
 */

// Use the abstracted template loading function
yiontech_lms_load_template('inc/features/login-modifier/templates/login-blank-template.php');
-e 

===== ./index.php =====

<?php get_header(); ?>
<div class="site-content">
    <div class="max-w-7xl mx-auto px-4 py-8 overflow-hidden">
        <div class="flex flex-col md:flex-row">
            <div class="w-full md:w-2/3 md:pr-8 overflow-hidden">
                <h1 class="text-3xl font-bold mb-6">Available Courses</h1>
                
                <?php
                // Check if Tutor LMS is active
                if (function_exists('tutor_utils')) {
                    // Get Tutor LMS courses using WP_Query
                    $courses_query = new WP_Query([
                        'post_type' => 'courses',
                        'post_status' => 'publish',
                        'orderby' => 'post_date',
                        'order' => 'DESC',
                        'posts_per_page' => 12
                    ]);
                    
                    if ($courses_query->have_posts()) :
                        ?>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 overflow-hidden">
                            <?php while ($courses_query->have_posts()) : $courses_query->the_post(); ?>
                                <?php get_template_part('template-parts/content', 'course'); ?>
                            <?php endwhile; ?>
                        </div>
                        
                        <div class="mt-8">
                            <?php
                            // Pagination for courses
                            echo paginate_links(array(
                                'total' => $courses_query->max_num_pages,
                                'prev_text' => __('&laquo; Previous', 'yiontech-lms'),
                                'next_text' => __('Next &raquo;', 'yiontech-lms'),
                                'type' => 'list',
                                'before_page_number' => '<span class="mx-1">',
                                'after_page_number' => '</span>',
                            ));
                            ?>
                        </div>
                        <?php
                        wp_reset_postdata();
                    else :
                        ?>
                        <div class="bg-white rounded-lg shadow-md p-8 text-center">
                            <h2 class="text-2xl font-bold mb-4">No Courses Available</h2>
                            <p>Check back later for new courses.</p>
                        </div>
                        <?php
                    endif;
                } else {
                    // Fallback if Tutor LMS is not active
                    ?>
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-yellow-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor">
                                    <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                                </svg>
                            </div>
                            <div class="ml-3">
                                <p class="text-sm text-yellow-700">
                                    Tutor LMS plugin is not active. Please activate it to display courses.
                                </p>
                            </div>
                        </div>
                    </div>
                    <?php
                    // Display regular posts as fallback
                    if (have_posts()) :
                        ?>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 overflow-hidden">
                            <?php while (have_posts()) : the_post(); ?>
                                <?php get_template_part('template-parts/content', get_post_format()); ?>
                            <?php endwhile; ?>
                        </div>
                        
                        <div class="mt-8">
                            <?php the_posts_pagination(array(
                                'mid_size' => 2,
                                'prev_text' => __('&laquo; Previous', 'yiontech-lms'),
                                'next_text' => __('Next &raquo;', 'yiontech-lms'),
                            )); ?>
                        </div>
                        <?php
                    else :
                        get_template_part('template-parts/content', 'none');
                    endif;
                }
                ?>
            </div>
            <div class="w-full md:w-1/3 mt-8 md:mt-0">
                <?php get_sidebar(); ?>
            </div>
        </div>
    </div>
</div>
<?php get_footer(); ?>-e 

===== ./single.php =====

<?php get_header(); ?>
<?php 
while (have_posts()) : the_post(); 
    // Check if Elementor is being used for this post
    if (function_exists('\\Elementor\\Plugin') && \Elementor\Plugin::$instance->documents->get(get_the_ID())->is_built_with_elementor()) {
        // Full width for Elementor pages
        the_content();
    } else {
        // Regular theme layout with container
        ?>
        <div class="max-w-7xl mx-auto px-4 py-8">
            <div class="flex flex-col md:flex-row">
                <div class="w-full md:w-2/3 md:pr-8">
                    <article id="post-<?php the_ID(); ?>" <?php post_class('bg-white rounded-lg shadow-md overflow-hidden mb-8'); ?>>
                        <header class="p-0 border-b">
                            <h1 class="text-3xl font-bold mb-2"><?php the_title(); ?></h1>
                            <div class="text-gray-600">
                                <?php echo get_the_date(); ?> by <?php the_author(); ?>
                            </div>
                        </header>
                        
                        <?php if (has_post_thumbnail()) : ?>
                            <div class="post-thumbnail">
                                <?php the_post_thumbnail('large', array('class' => 'w-full h-64 object-cover')); ?>
                            </div>
                        <?php endif; ?>
                        
                        <div class="content p-0">
                            <?php the_content(); ?>
                        </div>
                        
                        <?php
                        wp_link_pages(array(
                            'before' => '<div class="page-links mb-4">' . __('Pages:', 'yiontech-lms'),
                            'after'  => '</div>',
                        ));
                        ?>
                        
                        <footer class="p-6 bg-gray-50 border-t">
                            <div class="flex flex-wrap gap-2">
                                <?php the_tags('<span class="bg-blue-100 text-blue-800 text-xs font-semibold px-2.5 py-0.5 rounded">', '</span>'); ?>
                            </div>
                        </footer>
                    </article>
                    
                    <?php comments_template(); ?>
                </div>
                <div class="w-full md:w-1/3 mt-8 md:mt-0">
                    <?php get_sidebar(); ?>
                </div>
            </div>
        </div>
        <?php
    }
endwhile; 
?>
<?php get_footer(); ?>-e 

===== ./comments.php =====

<?php if (comments_open() || get_comments_number()) : ?>
    <div id="comments" class="comments-area my-8 bg-white rounded-lg shadow-md p-6">
        <?php if (have_comments()) : ?>
            <h3 class="comments-title text-xl font-bold mb-4">
                <?php
                printf(
                    _nx(
                        'One comment',
                        '%1$s comments',
                        get_comments_number(),
                        'comments title',
                        'yiontech-lms'
                    ),
                    number_format_i18n(get_comments_number())
                );
                ?>
            </h3>
            
            <ul class="comment-list space-y-4">
                <?php wp_list_comments(array('style' => 'ul', 'callback' => 'yiontech_lms_comment')); ?>
            </ul>
        <?php endif; ?>
        
        <?php 
        // Get privacy settings
        $enable_privacy_features = yiontech_lms_get_theme_setting('enable_privacy_features');
        $privacy_policy_url = yiontech_lms_get_privacy_policy_url();
        $terms_of_service_url = yiontech_lms_get_terms_of_service_url();
        
        // Get comment form variables
        $commenter = wp_get_current_commenter();
        $req = get_option('require_name_email');
        $consent = empty($commenter['comment_author_email']) ? '' : ' checked="checked"';
        ?>
        
        <?php 
        comment_form(array(
            'fields' => array(
                'author' => '<div class="comment-form-author mb-4">' . '<label for="author">' . __('Name', 'yiontech-lms') . ($req ? ' <span class="required">*</span>' : '') . '</label> ' . '<input id="author" name="author" type="text" value="' . esc_attr($commenter['comment_author']) . '" size="30" maxlength="245"' . ($req ? ' required' : '') . ' class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" /></div>',
                'email'  => '<div class="comment-form-email mb-4">' . '<label for="email">' . __('Email', 'yiontech-lms') . ($req ? ' <span class="required">*</span>' : '') . '</label> ' . '<input id="email" name="email" type="email" value="' . esc_attr($commenter['comment_author_email']) . '" size="30" maxlength="100" aria-describedby="email-notes"' . ($req ? ' required' : '') . ' class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" /></div>',
                'url'    => '<div class="comment-form-url mb-4">' . '<label for="url">' . __('Website', 'yiontech-lms') . '</label>' . '<input id="url" name="url" type="url" value="' . esc_attr($commenter['comment_author_url']) . '" size="30" maxlength="200" class="w-full bg-gray-50 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" /></div>',
                'cookies' => '<div class="comment-form-cookies-consent mb-4"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"' . $consent . ' /> <label for="wp-comment-cookies-consent">' . __('Save my name, email, and website in this browser for the next time I comment.', 'yiontech-lms') . '</label></div>',
            ),
            'comment_field' => '<div class="comment-form-comment mb-4"><label for="comment">' . _x('Comment', 'noun', 'yiontech-lms') . '</label><textarea id="comment" name="comment" cols="45" rows="8" maxlength="65525" required class="w-full px-3 py-2 bg-gray-50 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"></textarea></div>',
            'submit_button' => '<button name="%1$s" type="submit" id="%2$s" class="%3$s px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition duration-300">%4$s</button>',
            'submit_field' => '<p class="form-submit mt-4">%1$s %2$s</p>',
            'must_log_in' => '<p class="must-log-in">' . sprintf(__('You must be <a href="%s">logged in</a> to post a comment.', 'yiontech-lms'), wp_login_url(apply_filters('the_permalink', get_permalink()))) . '</p>',
            'logged_in_as' => '<p class="logged-in-as">' . sprintf(__('Logged in as <a href="%1$s">%2$s</a>. <a href="%3$s" title="Log out of this account">Log out?</a>', 'yiontech-lms'), get_edit_user_link(), $user_identity, wp_logout_url(apply_filters('the_permalink', get_permalink()))) . '</p>',
            'comment_notes_before' => '<p class="comment-notes"><span id="email-notes">' . __('Your email address will not be published.', 'yiontech-lms') . '</span>' . ($req ? ' ' . __('Required fields are marked *', 'yiontech-lms') : '') . '</p>',
            'comment_notes_after' => '',
            'id_form' => 'commentform',
            'id_submit' => 'submit',
            'class_submit' => 'submit',
            'name_submit' => 'submit',
            'title_reply' => __('Leave a Reply', 'yiontech-lms'),
            'title_reply_to' => __('Leave a Reply to %s', 'yiontech-lms'),
            'title_reply_before' => '<h3 id="reply-title" class="comment-reply-title text-xl font-bold mb-4">',
            'title_reply_after' => '</h3>',
            'cancel_reply_before' => ' <small>',
            'cancel_reply_after' => '</small>',
            'cancel_reply_link' => __('Cancel reply', 'yiontech-lms'),
            'label_submit' => __('Post Comment', 'yiontech-lms'),
            'submit_button' => '<button name="%1$s" type="submit" id="%2$s" class="%3$s px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition duration-300">%4$s</button>',
            'submit_field' => '<p class="form-submit mt-4">%1$s %2$s</p>',
            'format' => 'html5',
        ));
        ?>
    </div>
<?php endif; ?>-e 

===== ./header.php =====

<?php
/**
 * Header template for Yiontech LMS
 */

// Check if this is a login or register page
 $is_auth_page = is_page_template('page-login.php') || is_page_template('page-register.php');

// Don't load header for auth pages
if ($is_auth_page) {
    // Only output essential HTML for auth pages
    ?>
    <!DOCTYPE html>
    <html <?php language_attributes(); ?>>
    <head>
        <meta charset="<?php bloginfo('charset'); ?>">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <?php wp_head(); ?>
    </head>
    <body <?php body_class(); ?>>
    <?php
    return;
}
?>
<!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
    <meta charset="<?php bloginfo('charset'); ?>">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <?php 
    // Site Icon
    $site_icon = yiontech_lms_get_theme_setting('site_icon');
    if ($site_icon) {
        echo '<link rel="icon" href="' . esc_url($site_icon) . '" type="image/x-icon">';
    }
    ?>
    <?php wp_head(); ?>
</head>
<body <?php body_class(); ?>>
<?php
// Preloader
 $enable_preloader = yiontech_lms_get_theme_setting('enable_preloader');
if ($enable_preloader) {
    ?>
    <div id="preloader">
        <div class="preloader-spinner">
            <div class="spinner"></div>
        </div>
    </div>
    <?php
}
?>

<?php
 $header_style = yiontech_lms_get_theme_setting('header_style', 'default');
 $transparent_header = yiontech_lms_get_theme_setting('transparent_header');
 $sticky_header = yiontech_lms_get_theme_setting('sticky_header', true);
 $logo = yiontech_lms_get_theme_setting('logo_upload');
 $retina_logo = yiontech_lms_get_theme_setting('retina_logo_upload');
 $header_buttons = yiontech_lms_get_theme_setting('header_buttons');
 $header_menu = yiontech_lms_get_theme_setting('header_menu');

// Get header background colors
 $header_background_color = yiontech_lms_get_theme_setting('header_background_color', '#1e40af');
 $sticky_header_background_color = yiontech_lms_get_theme_setting('sticky_header_background_color', '#1e40af');

// Get privacy settings
 $enable_privacy_features = yiontech_lms_get_theme_setting('enable_privacy_features');
 $privacy_policy_url = yiontech_lms_get_privacy_policy_url();
 $terms_of_service_url = yiontech_lms_get_terms_of_service_url();
?>
<?php if ($header_style == 'default') : ?>
<header class="site-header text-white <?php echo $sticky_header ? 'header-sticky-enabled' : ''; ?> <?php echo $transparent_header && is_front_page() ? 'header-transparent' : ''; ?>" 
      <?php if (!$transparent_header || !is_front_page()) : ?>style="background-color: <?php echo esc_attr($header_background_color); ?>;"<?php endif; ?>>
    <?php 
    if ( function_exists( 'elementor_theme_do_location' ) && elementor_theme_do_location( 'header' ) ) {
        // Elementor header
    } else {
        // Default theme header
        ?>
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-3">
                <!-- Logo (Left) -->
                <div class="site-branding flex items-center">
                    <?php if ($logo) : ?>
                        <a href="<?php echo esc_url( home_url( '/' ) ); ?>" class="custom-logo-link">
                            <img src="<?php echo esc_url($logo); ?>" class="custom-logo" alt="<?php bloginfo('name'); ?>" <?php echo $retina_logo ? 'srcset="' . esc_url($logo) . ' 1x, ' . esc_url($retina_logo) . ' 2x"' : ''; ?>>
                        </a>
                    <?php elseif ( has_custom_logo() ) : ?>
                        <?php the_custom_logo(); ?>
                    <?php else : ?>
                        <h1 class="text-xl font-bold"><a href="<?php echo esc_url( home_url( '/' ) ); ?>" class="text-white"><?php bloginfo( 'name' ); ?></a></h1>
                    <?php endif; ?>
                </div>
                
                <!-- Desktop Navigation (Center) -->
                <nav id="site-navigation" class="main-navigation hidden xl:flex flex-1 justify-center">
                    <?php if (!empty($header_menu)) : ?>
                        <ul class="flex space-x-8 items-center">
                            <?php foreach ($header_menu as $item) : ?>
                                <li>
                                    <a href="<?php echo esc_url($item['url']); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php echo esc_html($item['text']); ?>
                                    </a>
                                </li>
                            <?php endforeach; ?>
                            
                            <!-- Add privacy links if enabled -->
                            <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php _e('Privacy Policy', 'yiontech-lms'); ?>
                                    </a>
                                </li>
                            <?php endif; ?>
                            
                            <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php _e('Terms of Service', 'yiontech-lms'); ?>
                                    </a>
                                </li>
                            <?php endif; ?>
                        </ul>
                    <?php else : ?>
                        <?php
                        wp_nav_menu( array(
                            'theme_location' => 'primary',
                            'menu_class'     => 'flex space-x-8 items-center',
                            'container'      => false,
                        ) );
                        ?>
                    <?php endif; ?>
                </nav>
                
                <!-- Right Side Buttons -->
                <div class="flex items-center space-x-3">
                    <?php if (!empty($header_buttons)) : ?>
                        <?php foreach ($header_buttons as $button) : ?>
                            <?php 
                            $show_desktop = isset($button['show_desktop']) ? $button['show_desktop'] : true;
                            $show_mobile = isset($button['show_mobile']) ? $button['show_mobile'] : true;
                            if ($show_desktop) : 
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="hidden xl:block px-4 py-1.5 text-sm rounded-lg transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-white text-blue-600 hover:bg-blue-50' : 'border border-white hover:bg-white hover:text-blue-600'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php endif; ?>
                            
                            <?php if ($show_mobile) : 
                                // Show only the first button on mobile
                                if ($button === reset($header_buttons)) :
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="xl:hidden px-4 py-1.5 text-sm rounded-lg transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-white text-blue-600 hover:bg-blue-50' : 'border border-white hover:bg-white hover:text-blue-600'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php 
                                endif;
                            endif; ?>
                        <?php endforeach; ?>
                    <?php endif; ?>
                    
                    <!-- Mobile Menu Toggle -->
                    <button id="mobile-menu-toggle" class="text-white focus:outline-none p-1" aria-label="<?php esc_attr_e('Toggle mobile menu', 'yiontech-lms'); ?>" aria-expanded="false">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <?php
    }
    ?>
</header>
<?php elseif ($header_style == 'minimal') : ?>
<header class="site-header text-white <?php echo $sticky_header ? 'sticky top-0 z-50' : ''; ?> <?php echo $transparent_header && is_front_page() ? 'header-transparent' : ''; ?>" 
      <?php if (!$transparent_header || !is_front_page()) : ?>style="background-color: <?php echo esc_attr($header_background_color); ?>;"<?php endif; ?>>
    <?php 
    if ( function_exists( 'elementor_theme_do_location' ) && elementor_theme_do_location( 'header' ) ) {
        // Elementor header
    } else {
        // Minimal theme header
        ?>
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-2">
                <!-- Logo (Left) -->
                <div class="site-branding flex items-center">
                    <?php if ($logo) : ?>
                        <a href="<?php echo esc_url( home_url( '/' ) ); ?>" class="custom-logo-link">
                            <img src="<?php echo esc_url($logo); ?>" class="custom-logo" alt="<?php bloginfo('name'); ?>" <?php echo $retina_logo ? 'srcset="' . esc_url($logo) . ' 1x, ' . esc_url($retina_logo) . ' 2x"' : ''; ?>>
                        </a>
                    <?php elseif ( has_custom_logo() ) : ?>
                        <?php the_custom_logo(); ?>
                    <?php else : ?>
                        <h1 class="text-xl font-bold"><a href="<?php echo esc_url( home_url( '/' ) ); ?>" class="text-white"><?php bloginfo( 'name' ); ?></a></h1>
                    <?php endif; ?>
                </div>
                
                <!-- Desktop Navigation (Center) -->
                <nav id="site-navigation" class="main-navigation hidden xl:flex flex-1 justify-center">
                    <?php if (!empty($header_menu)) : ?>
                        <ul class="flex space-x-6 items-center text-sm">
                            <?php foreach ($header_menu as $item) : ?>
                                <li>
                                    <a href="<?php echo esc_url($item['url']); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php echo esc_html($item['text']); ?>
                                    </a>
                                </li>
                            <?php endforeach; ?>
                            
                            <!-- Add privacy links if enabled -->
                            <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php _e('Privacy Policy', 'yiontech-lms'); ?>
                                    </a>
                                </li>
                            <?php endif; ?>
                            
                            <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php _e('Terms of Service', 'yiontech-lms'); ?>
                                    </a>
                                </li>
                            <?php endif; ?>
                        </ul>
                    <?php else : ?>
                        <?php
                        wp_nav_menu( array(
                            'theme_location' => 'primary',
                            'menu_class'     => 'flex space-x-6 items-center text-sm',
                            'container'      => false,
                        ) );
                        ?>
                    <?php endif; ?>
                </nav>
                
                <!-- Right Side Buttons -->
                <div class="flex items-center space-x-3">
                    <?php if (!empty($header_buttons)) : ?>
                        <?php foreach ($header_buttons as $button) : ?>
                            <?php 
                            $show_desktop = isset($button['show_desktop']) ? $button['show_desktop'] : true;
                            $show_mobile = isset($button['show_mobile']) ? $button['show_mobile'] : true;
                            if ($show_desktop) : 
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="hidden xl:block px-3 py-1 text-sm rounded transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-white text-blue-600 hover:bg-blue-50' : 'border border-white hover:bg-white hover:text-blue-600'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php endif; ?>
                            
                            <?php if ($show_mobile) : 
                                // Show only the first button on mobile
                                if ($button === reset($header_buttons)) :
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="xl:hidden px-3 py-1 text-sm rounded transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-white text-blue-600 hover:bg-blue-50' : 'border border-white hover:bg-white hover:text-blue-600'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php 
                                endif;
                            endif; ?>
                        <?php endforeach; ?>
                    <?php endif; ?>
                    
                    <!-- Mobile Menu Toggle -->
                    <button id="mobile-menu-toggle" class="text-white focus:outline-none p-1" aria-label="<?php esc_attr_e('Toggle mobile menu', 'yiontech-lms'); ?>" aria-expanded="false">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <?php
    }
    ?>
</header>
<?php elseif ($header_style == 'centered') : ?>
<header class="site-header text-white <?php echo $sticky_header ? 'sticky top-0 z-50' : ''; ?> <?php echo $transparent_header && is_front_page() ? 'header-transparent' : ''; ?>" 
      <?php if (!$transparent_header || !is_front_page()) : ?>style="background-color: <?php echo esc_attr($header_background_color); ?>;"<?php endif; ?>>
    <?php 
    if ( function_exists( 'elementor_theme_do_location' ) && elementor_theme_do_location( 'header' ) ) {
        // Elementor header
    } else {
        // Centered theme header
        ?>
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex flex-col items-center py-4">
                <!-- Logo (Center) -->
                <div class="site-branding flex items-center mb-3">
                    <?php if ($logo) : ?>
                        <a href="<?php echo esc_url( home_url( '/' ) ); ?>" class="custom-logo-link">
                            <img src="<?php echo esc_url($logo); ?>" class="custom-logo" alt="<?php bloginfo('name'); ?>" <?php echo $retina_logo ? 'srcset="' . esc_url($logo) . ' 1x, ' . esc_url($retina_logo) . ' 2x"' : ''; ?>>
                        </a>
                    <?php elseif ( has_custom_logo() ) : ?>
                        <?php the_custom_logo(); ?>
                    <?php else : ?>
                        <h1 class="text-xl font-bold"><a href="<?php echo esc_url( home_url( '/' ) ); ?>" class="text-white"><?php bloginfo( 'name' ); ?></a></h1>
                    <?php endif; ?>
                </div>
                
                <!-- Desktop Navigation (Center) -->
                <nav id="site-navigation" class="main-navigation hidden xl:flex justify-center w-full">
                    <?php if (!empty($header_menu)) : ?>
                        <ul class="flex space-x-8 items-center">
                            <?php foreach ($header_menu as $item) : ?>
                                <li>
                                    <a href="<?php echo esc_url($item['url']); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php echo esc_html($item['text']); ?>
                                    </a>
                                </li>
                            <?php endforeach; ?>
                            
                            <!-- Add privacy links if enabled -->
                            <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php _e('Privacy Policy', 'yiontech-lms'); ?>
                                    </a>
                                </li>
                            <?php endif; ?>
                            
                            <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-white hover:text-gray-200 transition">
                                        <?php _e('Terms of Service', 'yiontech-lms'); ?>
                                    </a>
                                </li>
                            <?php endif; ?>
                        </ul>
                    <?php else : ?>
                        <?php
                        wp_nav_menu( array(
                            'theme_location' => 'primary',
                            'menu_class'     => 'flex space-x-8 items-center',
                            'container'      => false,
                        ) );
                        ?>
                    <?php endif; ?>
                </nav>
                
                <!-- Right Side Buttons -->
                <div class="flex items-center space-x-3 mt-3">
                    <?php if (!empty($header_buttons)) : ?>
                        <?php foreach ($header_buttons as $button) : ?>
                            <?php 
                            $show_desktop = isset($button['show_desktop']) ? $button['show_desktop'] : true;
                            $show_mobile = isset($button['show_mobile']) ? $button['show_mobile'] : true;
                            if ($show_desktop) : 
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="hidden xl:block px-4 py-1.5 text-sm rounded-lg transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-white text-blue-600 hover:bg-blue-50' : 'border border-white hover:bg-white hover:text-blue-600'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php endif; ?>
                            
                            <?php if ($show_mobile) : 
                                // Show only the first button on mobile
                                if ($button === reset($header_buttons)) :
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="xl:hidden px-4 py-1.5 text-sm rounded-lg transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-white text-blue-600 hover:bg-blue-50' : 'border border-white hover:bg-white hover:text-blue-600'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php 
                                endif;
                            endif; ?>
                        <?php endforeach; ?>
                    <?php endif; ?>
                    
                    <!-- Mobile Menu Toggle -->
                    <button id="mobile-menu-toggle" class="text-white focus:outline-none p-1" aria-label="<?php esc_attr_e('Toggle mobile menu', 'yiontech-lms'); ?>" aria-expanded="false">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <?php
    }
    ?>
</header>
<?php endif; ?>

<!-- Mobile Menu Overlay -->
<div id="mobile-menu-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden"></div>

<!-- Mobile Menu Sidebar -->
<div id="mobile-menu-sidebar" class="fixed top-0 right-0 h-full w-80 bg-white z-50 transform translate-x-full transition-transform duration-300 ease-in-out">
    <div class="flex flex-col h-full">
        <!-- Menu Header -->
        <div class="flex items-center justify-between p-4" style="background-color: <?php echo esc_attr($header_background_color); ?>; color: white;">
            <div class="site-branding flex items-center">
                <?php if ($logo) : ?>
                    <img src="<?php echo esc_url($logo); ?>" class="custom-logo" alt="<?php bloginfo('name'); ?>" style="max-height: 36px; width: auto;">
                <?php elseif ( has_custom_logo() ) : ?>
                    <?php the_custom_logo(); ?>
                <?php else : ?>
                    <h2 class="text-xl font-bold"><?php bloginfo( 'name' ); ?></h2>
                <?php endif; ?>
            </div>
            <button id="mobile-menu-close" class="text-white focus:outline-none p-1">
                <svg class="w-6 h-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        
        <!-- Menu Content -->
        <div class="flex-grow overflow-y-auto">
            <!-- Main Navigation -->
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('Navigation', 'yiontech-lms'); ?></h3>
                <?php if (!empty($header_menu)) : ?>
                    <ul class="space-y-2">
                        <?php foreach ($header_menu as $item) : ?>
                            <li>
                                <a href="<?php echo esc_url($item['url']); ?>" class="text-gray-600 hover:text-blue-600 transition">
                                    <?php echo esc_html($item['text']); ?>
                                </a>
                            </li>
                        <?php endforeach; ?>
                        
                        <!-- Add privacy links if enabled -->
                        <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                            <li>
                                <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-gray-600 hover:text-blue-600 transition">
                                    <?php _e('Privacy Policy', 'yiontech-lms'); ?>
                                </a>
                            </li>
                        <?php endif; ?>
                        
                        <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                            <li>
                                <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-gray-600 hover:text-blue-600 transition">
                                    <?php _e('Terms of Service', 'yiontech-lms'); ?>
                                </a>
                            </li>
                        <?php endif; ?>
                    </ul>
                <?php else : ?>
                    <?php
                    wp_nav_menu( array(
                        'theme_location' => 'primary',
                        'menu_class'     => 'space-y-2',
                        'container'      => false,
                    ) );
                    ?>
                <?php endif; ?>
            </div>
            
            <!-- Mobile Buttons -->
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('Quick Actions', 'yiontech-lms'); ?></h3>
                <div class="space-y-3">
                    <?php if (!empty($header_buttons)) : ?>
                        <?php foreach ($header_buttons as $button) : ?>
                            <?php 
                            $show_mobile = isset($button['show_mobile']) ? $button['show_mobile'] : true;
                            if ($show_mobile) : 
                            ?>
                                <a href="<?php echo esc_url($button['url']); ?>" 
                                   class="block px-4 py-2 rounded-lg transition duration-300 
                                          <?php echo $button['style'] == 'solid' ? 'bg-blue-600 text-white hover:bg-blue-700' : 'border border-blue-600 text-blue-600 hover:bg-blue-600 hover:text-white'; ?>">
                                    <?php echo esc_html($button['text']); ?>
                                </a>
                            <?php endif; ?>
                        <?php endforeach; ?>
                    <?php endif; ?>
                </div>
            </div>
            
            <!-- User Portal -->
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('User Portal', 'yiontech-lms'); ?></h3>
                <div class="space-y-3">
                    <a href="<?php echo esc_url( home_url( '/login' ) ); ?>" class="block px-4 py-2 bg-blue-50 text-blue-600 rounded-lg hover:bg-blue-100 transition duration-300"><?php _e('Login', 'yiontech-lms'); ?></a>
                    <a href="<?php echo esc_url( home_url( '/register' ) ); ?>" class="block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-300"><?php _e('Create Account', 'yiontech-lms'); ?></a>
                    <a href="<?php echo esc_url( home_url( '/dashboard' ) ); ?>" class="block px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition duration-300"><?php _e('My Dashboard', 'yiontech-lms'); ?></a>
                </div>
            </div>
            
            <!-- Quick Links -->
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('Quick Links', 'yiontech-lms'); ?></h3>
                <?php
                wp_nav_menu( array(
                    'theme_location' => 'footer-quick-links',
                    'menu_class'     => 'space-y-2',
                    'container'      => false,
                ) );
                ?>
            </div>
            
            <!-- Contact Information -->
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('Contact Us', 'yiontech-lms'); ?></h3>
                <ul class="space-y-2 text-gray-600">
                    <li class="flex items-start">
                        <svg class="w-5 h-5 mr-2 mt-0.5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                        </svg>
                        <span><?php echo esc_html(get_bloginfo('admin_email')); ?></span>
                    </li>
                    <li class="flex items-start">
                        <svg class="w-5 h-5 mr-2 mt-0.5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                        </svg>
                        <span>+1 (555) 123-4567</span>
                    </li>
                </ul>
            </div>
                                   
            <!-- Social Media -->
            <div class="p-4 border-b">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('Follow Us', 'yiontech-lms'); ?></h3>
                <div class="flex space-x-4">
                    <a href="#" class="text-blue-600 hover:text-blue-800">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
                        </svg>
                    </a>
                    <a href="#" class="text-blue-400 hover:text-blue-600">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                        </svg>
                    </a>
                    <a href="#" class="text-pink-600 hover:text-pink-800">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zM5.838 12a6.162 6.162 0 1112.324 0 6.162 6.162 0 01-12.324 0zM12 16a4 4 0 110-8 4 4 0 010 8zm4.965-10.405a1.44 1.44 0 112.881.001 1.44 1.44 0 01-2.881-.001z"/>
                        </svg>
                    </a>
                </div>
            </div>
            
            <!-- Newsletter Signup -->
            <div class="p-4">
                <h3 class="text-lg font-semibold text-gray-800 mb-3"><?php _e('Newsletter', 'yiontech-lms'); ?></h3>
                <p class="text-gray-600 text-sm mb-3"><?php _e('Subscribe to get the latest updates and offers.', 'yiontech-lms'); ?></p>
                <?php get_template_part('template-parts/newsletter-form'); ?>
            </div>
        </div>
        
        <!-- Menu Footer -->
        <div class="p-4 bg-gray-100 border-t">
            <div class="text-center text-gray-600 text-sm">
                <p>&copy; <?php echo date('Y'); ?> <?php bloginfo('name'); ?></p>
                <p class="mt-1"><?php _e('All rights reserved.', 'yiontech-lms'); ?></p>
            </div>
        </div>
    </div>
</div>

<?php
// Add custom CSS from theme settings
 $custom_css = yiontech_lms_get_theme_setting('custom_css');
if ($custom_css) {
    ?>
    <style>
        <?php echo $custom_css; ?>
        
        /* Transparent header styles */
        .header-transparent {
            box-shadow: none;
        }
        
        /* Prevent layout shifts when mobile menu opens */
        body.mobile-menu-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
        }
        
        /* Mobile menu sidebar */
        #mobile-menu-sidebar {
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        /* Prevent horizontal overflow on homepage */
        body, html {
            overflow-x: hidden;
            width: 100%;
        }
        
        .site-content {
            overflow: hidden;
            width: 100%;
        }
        
        img, video, iframe {
            max-width: 100%;
            height: auto;
        }
        
        /* Fix for Elementor sections */
        .elementor-section {
            overflow: hidden;
        }
        
        /* Sticky header styles */
        .site-header.sticky {
            position: sticky;
            top: 0;
            z-index: 999;
            width: 100%;
            transition: background-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        /* Cookie consent banner */
        .cookie-consent-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: #1e293b;
            color: white;
            padding: 15px;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
        }
        
        .cookie-consent-content {
            flex: 1;
            margin-right: 15px;
        }
        
        .cookie-consent-buttons {
            display: flex;
            gap: 10px;
        }
        
        .cookie-consent-buttons .button {
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            border: none;
        }
        
        .cookie-consent-accept {
            background: #3b82f6;
            color: white;
        }
        
        .cookie-consent-accept:hover {
            background: #2563eb;
        }
        
        .cookie-consent-learn {
            background: transparent;
            color: white;
            border: 1px solid white;
        }
        
        .cookie-consent-learn:hover {
            background: rgba(255,255,255,0.1);
        }
    </style>
    <?php
}
?>-e 

===== ./inc/core/template-functions.php =====

<?php
/**
 * Template Functions
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if ( ! defined( 'ABSPATH' ) ) {
    exit;
}

// Load template function
function yiontech_lms_load_template( $template_path ) {
    // Ensure the template path starts with a slash
    $template_path = ltrim($template_path, '/');
    
    // Prefer child theme override first
    $template_file = locate_template( $template_path );
    if ( $template_file && file_exists( $template_file ) ) {
        require $template_file;
        return;
    }

    // Fallback to parent theme folder
    $fallback_path = get_template_directory() . '/' . $template_path;
    if ( file_exists( $fallback_path ) ) {
        require $fallback_path;
        return;
    }

    // Template missing: show a generic message to users, and log when WP_DEBUG is true
    if ( defined( 'WP_DEBUG' ) && WP_DEBUG ) {
        error_log( '[Yiontech_LMS] Template missing: ' . $template_path );
    }

    echo '<div class="tutor-alert tutor-danger">' . esc_html__( 'Template missing. Please check your theme installation.', 'yiontech-lms' ) . '</div>';
}

// Get privacy policy URL
function yiontech_lms_get_privacy_policy_url() {
    $privacy_policy_page = yiontech_lms_get_theme_setting( 'privacy_policy_page' );
    if ( $privacy_policy_page ) {
        $url = get_permalink( $privacy_policy_page );
        if ( $url ) {
            return $url;
        }
    }
    return get_privacy_policy_url();
}

// Get terms of service URL
function yiontech_lms_get_terms_of_service_url() {
    $terms_of_service_page = yiontech_lms_get_theme_setting( 'terms_of_service_page' );
    if ( $terms_of_service_page ) {
        $url = get_permalink( $terms_of_service_page );
        if ( $url ) {
            return $url;
        }
    }
    return '';
}

// Helper function to get Elementor templates
function yiontech_lms_get_elementor_templates( $template_type = '' ) {
    $args = array(
        'post_type'      => 'elementor_library',
        'post_status'    => 'publish',
        'posts_per_page' => -1,
    );

    if ( ! empty( $template_type ) ) {
        $args['meta_query'] = array(
            array(
                'key'   => '_elementor_template_type',
                'value' => $template_type,
            ),
        );
    }

    $templates = get_posts( $args );

    $template_options = array();
    if ( ! empty( $templates ) ) {
        foreach ( $templates as $template ) {
            $template_options[ $template->ID ] = $template->post_title;
        }
    }

    return $template_options;
}
-e 

===== ./inc/core/theme-setup.php =====

<?php
/**
 * Core Theme Setup
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Theme setup
function yiontech_lms_setup() {
    // Add theme support
    add_theme_support('title-tag');
    add_theme_support('post-thumbnails');
    add_theme_support('custom-logo', array(
        'height'      => 36,
        'width'       => 120,
        'flex-height' => true,
        'flex-width'  => true,
    ));
    add_theme_support('html5', array('search-form', 'comment-form', 'comment-list', 'gallery', 'caption'));
    
    // Register navigation menus
    register_nav_menus(array(
        'primary' => __('Primary Menu', 'yiontech-lms'),
        'footer' => __('Footer Menu', 'yiontech-lms'),
        'footer-quick-links' => __('Footer Quick Links Menu', 'yiontech-lms'),
        'footer-company' => __('Footer Company Menu', 'yiontech-lms'),
        'footer-user-portal' => __('Footer User Portal Menu', 'yiontech-lms'),
    ));
    
    // Register sidebar
    register_sidebar(array(
        'name'          => __('Main Sidebar', 'yiontech-lms'),
        'id'            => 'main-sidebar',
        'description'   => __('Add widgets here.', 'yiontech-lms'),
        'before_widget' => '<div id="%1$s" class="widget %2$s mb-6 bg-white p-4 rounded-lg shadow">',
        'after_widget'  => '</div>',
        'before_title'  => '<h2 class="widget-title text-xl font-bold mb-3">',
        'after_title'   => '</h2>',
    ));
}
add_action('after_setup_theme', 'yiontech_lms_setup');

// Create front page on theme activation
add_action('after_switch_theme', 'yiontech_lms_create_front_page');
function yiontech_lms_create_front_page() {
    $front_page = get_page_by_path('front-page');
    if (!$front_page) {
        $front_page_id = wp_insert_post(array(
            'post_title'    => 'Front Page',
            'post_content'  => '',
            'post_status'   => 'publish',
            'post_author'   => 1,
            'post_type'     => 'page',
            'post_name'     => 'front-page'
        ));
        update_option('page_on_front', $front_page_id);
        update_option('show_on_front', 'page');
    }
}

// Add custom image sizes for courses
add_action('after_setup_theme', 'yiontech_lms_add_image_sizes');
function yiontech_lms_add_image_sizes() {
    add_image_size('course-thumbnail', 400, 250, true);
}-e 

===== ./inc/core/assets-loader.php =====

<?php
/**
 * Optimized Assets Loader
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if ( ! defined( 'ABSPATH' ) ) {
    exit;
}


// Enqueue scripts and styles
function yiontech_lms_scripts() {
    $theme_version = wp_get_theme()->get( 'Version' );

    // Main stylesheet
    wp_enqueue_style( 'yiontech-lms-style', get_stylesheet_uri(), array(), $theme_version );

    // Decide whether to load Tailwind from CDN as a fallback.
    $load_tailwind = true;

    // If Elementor is active, check if we're on an Elementor page
    if ( class_exists( '\\Elementor\\Plugin' ) ) {
        $document = \Elementor\Plugin::$instance->documents->get_current();
        if ( $document && $document->is_built_with_elementor() ) {
            // We're on an Elementor page, so skip our Tailwind to avoid conflicts
            $load_tailwind = false;
        }
    }

    if ( $load_tailwind ) {
        wp_enqueue_style( 'yiontech-lms-tailwind', 'https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css', array(), $theme_version );
    }

    // Load jQuery conditionally: only when features require it.
    $jquery_needed = false;
    $enable_preloader = function_exists( 'yiontech_lms_get_theme_setting' ) ? yiontech_lms_get_theme_setting( 'enable_preloader' ) : false;
    $enable_back_to_top = function_exists( 'yiontech_lms_get_theme_setting' ) ? yiontech_lms_get_theme_setting( 'enable_back_to_top' ) : false;
    $newsletter_enable = function_exists( 'yiontech_lms_get_theme_setting' ) ? yiontech_lms_get_theme_setting( 'newsletter_enable' ) : false;
    $enable_privacy_features = function_exists( 'yiontech_lms_get_theme_setting' ) ? yiontech_lms_get_theme_setting( 'enable_privacy_features' ) : false;

    if ( $enable_preloader || $enable_back_to_top || $newsletter_enable || $enable_privacy_features ) {
        $jquery_needed = true;
    }

    if ( $jquery_needed ) {
        wp_enqueue_script( 'jquery' );
        wp_script_add_data( 'jquery', 'defer', true );
    }

    // Main script
    wp_enqueue_script( 'yiontech-lms-main', get_template_directory_uri() . '/js/main.js', array(), $theme_version, true );
    wp_script_add_data( 'yiontech-lms-main', 'defer', true );

    // Conditional scripts
    if ( $enable_preloader ) {
        wp_enqueue_script( 'yiontech-lms-preloader', get_template_directory_uri() . '/inc/features/preloader/preloader.js', array(), $theme_version, true );
        wp_script_add_data( 'yiontech-lms-preloader', 'defer', true );
    }

    // Admin scripts
    if ( is_admin() ) {
        wp_enqueue_style( 'yiontech-lms-admin', get_template_directory_uri() . '/css/admin.css', array(), $theme_version );
        wp_enqueue_script( 'yiontech-lms-admin', get_template_directory_uri() . '/js/admin.js', array( 'jquery', 'wp-color-picker' ), $theme_version, true );
    }
}
add_action( 'wp_enqueue_scripts', 'yiontech_lms_scripts' );
// Add async/defer attributes to scripts
function yiontech_lms_script_loader_tag( $tag, $handle, $src ) {
    // Add defer to main scripts
    if ( in_array( $handle, array( 'yiontech-lms-main', 'yiontech-lms-preloader', 'yiontech-lms-user-main' ), true ) ) {
        return str_replace( ' src', ' defer src', $tag );
    }

    // Add async to admin script
    if ( in_array( $handle, array( 'yiontech-lms-admin' ), true ) ) {
        return str_replace( ' src', ' async src', $tag );
    }

    return $tag;
}
add_filter( 'script_loader_tag', 'yiontech_lms_script_loader_tag', 10, 3 );

// Preload critical fonts
function yiontech_lms_preload_fonts() {
    ?>
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"></noscript>
    <?php
}
add_action( 'wp_head', 'yiontech_lms_preload_fonts', 1 );

// Remove jQuery Migrate (not needed for most themes)
function yiontech_lms_remove_jquery_migrate( $scripts ) {
    if ( ! is_admin() && isset( $scripts->registered['jquery'] ) ) {
        $script = $scripts->registered['jquery'];
        if ( $script->deps ) {
            $script->deps = array_diff( $script->deps, array( 'jquery-migrate' ) );
        }
    }
    return $scripts;
}
add_filter( 'wp_default_scripts', 'yiontech_lms_remove_jquery_migrate' );
-e 

===== ./inc/features-loader.php =====

<?php
/**
 * Feature Loader
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Array of features to load. To disable a feature, comment it out.
 $features = array(
    'theme-settings',
    'login-modifier',
    'registration-modifier',
    'document-upload',
    'gdpr',
    'newsletter',
    'cookie-consent',
    'preloader',
    'back-to-top',
    'header-scroll',
    'elementor-integration',
    // Add more features here
);

// Load each feature
foreach ($features as $feature) {
    $feature_file = get_template_directory() . "/inc/features/{$feature}/{$feature}.php";
    if (file_exists($feature_file)) {
        require_once $feature_file;
    }
}-e 

===== ./inc/features/elementor-integration/elementor-integration.php =====

<?php
/**
 * Elementor Integration Feature
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Elementor compatibility
function yiontech_lms_elementor_setup() {
    // Add theme compatibility
    if (function_exists('elementor_theme_do_location')) {
        add_action('elementor/theme/register_locations', function($elementor_theme_manager) {
            $elementor_theme_manager->register_location('header');
            $elementor_theme_manager->register_location('footer');
        });
    }
}
add_action('after_setup_theme', 'yiontech_lms_elementor_setup');

// Full width for Elementor pages with Tailwind container width
function yiontech_lms_elementor_full_width() {
    if (function_exists('\\Elementor\\Plugin')) {
        $document = \Elementor\Plugin::$instance->documents->get(get_the_ID());
        if ($document && $document->is_built_with_elementor()) {
            ?>
            <style>
                /* Only remove theme container constraints for Elementor pages */
                body.elementor-page .site-content > .container,
                body.elementor-page .site-content > .container > .flex,
                body.elementor-page .site-content > .container > .flex > div:first-child {
                    max-width: 100% !important;
                    width: 100% !important;
                    padding: 0 !important;
                    margin: 0 !important;
                }
                
                /* But preserve Elementor's own container settings */
                body.elementor-page .elementor-section.elementor-section-boxed > .elementor-container {
                    max-width: 1140px;
                    width: 100%;
                    padding-left: 15px;
                    padding-right: 15px;
                    margin-left: auto;
                    margin-right: auto;
                }
                
                /* Full width sections should remain full width */
                body.elementor-page .elementor-section.elementor-section-full_width > .elementor-container {
                    max-width: 100% !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                }
                
                /* Responsive adjustments */
                @media (min-width: 768px) {
                    body.elementor-page .elementor-section.elementor-section-boxed > .elementor-container {
                        max-width: 720px;
                    }
                }
                
                @media (min-width: 992px) {
                    body.elementor-page .elementor-section.elementor-section-boxed > .elementor-container {
                        max-width: 960px;
                    }
                }
                
                @media (min-width: 1200px) {
                    body.elementor-page .elementor-section.elementor-section-boxed > .elementor-container {
                        max-width: 1140px;
                    }
                }
            </style>
            <?php
        }
    }
}
add_action('wp_head', 'yiontech_lms_elementor_full_width');

// Add proper Elementor initialization
add_action('wp', function() {
    if (class_exists('\\Elementor\\Plugin')) {
        $elementor = \Elementor\Plugin::instance();
        
        // Make sure Elementor frontend is initialized
        if (method_exists($elementor, 'frontend')) {
            $elementor->frontend->init();
        }
    }
}, 20); // Priority 20 to run after most initializations

-e 

===== ./inc/features/gdpr/gdpr.php =====

<?php
if (!defined('ABSPATH')) exit;

// Add GDPR tab to Tutor dashboard
add_filter('tutor_dashboard/nav_items', function ($links) {
    $links['gdpr'] = [
        'title' => __('GDPR Compliance', 'tutor'),
        'icon'  => '', // empty
        'menu_item_class' => 'tutor-gdpr-tab', 
    ];
    return $links;
});


// AJAX: Delete user account (non-admin only)
add_action('wp_ajax_delete_user_account', function () {
    if (!is_user_logged_in()) wp_send_json_error(['message' => 'User not logged in']);

    $user_id = get_current_user_id();
    $user = wp_get_current_user();

    if (in_array('administrator', $user->roles)) {
        wp_send_json_error(['message' => 'Administrators cannot delete their accounts.']);
    }

    require_once(ABSPATH . 'wp-admin/includes/user.php');
    $deleted = wp_delete_user($user_id);

    if ($deleted) {
        wp_logout();
        wp_send_json_success(['message' => 'Your account has been deleted successfully.']);
    } else {
        wp_send_json_error(['message' => 'Failed to delete account. Please try again later.']);
    }
});

// AJAX: Export GDPR data as ZIP
add_action('wp_ajax_gdpr_export_zip', function () {
    if (!is_user_logged_in()) wp_send_json_error(['message' => 'User not logged in']);

    $user_id = get_current_user_id();
    $user = wp_get_current_user();

    // Basic user info
    $personal_data = [
        'ID' => $user->ID,
        'username' => $user->user_login,
        'email' => $user->user_email,
        'registered' => $user->user_registered,
        'first_name' => $user->first_name,
        'last_name' => $user->last_name,
        'roles' => $user->roles,
        'phone_number' => get_user_meta($user_id, 'phone_number', true),
        'bio' => get_user_meta($user_id, '_tutor_profile_bio', true),
        'registration_number' => get_user_meta($user_id, 'yiontech_registration_number', true),
    ];

    // Uploaded documents
    $uploaded_docs = get_user_meta($user_id, 'user_uploaded_documents', true);
    $files_to_include = [];
    $personal_data['uploaded_documents'] = [];

    if (is_array($uploaded_docs)) {
        foreach ($uploaded_docs as $doc) {
            $filename = $doc['filename'] ?? '';
            $path = $doc['path'] ?? '';
            if ($filename && file_exists($path)) {
                $files_to_include[] = $path;
                $personal_data['uploaded_documents'][] = [
                    'filename' => $filename,
                    'uploaded_on' => $doc['uploaded_on'] ?? '',
                    'size' => $doc['size'] ?? '',
                ];
            }
        }
    }

    // Tutor LMS courses, lessons, quizzes, certificates
    $personal_data['enrolled_courses'] = tutor_utils()->get_user_enrolled_courses($user_id) ?: [];
    $personal_data['completed_lessons'] = tutor_utils()->get_user_completed_lessons($user_id) ?: [];
    $personal_data['completed_quizzes'] = tutor_utils()->get_user_quiz_results($user_id) ?: [];
    $personal_data['certificates'] = get_user_meta($user_id, '_tutor_certificates', true) ?: [];

    // Create temporary files
    $upload_dir = wp_upload_dir();
    $tmp_dir = $upload_dir['basedir'] . '/gdpr_exports/';
    if (!is_dir($tmp_dir)) wp_mkdir_p($tmp_dir);

    $json_file = $tmp_dir . "user_{$user_id}_data.json";
    file_put_contents($json_file, json_encode($personal_data, JSON_PRETTY_PRINT));

    // Create ZIP
    $zip_file = $tmp_dir . "user_{$user_id}_data.zip";
    $zip = new ZipArchive();
    if ($zip->open($zip_file, ZipArchive::CREATE | ZipArchive::OVERWRITE) !== true) {
        wp_send_json_error(['message' => 'Failed to create ZIP']);
    }

    $zip->addFile($json_file, basename($json_file));
    foreach ($files_to_include as $file) {
        $zip->addFile($file, 'uploads/' . basename($file));
    }
    $zip->close();

    // Serve ZIP
    header('Content-Type: application/zip');
    header('Content-Disposition: attachment; filename="user_data.zip"');
    header('Content-Length: ' . filesize($zip_file));
    readfile($zip_file);

    @unlink($json_file);
    @unlink($zip_file);
    exit;
});
-e 

===== ./inc/features/gdpr/templates/template.php =====

<?php
if (!defined('ABSPATH')) exit;

 $user_id = get_current_user_id();
 $user = wp_get_current_user();
if (!$user_id) {
    echo '<p>' . __('You must be logged in to access this page.', 'tutor') . '</p>';
    return;
}
?>
<style>
.tutor-dashboard-menu-item.tutor-gdpr-tab .tutor-dashboard-menu-item-icon::before {
    content: '';
    display: inline-block;
    width: 20px;
    height: 20px;
    margin-right: 8px;
    vertical-align: middle;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-6h2v6zm0-8h-2V7h2v4z"/></svg>');
    background-size: contain;
    background-repeat: no-repeat;
}
</style>
<div class="tutor-dashboard-content-inner">
    <h4><?php esc_html_e('GDPR Compliance – Your Data', 'tutor'); ?></h4>
    <p><?php esc_html_e('Export your personal data and delete your account if allowed.', 'tutor'); ?></p>

    <!-- Export Data -->
    <button type="button" id="export-data-btn" class="tutor-btn tutor-btn-primary tutor-mb-20">
        <i class="tutor-icon-download"></i> <?php esc_html_e('Export My Data', 'tutor'); ?>
    </button>

    <!-- Delete Account -->
    <button type="button" id="delete-account-btn" class="tutor-btn tutor-btn-danger">
        <i class="tutor-icon-trash"></i> <?php esc_html_e('Delete My Account', 'tutor'); ?>
    </button>

    <div id="gdpr-status" class="tutor-mt-20"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    // Export Data
    document.getElementById('export-data-btn').addEventListener('click', function() {
        window.location.href = "<?php echo admin_url('admin-ajax.php?action=gdpr_export_zip'); ?>";
    });

    // Delete Account
    document.getElementById('delete-account-btn').addEventListener('click', function() {
        if(!confirm("<?php echo esc_js('Are you sure you want to delete your account? This cannot be undone.'); ?>")) return;

        const statusDiv = document.getElementById('gdpr-status');
        statusDiv.innerHTML = '<?php echo esc_js("Deleting account..."); ?>';

        fetch("<?php echo admin_url('admin-ajax.php?action=delete_user_account'); ?>", {
            method: "POST",
            credentials: "same-origin",
            headers: {
                'X-WP-Nonce': "<?php echo wp_create_nonce('wp_rest'); ?>"
            }
        })
        .then(res => res.json())
        .then(data => {
            if(data.success){
                alert(data.data.message);
                window.location.href = "<?php echo home_url(); ?>";
            } else {
                statusDiv.innerHTML = '<div class="tutor-alert tutor-danger">' + data.data.message + '</div>';
            }
        }).catch(err => {
            statusDiv.innerHTML = '<div class="tutor-alert tutor-danger">An error occurred.</div>';
        });
    });
});
</script>-e 

===== ./inc/features/back-to-top/back-to-top.php =====

<?php
/**
 * Back to Top Feature
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Enqueue back-to-top script if enabled
function yiontech_lms_enqueue_back_to_top_script() {
    $enable_back_to_top = yiontech_lms_get_theme_setting('enable_back_to_top');
    if ($enable_back_to_top) {
        $theme_version = wp_get_theme()->get('Version');
        wp_enqueue_script('yiontech-lms-back-to-top', get_template_directory_uri() . '/inc/features/back-to-top/back-to-top.js', array('jquery'), $theme_version, true);
    }
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_back_to_top_script');

// Add back-to-top button to footer
function yiontech_lms_add_back_to_top_button() {
    $enable_back_to_top = yiontech_lms_get_theme_setting('enable_back_to_top');
    if ($enable_back_to_top) {
        ?>
        <a href="#" id="back-to-top" class="back-to-top">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>
            </svg>
        </a>
        <?php
    }
}
add_action('wp_footer', 'yiontech_lms_add_back_to_top_button');-e 

===== ./inc/features/back-to-top/back-to-top.js =====

/* ==========================
   Back To Top Script
========================== */
(function ($) {
    'use strict';

    function initBackToTop() {
        var backToTop = $('#back-to-top');
        var scrollThreshold = 100;

        if (!backToTop.length) return;

        // Show/hide button
        function toggleButton() {
            if ($(window).scrollTop() > scrollThreshold) {
                backToTop.addClass('visible');
            } else {
                backToTop.removeClass('visible');
            }
        }

        // Scroll listener with requestAnimationFrame
        let ticking = false;
        $(window).on('scroll', function () {
            if (!ticking) {
                window.requestAnimationFrame(function () {
                    toggleButton();
                    ticking = false;
                });
                ticking = true;
            }
        });

        // Initial state
        toggleButton();

        // Smooth scroll to top
        backToTop.on('click', function (e) {
            e.preventDefault();
            $('html, body').animate({ scrollTop: 0 }, 800);
        });
    }

    $(document).ready(function () {
        initBackToTop();
    });

})(jQuery);-e 

===== ./inc/features/newsletter/newsletter.php =====

<?php
/**
 * Newsletter Feature
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Newsletter AJAX handler
function yiontech_lms_newsletter_handler() {
    // Verify nonce
    if (!wp_verify_nonce($_POST['newsletter_subscription_nonce'], 'newsletter_subscription_action')) {
        wp_send_json_error('Security check failed');
    }
    
    // Get newsletter settings
    $action_url = yiontech_lms_get_theme_setting('newsletter_action_url');
    $method = yiontech_lms_get_theme_setting('newsletter_method', 'post');
    $email_field = yiontech_lms_get_theme_setting('newsletter_email_field', 'email');
    $hidden_fields = yiontech_lms_get_theme_setting('newsletter_hidden_fields', '');
    
    // Get email from form
    $email = isset($_POST['email']) ? sanitize_email($_POST['email']) : '';
    
    if (empty($email)) {
        wp_send_json_error('Please enter a valid email address');
    }
    
    // Prepare data
    $data = array($email_field => $email);
    
    // Add hidden fields
    if (!empty($hidden_fields)) {
        $lines = explode("\n", $hidden_fields);
        foreach ($lines as $line) {
            $parts = explode('=', $line, 2);
            if (count($parts) == 2) {
                $data[trim($parts[0])] = trim($parts[1]);
            }
        }
    }
    
    // Send request
    $response = wp_remote_post($action_url, array(
        'method' => strtoupper($method),
        'body' => $data,
    ));
    
    // Check for errors
    if (is_wp_error($response)) {
        wp_send_json_error('Subscription failed. Please try again.');
    }
    
    // Get response code
    $response_code = wp_remote_retrieve_response_code($response);
    
    // Check response code
    if ($response_code >= 200 && $response_code < 300) {
        wp_send_json_success('Subscription successful');
    } else {
        wp_send_json_error('Subscription failed. Please try again.');
    }
}
add_action('wp_ajax_yiontech_lms_newsletter', 'yiontech_lms_newsletter_handler');
add_action('wp_ajax_nopriv_yiontech_lms_newsletter', 'yiontech_lms_newsletter_handler');

// Enqueue newsletter script if enabled
function yiontech_lms_enqueue_newsletter_script() {
    $newsletter_enable = yiontech_lms_get_theme_setting('newsletter_enable');
    if ($newsletter_enable) {
        $theme_version = wp_get_theme()->get('Version');
        wp_enqueue_script('yiontech-lms-newsletter', get_template_directory_uri() . '/inc/features/newsletter/newsletter.js', array('jquery'), $theme_version, true);
        wp_localize_script('yiontech-lms-newsletter', 'yiontech_lms_newsletter', array(
            'ajax_url' => admin_url('admin-ajax.php'),
            'success_message' => yiontech_lms_get_theme_setting('newsletter_success_message', 'Thank you for subscribing!'),
        ));
    }
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_newsletter_script');-e 

===== ./inc/features/newsletter/newsletter-form.php =====

<?php
/**
 * Newsletter form template
 *
 * @package Yiontech_LMS
 */
?>
<?php
 $newsletter_enable = yiontech_lms_get_theme_setting('newsletter_enable');
 $newsletter_action_url = yiontech_lms_get_theme_setting('newsletter_action_url');
 $newsletter_method = yiontech_lms_get_theme_setting('newsletter_method', 'post');
 $newsletter_email_field = yiontech_lms_get_theme_setting('newsletter_email_field', 'email');
 $newsletter_hidden_fields = yiontech_lms_get_theme_setting('newsletter_hidden_fields', '');

// Get privacy settings
 $enable_privacy_features = yiontech_lms_get_theme_setting('enable_privacy_features');
 $privacy_policy_url = yiontech_lms_get_privacy_policy_url();
 $terms_of_service_url = yiontech_lms_get_terms_of_service_url();
?>
<?php if ($newsletter_enable && $newsletter_action_url) : ?>
<div class="newsletter-form">
    <form id="newsletter-form" class="mt-4" action="<?php echo esc_url($newsletter_action_url); ?>" method="<?php echo esc_attr($newsletter_method); ?>">
        <?php
        // Add nonce field
        wp_nonce_field('yiontech_newsletter_subscription_action', 'yiontech_newsletter_subscription_nonce');
        
        // Add hidden fields
        if (!empty($newsletter_hidden_fields)) {
            $lines = explode("\n", $newsletter_hidden_fields);
            foreach ($lines as $line) {
                $parts = explode('=', $line, 2);
                if (count($parts) == 2) {
                    echo '<input type="hidden" name="' . esc_attr(trim($parts[0])) . '" value="' . esc_attr(trim($parts[1])) . '" />';
                }
            }
        }
        ?>
        <div class="flex flex-col sm:flex-col gap-2">
            <input type="email" name="<?php echo esc_attr($newsletter_email_field); ?>" placeholder="Your email address" 
                   class="px-4 py-2 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 flex-grow" required>
            <button type="submit" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-lg transition duration-300">
                Subscribe
            </button>
        </div>
        
        <?php if ($enable_privacy_features && ($privacy_policy_url || $terms_of_service_url)) : ?>
            <div class="mt-2 text-xs text-gray-400">
                <input type="checkbox" id="newsletter-privacy-consent" name="privacy_consent" required>
                <label for="newsletter-privacy-consent">
                    <?php 
                    if ($privacy_policy_url && $terms_of_service_url) {
                        echo 'I agree to the <a href="' . esc_url($privacy_policy_url) . '" target="_blank">Privacy Policy</a> and <a href="' . esc_url($terms_of_service_url) . '" target="_blank">Terms of Service</a>';
                    } elseif ($privacy_policy_url) {
                        echo 'I agree to the <a href="' . esc_url($privacy_policy_url) . '" target="_blank">Privacy Policy</a>';
                    } elseif ($terms_of_service_url) {
                        echo 'I agree to the <a href="' . esc_url($terms_of_service_url) . '" target="_blank">Terms of Service</a>';
                    }
                    ?>
                </label>
            </div>
        <?php endif; ?>
        
        <div id="newsletter-message" class="mt-2 text-sm hidden"></div>
    </form>
</div>
<?php endif; ?>-e 

===== ./inc/features/newsletter/newsletter.js =====

(function($) {
    'use strict';
    
    $(document).ready(function() {
        $('#newsletter-form').on('submit', function(e) {
            e.preventDefault();
            
            var $form = $(this);
            var $message = $('#newsletter-message');
            var $submit = $form.find('button[type="submit"]');
            var originalText = $submit.text();
            
            // Show loading state
            $submit.prop('disabled', true).text('Subscribing...');
            $message.removeClass('hidden').removeClass('text-green-600 text-red-600').addClass('text-gray-600').text('Processing...');
            
            // Get form data
            var formData = $form.serialize();
            
            // Send AJAX request
            $.ajax({
                type: 'POST',
                url: yiontech_lms_newsletter.ajax_url,
                data: formData + '&action=yiontech_lms_newsletter',
                dataType: 'json',
                success: function(response) {
                    if (response.success) {
                        $message.removeClass('text-gray-600 text-red-600').addClass('text-green-600').text(yiontech_lms_newsletter.success_message);
                        $form[0].reset();
                    } else {
                        $message.removeClass('text-gray-600 text-green-600').addClass('text-red-600').text(response.data);
                    }
                },
                error: function() {
                    $message.removeClass('text-gray-600 text-green-600').addClass('text-red-600').text('Subscription failed. Please try again.');
                },
                complete: function() {
                    $submit.prop('disabled', false).text(originalText);
                }
            });
        });
    });
    
})(jQuery);-e 

===== ./inc/features/registration-modifier/templates/registration-blank-template.php =====

<?php
/**
 * Blank Template (No Header/Footer) for Registration
 */
if (!defined('ABSPATH')) exit;
?><!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
    <meta charset="<?php bloginfo('charset'); ?>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Remove any default max-width constraints */
        .site-content {
            max-width: 100% !important;
            width: 100% !important;
        }
        .form-wrapper {
            max-width: 100% !important;
            width: 100% !important;
        }
        /* Make sure the form takes full width */
        #tutor-registration-wrap {
            max-width: 100% !important;
            width: 100% !important;
        }
    </style>
    <?php wp_head(); ?>
</head>
<body <?php body_class('blank-template register-page bg-gray-50'); ?>>

<div class="site-content w-full" style="display:flex;align-items:center;justify-content:center;min-height:100vh;background:#f9fafb;">
    <div class="form-wrapper w-full" style="background:#fff;padding:0;border-radius:0;box-shadow:none;max-width:100%;">
        <?php
        if (have_posts()) :
            while (have_posts()) : the_post();
                the_content(); // Renders [custom_registration_form]
            endwhile;
        endif;
        ?>
    </div>
</div>

<?php wp_footer(); ?>
</body>
</html>-e 

===== ./inc/features/registration-modifier/registration-modifier.php =====

<?php
/**
 * Yiontech LMS Custom Auth – Registration with Document Upload Integration
 * Enhanced Professional UI Version with Two-Column Layout
 *
 * Handles:
 * - Registration
 * - File uploads during registration
 * - Full registration fields, hooks, notifications, and password strength meter
 * - Professional UI matching Yiontech brand standards
 * - Two-column layout for desktop
 * - Auto-creates /register page and assigns registration-blank-template.php
 * - Ensures template include points to this module's templates/registration-blank-template.php
 */

if (!defined('ABSPATH')) exit;

/*--------------------------------------------------------------
# 1. Get Tutor Dashboard URL
--------------------------------------------------------------*/
function yiontech_get_tutor_dashboard_url() {
    if (function_exists('tutor_utils')) {
        $dashboard_page_id = (int) tutor_utils()->get_option('tutor_dashboard_page_id');
        $dashboard_slug = $dashboard_page_id ? get_post_field('post_name', $dashboard_page_id) : '';
        if ($dashboard_slug) {
            return home_url(trailingslashit($dashboard_slug));
        }
    }
    return home_url('/');
}

/*--------------------------------------------------------------
# 2. Shortcode function (define, but register on init)
--------------------------------------------------------------*/
function yiontech_lms_custom_registration_form_shortcode() {
    if (is_user_logged_in()) {
        return '<div class="flex justify-center bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded-lg flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg></div><div class="ml-3"><p class="text-sm text-blue-700">You are already logged in. <a href="' . esc_url(yiontech_get_tutor_dashboard_url()) . '" class="font-medium underline hover:text-blue-800">Go to Dashboard</a></p></div></div>';
    }

    ob_start(); ?>
    <style>
      input{border: solid 2px #fcf8ff !important;}


    </style>
    <div id="tutor-registration-wrap" class="custom-auth-form w-full my-10 px-4 sm:px-6">
        <div class="bg-white rounded-2xl w-full overflow-hidden shadow-xl">
           
            
            <!-- Two-column content -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-0 w-full">
                <!-- Left column: Marketing section -->
                <div class="bg-gradient-to-br from-purple-50 to-indigo-50 p-8 lg:p-12 flex flex-col justify-center w-full">
                    <div class="max-w-md mx-auto w-full">
                        <!-- Header with brand color -->
                        <div class="py-5 px-6 relative overflow-hidden lg:-mx-10 lg:-mt-12 mb-0">
                       
                         <h1 class="text-4xl font-bold text-gray-800 mb-4"> <?php echo esc_html(get_bloginfo('name')); ?></h1>
                       
                        </div>
                        
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Start Your Learning Journey</h3>
                        <p class="text-gray-600 mb-6">Join thousands of students who are advancing their careers with our expert-led courses.</p>
                        
                        <div class="space-y-4 w-full">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    <div class="flex items-center justify-center h-6 w-6 rounded-full bg-purple-100 text-purple-600">
                                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <h4 class="text-sm font-medium text-gray-800">Expert Instructors</h4>
                                    <p class="text-sm text-gray-600 mt-1">Learn from industry professionals with real-world experience.</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    <div class="flex items-center justify-center h-6 w-6 rounded-full bg-purple-100 text-purple-600">
                                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <h4 class="text-sm font-medium text-gray-800">Flexible Learning</h4>
                                    <p class="text-sm text-gray-600 mt-1">Study at your own pace with our self-paced courses.</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    <div class="flex items-center justify-center h-6 w-6 rounded-full bg-purple-100 text-purple-600">
                                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <h4 class="text-sm font-medium text-gray-800">Certification</h4>
                                    <p class="text-sm text-gray-600 mt-1">Earn certificates upon completion to showcase your skills.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 w-full">
                            <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-200 w-full">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <img class="h-10 w-10 rounded-full" src="https://images.unsplash.com/photo-1494790108755-2616b612b786?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="Testimonial">
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium text-gray-900">Sarah Johnson</p>
                                        <div class="flex items-center">
                                            <div class="flex text-yellow-400">
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p class="mt-3 text-sm text-gray-600">"The courses here transformed my career. The instructors are top-notch and the content is practical and up-to-date."</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right column: Form -->
                <div class="p-8 w-full">
                    <form id="custom_registration_form" enctype="multipart/form-data" class="space-y-6 w-full">
                        <?php wp_nonce_field('custom_registration_action', 'custom_registration_nonce'); ?>
                        <?php do_action('tutor_before_student_reg_form'); ?>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" for="first_name">First Name</label>
                                <input type="text" name="first_name" id="first_name" value="<?php echo esc_attr(tutor_utils()->input_old('first_name')); ?>" required autocomplete="given-name" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" for="last_name">Last Name</label>
                                <input type="text" name="last_name" id="last_name" value="<?php echo esc_attr(tutor_utils()->input_old('last_name')); ?>" required autocomplete="family-name" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" for="reg_username">Username</label>
                                <input type="text" name="reg_username" id="reg_username" value="<?php echo esc_attr(tutor_utils()->input_old('reg_username')); ?>" required autocomplete="username" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" for="reg_email">Email</label>
                                <input type="email" name="reg_email" id="reg_email" value="<?php echo esc_attr(tutor_utils()->input_old('reg_email')); ?>" required autocomplete="email" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
                            <div>
                                <div class="password-strength-checker w-full">
                                    <div class="password-field w-full">
                                        <label class="block text-sm font-medium text-gray-700 mb-2" for="tutor-new-password">Password</label>
                                        <div class="relative w-full">
                                            <input class="password-checker w-full pr-12 px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200" id="tutor-new-password" type="password" name="reg_password" value="" placeholder="Password" required autocomplete="new-password">
                                            <button type="button" class="show-hide-btn absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600">
                                                <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                                                </svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="password-strength-hint mt-3 w-full">
                                        <div class="flex justify-between gap-10 items-center mb-1 w-full">
                                            <div class="indicator flex space-x-1 w-full">
                                                <span class="weak h-1.5 w-1/4 rounded-full bg-gray-200"></span>
                                                <span class="medium h-1.5 w-1/4 rounded-full bg-gray-200"></span>
                                                <span class="strong h-1.5 w-1/4 rounded-full bg-gray-200"></span>
                                                <span class="very-strong h-1.5 w-1/4 rounded-full bg-gray-200"></span>
                                            </div>
                                            <span class="strength-text w-[100px] text-xs font-medium">Very Weak</span>
                                        </div>
                                        <div class="text text-xs text-gray-500">Use 8 or more characters with a mix of letters, numbers & symbols</div>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2" for="reg_confirm_password">Confirm Password</label>
                                <input type="password" name="reg_confirm_password" id="reg_confirm_password" value="" placeholder="Confirm Password" required autocomplete="new-password" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                            </div>
                        </div>

                        <div class="w-full">
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="reg_documents">Upload Documents</label>
                            <div class="file-upload-area mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer hover:border-purple-500 hover:bg-purple-50 transition duration-200 w-full">
                                <div class="space-y-1 text-center">
                                    <svg class="mx-auto h-12 w-12 text-gray-400" stroke="currentColor" fill="none" viewBox="0 0 48 48" aria-hidden="true">
                                        <path d="M28 8H12a4 4 0 00-4 4v20m32-12v8m0 0v8a4 4 0 01-4 4H12a4 4 0 01-4-4v-4m32-4l-3.172-3.172a4 4 0 00-5.656 0L28 28M8 32l9.172-9.172a4 4 0 015.656 0L28 28m0 0l4 4m4-24h8m-4-4v8m-12 4h.02" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
                                    </svg>
                                    <div class="flex text-sm text-gray-600">
                                        <label for="reg_documents" class="relative cursor-pointer bg-white rounded-md font-medium text-purple-600 hover:text-purple-500 focus-within:outline-none">
                                            <span>Upload files</span>
                                            <input id="reg_documents" name="reg_documents[]" type="file" multiple class="sr-only">
                                        </label>
                                        <p class="pl-1">or drag and drop</p>
                                    </div>
                                    <p class="text-xs text-gray-500">PDF, DOC, DOCX up to 10MB each</p>
                                </div>
                            </div>
                            <div class="file-list mt-3 hidden"></div>
                        </div>

                        <?php do_action('tutor_student_reg_form_middle'); ?>
                        <?php do_action('register_form'); ?>

                        <?php
                        $tutor_toc_page_link = tutor_utils()->get_toc_page_link();
                        if ($tutor_toc_page_link) :
                        ?>
                            <div class="text-sm text-gray-600 flex items-start">
                                <input type="checkbox" id="terms" class="mt-1 mr-2 h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                                <label for="terms">By signing up, I agree with the website's <a target="_blank" href="<?php echo esc_url($tutor_toc_page_link); ?>" class="font-medium text-purple-600 hover:text-purple-500">Terms and Conditions</a></label>
                            </div>
                        <?php endif; ?>

                        <div class="mt-8 w-full">
                            <button type="submit" name="tutor_register_student_btn" value="register" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition duration-200">
                                Create Account
                            </button>
                        </div>

                        <?php do_action('tutor_after_register_button'); ?>
                    </form>

                    <div id="registration_result" class="mt-4 w-full"></div>
                    <p class="mt-6 text-center text-sm text-gray-600 w-full">
                        Already have an account? 
                        <a href="<?php echo esc_url(get_permalink(get_page_by_path('login'))); ?>" class="font-medium text-purple-600 hover:text-purple-500">
                            Login
                        </a>
                    </p>

                    <?php do_action('tutor_after_student_reg_form'); ?>
                </div>
            </div>
        </div>
        
        <!-- Footer with Yiontech branding -->
        <div class="mt-8 text-center text-gray-500 text-sm w-full">
            <p>© <?php echo date('Y'); ?> <?php echo esc_html(get_bloginfo('name')); ?>. All rights reserved.</p>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/*--------------------------------------------------------------
# 3. Register shortcode early (init)
--------------------------------------------------------------*/
add_action('init', function() {
    // register shortcode here so it's available before templates render
    add_shortcode('custom_registration_form', 'yiontech_lms_custom_registration_form_shortcode');
});

/*--------------------------------------------------------------
# 4. Enqueue registration scripts (ajax)
--------------------------------------------------------------*/
function yiontech_lms_enqueue_registration_scripts() {
    wp_enqueue_script('jquery');
    wp_enqueue_media();

    wp_add_inline_script('jquery', "
        jQuery(document).ready(function($){
            // Registration AJAX
            $('#custom_registration_form').on('submit', function(e){
                e.preventDefault();
                
                // Show loading state
                var submitBtn = $(this).find('button[type=\"submit\"]');
                var originalText = submitBtn.text();
                submitBtn.prop('disabled', true).html('<svg class=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle><path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path></svg> Creating Account...');
                
                var formData = new FormData(this);
                formData.append('action', 'yiontech_register');
                $.ajax({
                    url: '" . admin_url('admin-ajax.php') . "',
                    type: 'POST',
                    data: formData,
                    contentType: false,
                    processData: false,
                    dataType: 'json',
                    success: function(response){
                        if(response.success){
                            $('#registration_result').html('<div class=\"bg-green-50 border-l-4 border-green-500 p-4 mb-4 rounded flex\"><div class=\"flex-shrink-0\"><svg class=\"h-5 w-5 text-green-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\" /></svg></div><div class=\"ml-3\"><p class=\"text-sm text-green-700\">Registration successful! Redirecting...</p></div></div>');
                            setTimeout(function(){
                                window.location.href = response.data.redirect;
                            }, 1500);
                        } else {
                            $('#registration_result').html('<div class=\"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded flex\"><div class=\"flex-shrink-0\"><svg class=\"h-5 w-5 text-red-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" /></svg></div><div class=\"ml-3\"><p class=\"text-sm text-red-700\">'+response.data+'</p></div></div>');
                            submitBtn.prop('disabled', false).text(originalText);
                        }
                    },
                    error: function(){
                        $('#registration_result').html('<div class=\"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded flex\"><div class=\"flex-shrink-0\"><svg class=\"h-5 w-5 text-red-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" /></svg></div><div class=\"ml-3\"><p class=\"text-sm text-red-700\">An unexpected error occurred. Please try again.</p></div></div>');
                        submitBtn.prop('disabled', false).text(originalText);
                    }
                });
            });

            // Password strength checker
            function checkPasswordStrength(password) {
                var strength = 0;
                if (password.length >= 8) strength++;
                if (password.match(/[a-z]+/)) strength++;
                if (password.match(/[A-Z]+/)) strength++;
                if (password.match(/[0-9]+/)) strength++;
                if (password.match(/[\\W]+/)) strength++;
                return strength;
            }

            $('#tutor-new-password').on('input', function(){
                var strength = checkPasswordStrength($(this).val());
                var indicators = $(this).closest('.password-strength-checker').find('.indicator span');
                var strengthText = $(this).closest('.password-strength-checker').find('.strength-text');
                
                indicators.removeClass('active bg-red-500 bg-yellow-500 bg-green-500');
                strengthText.removeClass('text-red-500 text-yellow-500 text-green-500');
                
                if (strength === 0) {
                    strengthText.text('Very Weak').addClass('text-red-500');
                } else if (strength === 1) {
                    strengthText.text('Weak').addClass('text-red-500');
                    indicators.eq(0).addClass('active bg-red-500');
                } else if (strength === 2) {
                    strengthText.text('Fair').addClass('text-yellow-500');
                    for(var i=0; i<2; i++) {
                        indicators.eq(i).addClass('active bg-yellow-500');
                    }
                } else if (strength === 3) {
                    strengthText.text('Good').addClass('text-yellow-500');
                    for(var i=0; i<3; i++) {
                        indicators.eq(i).addClass('active bg-yellow-500');
                    }
                } else if (strength === 4) {
                    strengthText.text('Strong').addClass('text-green-500');
                    for(var i=0; i<4; i++) {
                        indicators.eq(i).addClass('active bg-green-500');
                    }
                } else if (strength === 5) {
                    strengthText.text('Very Strong').addClass('text-green-500');
                    for(var i=0; i<4; i++) {
                        indicators.eq(i).addClass('active bg-green-500');
                    }
                }
            });
            
            // Show/hide password
            $('.show-hide-btn').on('click', function(){
                var passwordField = $(this).closest('.password-field').find('input');
                if (passwordField.attr('type') === 'password') {
                    passwordField.attr('type', 'text');
                    $(this).find('svg').html('<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21\" />');
                } else {
                    passwordField.attr('type', 'password');
                    $(this).find('svg').html('<path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M15 12a3 3 0 11-6 0 3 3 0 016 0z\" /><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z\" />');
                }
            });
            
            // File upload area interaction
            var fileUploadArea = $('.file-upload-area');
            var fileInput = $('#reg_documents');
            
            fileUploadArea.on('dragover', function(e) {
                e.preventDefault();
                $(this).addClass('border-purple-500 bg-purple-50');
            });
            
            fileUploadArea.on('dragleave', function(e) {
                e.preventDefault();
                $(this).removeClass('border-purple-500 bg-purple-50');
            });
            
            fileUploadArea.on('drop', function(e) {
                e.preventDefault();
                $(this).removeClass('border-purple-500 bg-purple-50');
                
                var files = e.originalEvent.dataTransfer.files;
                fileInput.prop('files', files);
                
                // Display selected files
                displaySelectedFiles(files);
            });
            
            fileInput.on('change', function() {
                displaySelectedFiles(this.files);
            });
            
            function displaySelectedFiles(files) {
                var fileList = $('.file-list');
                fileList.empty();
                
                if (files.length > 0) {
                    fileList.append('<h4 class=\"text-sm font-medium text-gray-700 mb-2\">Selected Files:</h4>');
                    fileList.append('<ul class=\"space-y-1\">');
                    
                    for (var i = 0; i < files.length; i++) {
                        var fileName = files[i].name;
                        var fileSize = (files[i].size / 1024).toFixed(2) + ' KB';
                        
                        fileList.find('ul').append(
                            '<li class=\"flex items-center justify-between text-sm text-gray-600 py-1 px-2 bg-gray-50 rounded\">' +
                            '<span class=\"truncate max-w-xs\">' + fileName + '</span>' +
                            '<span class=\"text-xs text-gray-500\">' + fileSize + '</span>' +
                            '</li>'
                        );
                    }
                    
                    fileList.append('</ul>');
                    fileList.show();
                } else {
                    fileList.hide();
                }
            }
        });
    ");
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_registration_scripts');

/*--------------------------------------------------------------
# 5. AJAX Registration Handler
--------------------------------------------------------------*/
function yiontech_lms_ajax_register() {
     // Verify nonce
    if (!wp_verify_nonce($_POST['custom_registration_nonce'], 'custom_registration_action')) {
        wp_send_json_error('Security check failed');
    }
    
    $username   = sanitize_user($_POST['reg_username']);
    $email      = sanitize_email($_POST['reg_email']);
    $password   = $_POST['reg_password'];
    $confirm    = $_POST['reg_confirm_password'];
    $first_name = sanitize_text_field($_POST['first_name']);
    $last_name  = sanitize_text_field($_POST['last_name']);

    if (!defined('USER_DOC_META_KEY')) define('USER_DOC_META_KEY', 'yiontech_user_documents');
    if (!defined('PRIVATE_UPLOAD_DIR_ROOT')) define('PRIVATE_UPLOAD_DIR_ROOT', WP_CONTENT_DIR . '/uploads/yiontech-lms-private/');

    if ($password !== $confirm) wp_send_json_error('Passwords do not match.');
    if (username_exists($username) || email_exists($email)) wp_send_json_error('Username or email already exists.');

    $user_id = wp_create_user($username, $password, $email);
    if (is_wp_error($user_id)) wp_send_json_error($user_id->get_error_message());

    wp_update_user([
        'ID'         => $user_id,
        'first_name' => $first_name,
        'last_name'  => $last_name
    ]);

    wp_set_current_user($user_id);
    wp_set_auth_cookie($user_id);

    // File uploads
    $uploaded_files = [];
    if (!empty($_FILES['reg_documents']['name'][0])) {
        $user_dir = PRIVATE_UPLOAD_DIR_ROOT . $user_id . '/';
        if (!is_dir($user_dir)) wp_mkdir_p($user_dir);

        foreach ($_FILES['reg_documents']['name'] as $key => $name) {
            if ($_FILES['reg_documents']['error'][$key] === UPLOAD_ERR_OK) {
                $file_name   = sanitize_file_name($name);
                $target_path = $user_dir . $file_name;
                if (move_uploaded_file($_FILES['reg_documents']['tmp_name'][$key], $target_path)) {
                    $uploaded_files[] = [
                        'filename'    => $file_name,
                        'path'        => $target_path,
                        'uploaded_on' => current_time('mysql'),
                        'size'        => filesize($target_path),
                        'type'        => 'file',
                    ];
                }
            }
        }
    }
    update_user_meta($user_id, USER_DOC_META_KEY, $uploaded_files);
    update_user_meta($user_id, 'yiontech_first_login', 1);

    // Trigger Tutor registration hooks & notifications
    do_action('tutor_student_registered', $user_id);

    wp_send_json_success(['redirect' => yiontech_get_tutor_dashboard_url()]);
}
add_action('wp_ajax_nopriv_yiontech_register', 'yiontech_lms_ajax_register');
add_action('wp_ajax_yiontech_register', 'yiontech_lms_ajax_register');

/*--------------------------------------------------------------
# 6. Auto-create register page & assign template (init)
#    Use init so shortcode registration and filters are available.
--------------------------------------------------------------*/
add_action('init', function () {
    $slug      = 'register';
    $title     = 'Register';
    $shortcode = '[custom_registration_form]';
    $template  = 'registration-blank-template.php'; // Changed to use registration-specific template

    $page = get_page_by_path($slug);

    if (!$page) {
        $page_id = wp_insert_post([
            'post_title'   => $title,
            'post_name'    => $slug,
            'post_content' => $shortcode,
            'post_status'  => 'publish',
            'post_type'    => 'page',
            'post_name'     => $slug
        ]);

        if ($page_id && !is_wp_error($page_id)) {
            update_option("yiontech_page_{$slug}_id", $page_id);
            update_post_meta($page_id, '_wp_page_template', $template);
        }
    } else {
        if (strpos($page->post_content, $shortcode) === false) {
            wp_update_post([
                'ID'           => $page->ID,
                'post_content' => $shortcode,
            ]);
            // Refresh $page variable if needed
            $page = get_post($page->ID);
        }
        update_option("yiontech_page_{$slug}_id", $page->ID);
        update_post_meta($page->ID, '_wp_page_template', $template);
    }
});

/*--------------------------------------------------------------
# 7. Register and load custom blank template from this module
--------------------------------------------------------------*/
add_filter('theme_page_templates', function ($templates) {
    // expose the template name in Page > Template dropdown (optional)
    $templates['registration-blank-template.php'] = 'Registration Blank (No Header/Footer)';
    return $templates;
});

add_filter('template_include', function ($template) {
    if (is_page_template('registration-blank-template.php')) {
        $module_template = __DIR__ . '/templates/registration-blank-template.php';
        if (file_exists($module_template)) {
            return $module_template;
        }
    }
    return $template;
});-e 

===== ./inc/features/document-upload/error-messages.php =====

<?php
/**
 * Document Upload Error Messages
 *
 * @package Yiontech_LMS
 */

// Add custom error messages for document upload status
add_action('tutor_dashboard/before_content', function() {
    if (isset($_GET['upload_status'])) {
        $status = sanitize_text_field($_GET['upload_status']);
        $message = '';
        $type = 'success';
        
        switch ($status) {
            case 'success':
                $message = __('Document uploaded successfully!', 'tutor');
                $type = 'success';
                break;
            case 'deleted':
                $message = __('Document deleted successfully!', 'tutor');
                $type = 'success';
                break;
            case 'file_error':
                $message = __('Error uploading file. Please try again.', 'tutor');
                $type = 'danger';
                break;
            case 'invalid_file_type':
                $message = __('Invalid file type. Allowed types: JPG, JPEG, PNG, GIF, PDF, DOC, DOCX, TXT', 'tutor');
                $type = 'danger';
                break;
            case 'file_too_large':
                $message = __('File size too large. Maximum size: 10MB', 'tutor');
                $type = 'danger';
                break;
            default:
                $message = __('An unknown error occurred.', 'tutor');
                $type = 'danger';
                break;
        }
        
        if ($message) {
            echo '<div class="tutor-alert tutor-' . esc_attr($type) . '">' . esc_html($message) . '</div>';
        }
    }
});-e 

===== ./inc/features/document-upload/template.php =====

<?php
/**
 * Document Upload Feature – Template (Image Thumbnail + File Type Icons)
 *
 * @package Yiontech_LMS
 */
if (!defined('ABSPATH')) exit;

$user_id        = get_current_user_id();
$uploaded_files = get_user_meta($user_id, USER_DOC_META_KEY, true);
if (!is_array($uploaded_files)) $uploaded_files = [];
?>

<div class="tutor-dashboard-content-inner">
    <h4><?php esc_html_e('My Documents', 'tutor'); ?></h4>

    <!-- Upload form -->
    <form method="post" enctype="multipart/form-data" class="tutor-mb-20 tutor-flex tutor-items-center tutor-gap-3 mt-10 flex flex-row justify-between">
        <?php wp_nonce_field('tutor_document_upload_action', 'tutor_document_upload_nonce'); ?>

        <!-- Custom Upload -->
        <div class="custom-upload-wrapper tutor-flex tutor-items-center tutor-gap-2">
            <input type="file" id="user_document" name="user_document" required>
            <label for="user_document" class="tutor-btn tutor-btn-primary tutor-btn-icon">
                <i class="tutor-icon-upload"></i> <?php esc_html_e('Choose File', 'tutor'); ?>
            </label>
            <span id="file-chosen" class="tutor-color-muted">
                <?php esc_html_e('No file chosen', 'tutor'); ?>
            </span>
        </div>

        <button type="submit" name="tutor_document_upload_submit" class="tutor-btn tutor-btn-success gap-1">
            <i class="tutor-icon-plus"></i> <?php esc_html_e('Upload', 'tutor'); ?>
        </button>
    </form>

    <?php if (!empty($uploaded_files)) : ?>
        <div class="tutor-table-responsive">
            <table class="tutor-table tutor-table-bordered tutor-mt-20">
                <thead>
                    <tr>
                        <th><?php esc_html_e('Preview', 'tutor'); ?></th>
                        <th><?php esc_html_e('Filename', 'tutor'); ?></th>
                        <th><?php esc_html_e('File Type', 'tutor'); ?></th>
                        <th><?php esc_html_e('Size', 'tutor'); ?></th>
                        <th><?php esc_html_e('Date Uploaded', 'tutor'); ?></th>
                        <th><?php esc_html_e('Action', 'tutor'); ?></th>
                    </tr>
                </thead>
                <tbody>
                    <?php foreach ($uploaded_files as $file) :
                        $filetype = strtolower(pathinfo($file['filename'], PATHINFO_EXTENSION));
                        $file_url = add_query_arg('document_download', urlencode($file['filename']), site_url());
                        ?>
                        <tr>
                            <td>
                                <a href="<?php echo esc_url($file_url); ?>" target="_blank">
                                    <?php if (in_array($filetype, ['jpg', 'jpeg', 'png', 'gif', 'webp'])) : ?>
                                        <!-- Show real image thumbnail -->
                                        <img src="<?php echo esc_url($file_url); ?>" style="width:40px;height:40px;object-fit:cover;border-radius:4px;">

                                    <?php elseif ($filetype === 'pdf') : ?>
                                        <!-- PDF SVG -->
                                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6" style="width:24px;height:24px;color:#e63946;" fill="currentColor" viewBox="0 0 384 512">
                                            <path d="M181.9 256.1c-4.8 0-8.9-3.3-9.8-7.9L128 32h128l-44.1 216.2c-.9 4.6-5 7.9-9.8 7.9zm202.6-98.7l-84.9-84.9c-9.1-9.1-21.6-14.2-34.6-14.2H48C21.5 58.3 0 79.8 0 106.3v299.4c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V173.8c0-13-5.1-25.5-14.5-35.9z"/>
                                        </svg>

                                    <?php elseif (in_array($filetype, ['doc', 'docx'])) : ?>
                                        <!-- Word SVG -->
                                        <svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px;color:#2b579a;" fill="currentColor" viewBox="0 0 384 512">
                                            <path d="M64 32H320c17.7 0 32 14.3 32 32V448c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V64C32 46.3 46.3 32 64 32zM96 128V384H128V128H96zM160 128V384H192V128H160zM224 128V384h32V128H224z"/>
                                        </svg>

                                    <?php elseif (in_array($filetype, ['xls', 'xlsx'])) : ?>
                                        <!-- Excel SVG -->
                                        <svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px;color:#217346;" fill="currentColor" viewBox="0 0 384 512">
                                            <path d="M64 32H320c17.7 0 32 14.3 32 32V448c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V64C32 46.3 46.3 32 64 32zM256 128L192 256 256 384H224L160 256l64-128h32z"/>
                                        </svg>

                                    <?php elseif (in_array($filetype, ['ppt', 'pptx'])) : ?>
                                        <!-- PowerPoint SVG -->
                                        <svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px;color:#d24726;" fill="currentColor" viewBox="0 0 384 512">
                                            <path d="M192 32H64C46.3 32 32 46.3 32 64V448c0 17.7 14.3 32 32 32H192V32zM256 32V480h64c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32H256z"/>
                                        </svg>

                                    <?php elseif ($filetype === 'txt') : ?>
                                        <!-- Text file SVG -->
                                        <svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px;color:#444;" fill="currentColor" viewBox="0 0 384 512">
                                            <path d="M64 32H320c17.7 0 32 14.3 32 32V448c0 17.7-14.3 32-32 32H64c-17.7 0-32-14.3-32-32V64C32 46.3 46.3 32 64 32zM96 128H288v32H96V128zM96 192H288v32H96V192zM96 256H224v32H96V256z"/>
                                        </svg>

                                    <?php else : ?>
                                        <!-- Generic file SVG -->
                                        <svg xmlns="http://www.w3.org/2000/svg" style="width:24px;height:24px;color:#888;" fill="currentColor" viewBox="0 0 384 512">
                                            <path d="M224 136V0H64C46.3 0 32 14.3 32 32V480c0 17.7 14.3 32 32 32H320c17.7 0 32-14.3 32-32V160H248C234.7 160 224 149.3 224 136zM384 121.9V128H256V0h6.1c8.5 0 16.6 3.4 22.6 9.4L374.6 97.4c6 6 9.4 14.1 9.4 22.6z"/>
                                        </svg>
                                    <?php endif; ?>
                                </a>
                            </td>
                            <td><?php echo esc_html($file['filename']); ?></td>
                            <td><?php echo strtoupper(esc_html($filetype)); ?></td>
                            <td><?php echo isset($file['size']) ? size_format($file['size']) : __('N/A', 'tutor'); ?></td>
                            <td><?php echo esc_html(date(get_option('date_format'), strtotime($file['uploaded_on']))); ?></td>
                            <td>
                                <form method="post" onsubmit="return confirm('Are you sure you want to remove this file?');">
                                    <?php wp_nonce_field('tutor_document_delete_action', 'tutor_document_delete_nonce'); ?>
                                    <input type="hidden" name="delete_filename" value="<?php echo esc_attr($file['filename']); ?>">
                                    <button type="submit" name="tutor_document_delete_submit" class="tutor-btn tutor-btn-sm tutor-btn-danger">
                                        <i class="tutor-icon-trash"></i> <?php esc_html_e('Remove', 'tutor'); ?>
                                    </button>
                                </form>
                            </td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>
    <?php else : ?>
        <p class="tutor-text-muted tutor-mt-20"><?php esc_html_e('No documents uploaded yet.', 'tutor'); ?></p>
    <?php endif; ?>
</div>

<!-- Styles to hide native file input -->
<style>
    #user_document {
        position: absolute;
        left: -9999px;
        visibility: hidden;
        width: 0;
        height: 0;
    }
</style>

<!-- JavaScript to Show File Name -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    const fileInput = document.getElementById("user_document");
    const fileChosen = document.getElementById("file-chosen");

    fileInput.addEventListener("change", function() {
        fileChosen.textContent = this.files.length > 0 ? this.files[0].name : "<?php esc_html_e('No file chosen', 'tutor'); ?>";
    });
});
</script>
-e 

===== ./inc/features/document-upload/document-upload.php =====

<?php
/**
 * Document Upload Feature – Functions
 * Secure uploads for Tutor LMS Dashboard with preview & delete
 *
 * @package Yiontech_LMS
 */

if (!defined('ABSPATH')) exit;

define('PRIVATE_UPLOAD_DIR_ROOT', WP_CONTENT_DIR . '/private-user-data/');
define('USER_DOC_META_KEY', 'user_uploaded_documents');

/**
 * Setup private directory with .htaccess protection
 */
add_action('init', function () {
    $root_dir      = PRIVATE_UPLOAD_DIR_ROOT;
    $htaccess_path = $root_dir . '.htaccess';
    $index_path    = $root_dir . 'index.php';

    if (!is_dir($root_dir)) {
        wp_mkdir_p($root_dir);
    }

    // Restrict direct access to uploaded files
    if (!file_exists($htaccess_path)) {
        @file_put_contents($htaccess_path, "Options -Indexes\nDeny from all\n");
    }
    if (!file_exists($index_path)) {
        @file_put_contents($index_path, '<?php // Silence is golden.');
    }
});

/**
 * Add new tab in Tutor Dashboard
 */
add_filter('tutor_dashboard/nav_items', function ($links) {
    $links['document-upload'] = [
        'title' => __('Document Upload', 'tutor'),
        'icon'  => 'tutor-icon-document-upload',
    ];
    return $links;
});

/**
 * Handle file upload & deletion
 */
add_action('init', function () {
    $user_id = get_current_user_id();
    if (!$user_id) return;

    // Upload
    if (isset($_POST['tutor_document_upload_submit'], $_FILES['user_document'])) {
        if (!isset($_POST['tutor_document_upload_nonce']) ||
            !wp_verify_nonce($_POST['tutor_document_upload_nonce'], 'tutor_document_upload_action')) {
            wp_die(__('Security check failed.', 'tutor'));
        }

        $file = $_FILES['user_document'];
        if ($file['error'] !== UPLOAD_ERR_OK) {
            wp_redirect(add_query_arg('upload_status', 'file_error', tutor_utils()->tutor_dashboard_url('document-upload')));
            exit;
        }

        // Enhanced file type validation
        $file_name = sanitize_file_name($file['name']);
        $file_ext = strtolower(pathinfo($file_name, PATHINFO_EXTENSION));
        $allowed_types = array('jpg', 'jpeg', 'png', 'gif', 'pdf', 'doc', 'docx', 'txt');
        
        if (!in_array($file_ext, $allowed_types)) {
            wp_redirect(add_query_arg('upload_status', 'invalid_file_type', tutor_utils()->tutor_dashboard_url('document-upload')));
            exit;
        }

        // File size validation (10MB max)
        $max_size = 10 * 1024 * 1024; // 10MB in bytes
        if ($file['size'] > $max_size) {
            wp_redirect(add_query_arg('upload_status', 'file_too_large', tutor_utils()->tutor_dashboard_url('document-upload')));
            exit;
        }

        $user_dir    = PRIVATE_UPLOAD_DIR_ROOT . $user_id . '/';
        $file_name   = sanitize_file_name($file['name']);
        $target_path = $user_dir . $file_name;

        if (!is_dir($user_dir)) {
            wp_mkdir_p($user_dir);
        }

        if (move_uploaded_file($file['tmp_name'], $target_path)) {
            $existing_files = get_user_meta($user_id, USER_DOC_META_KEY, true);
            if (!is_array($existing_files)) $existing_files = [];

            $new_file_data = [
                'filename'    => $file_name,
                'path'        => $target_path,
                'uploaded_on' => current_time('mysql'),
                'size'        => filesize($target_path),
            ];

            $existing_files[] = $new_file_data;
            update_user_meta($user_id, USER_DOC_META_KEY, $existing_files);

            wp_redirect(add_query_arg('upload_status', 'success', tutor_utils()->tutor_dashboard_url('document-upload')));
            exit;
        }
    }

    // Delete
    if (isset($_POST['tutor_document_delete_submit'], $_POST['delete_filename'])) {
        if (!isset($_POST['tutor_document_delete_nonce']) ||
            !wp_verify_nonce($_POST['tutor_document_delete_nonce'], 'tutor_document_delete_action')) {
            wp_die(__('Security check failed.', 'tutor'));
        }

        $delete_filename = sanitize_text_field($_POST['delete_filename']);
        $existing_files  = get_user_meta($user_id, USER_DOC_META_KEY, true);

        if (is_array($existing_files)) {
            foreach ($existing_files as $key => $file) {
                if ($file['filename'] === $delete_filename) {
                    if (file_exists($file['path'])) @unlink($file['path']);
                    unset($existing_files[$key]);
                }
            }
            update_user_meta($user_id, USER_DOC_META_KEY, array_values($existing_files));
        }

        wp_redirect(add_query_arg('upload_status', 'deleted', tutor_utils()->tutor_dashboard_url('document-upload')));
        exit;
    }
});

/**
 * Secure file serve endpoint for previews/downloads
 */
add_action('init', function () {
    if (isset($_GET['document_download'])) {
        $user_id = get_current_user_id();
        if (!$user_id) {
            wp_die(__('Not authorized', 'tutor'));
        }

        $filename = sanitize_file_name($_GET['document_download']);
        $files    = get_user_meta($user_id, USER_DOC_META_KEY, true);

        if (is_array($files)) {
            foreach ($files as $file) {
                if ($file['filename'] === $filename && file_exists($file['path'])) {
                    $mime = wp_check_filetype($file['filename']);
                    if (empty($mime['type'])) {
                        $mime['type'] = 'application/octet-stream';
                    }
                    header('Content-Type: ' . $mime['type']);
                    header('Content-Disposition: inline; filename="' . basename($file['filename']) . '"');
                    header('Content-Length: ' . filesize($file['path']));
                    readfile($file['path']);
                    exit;
                }
            }
        }

        wp_die(__('File not found or access denied', 'tutor'));
    }
});-e 

===== ./inc/features/theme-settings/theme-settings.php =====

<?php
/**
 * Theme Settings Page
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Default theme settings
function yiontech_lms_get_default_settings() {
    $defaults = [
        'enable_preloader' => true,
        'site_icon' => '',
        'header_style' => 'default',
        'transparent_header' => false,
        'sticky_header' => true,
        'header_background_color' => '#1e40af',
        'sticky_header_background_color' => '#1e40af',
        'enable_back_to_top' => true,
        'logo_upload' => '',
        'retina_logo_upload' => '',
        'header_buttons' => [
            [
                'text' => __('Login', 'yiontech-lms'),
                'url' => '/login',
                'style' => 'outline',
                'show_desktop' => true,
                'show_mobile' => false,
            ],
            [
                'text' => __('Enquire Now', 'yiontech-lms'),
                'url' => '/contact',
                'style' => 'solid',
                'show_desktop' => true,
                'show_mobile' => true,
            ],
        ],
        'header_menu' => [
            ['text' => __('Home', 'yiontech-lms'), 'url' => '/'],
            ['text' => __('Courses', 'yiontech-lms'), 'url' => '/courses'],
            ['text' => __('About', 'yiontech-lms'), 'url' => '/about'],
            ['text' => __('Contact', 'yiontech-lms'), 'url' => '/contact'],
        ],
        'footer_style' => 'default',
        'footer_elementor_template' => 0,
        'footer_content' => [
            'column1' => [
                'title' => __('About Us', 'yiontech-lms'),
                'content' => __('A powerful learning management system designed for educators and students.', 'yiontech-lms'),
            ],
            'column2' => [
                'title' => __('Quick Links', 'yiontech-lms'),
                'links' => [
                    ['text' => __('Home', 'yiontech-lms'), 'url' => '/'],
                    ['text' => __('Courses', 'yiontech-lms'), 'url' => '/courses'],
                    ['text' => __('About', 'yiontech-lms'), 'url' => '/about'],
                    ['text' => __('Contact', 'yiontech-lms'), 'url' => '/contact'],
                ],
            ],
            'column3' => [
                'title' => __('Company', 'yiontech-lms'),
                'links' => [
                    ['text' => __('About Us', 'yiontech-lms'), 'url' => '/about'],
                    ['text' => __('Our Team', 'yiontech-lms'), 'url' => '/team'],
                    ['text' => __('Careers', 'yiontech-lms'), 'url' => '/careers'],
                    ['text' => __('Blog', 'yiontech-lms'), 'url' => '/blog'],
                ],
            ],
            'column4' => [
                'title' => __('User Portal', 'yiontech-lms'),
                'links' => [
                    ['text' => __('Login', 'yiontech-lms'), 'url' => '/login'],
                    ['text' => __('Register', 'yiontech-lms'), 'url' => '/register'],
                    ['text' => __('Dashboard', 'yiontech-lms'), 'url' => '/dashboard'],
                    ['text' => __('Profile', 'yiontech-lms'), 'url' => '/profile'],
                ],
            ],
            'column5' => [
                'title' => __('Newsletter', 'yiontech-lms'),
                'content' => __('Get the latest news and updates delivered right to your inbox.', 'yiontech-lms'),
                'email' => 'info@yiontech.com',
                'phone' => '+1 (555) 123-4567',
            ],
        ],
        'copyright_text' => sprintf(__('&copy; %s %s. All rights reserved.', 'yiontech-lms'), date('Y'), get_bloginfo('name')),
        'footer_text_color' => '#ffffff',
        'footer_background_color' => '#111827',
        'copyright_background_color' => '#0f172a',
        'footer_padding' => ['top' => 48, 'bottom' => 48],
        'newsletter_enable' => false,
        'newsletter_action_url' => '',
        'newsletter_method' => 'post',
        'newsletter_email_field' => 'email',
        'newsletter_hidden_fields' => '',
        'newsletter_success_message' => __('Thank you for subscribing!', 'yiontech-lms'),
        'custom_css' => '',
        'enable_privacy_features' => true,
        'privacy_policy_page' => 0,
        'terms_of_service_page' => 0,
        'cookie_consent_text' => __('We use cookies to ensure you get the best experience on our website. By continuing to use this site, you consent to our use of cookies.', 'yiontech-lms'),
        'cookie_consent_button_text' => __('Accept', 'yiontech-lms'),
        'cookie_consent_learn_more_text' => __('Learn More', 'yiontech-lms'),
        'enable_data_export' => true,
        'enable_account_deletion' => true,
        'disable_gutenberg' => false, // Changed to false to encourage block editor support
    ];
    return apply_filters('yiontech_lms_default_settings', $defaults);
}

// Get theme setting with sanitization
function yiontech_lms_get_theme_setting($key, $default = '') {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = isset($options[$key]) ? $options[$key] : $default;

    // Sanitize based on key type
    switch ($key) {
        case 'header_background_color':
        case 'sticky_header_background_color':
        case 'footer_background_color':
        case 'footer_text_color':
        case 'copyright_background_color':
            return sanitize_hex_color($value);
        case 'site_icon':
        case 'logo_upload':
        case 'retina_logo_upload':
        case 'newsletter_action_url':
            return esc_url_raw($value);
        case 'newsletter_email_field':
        case 'newsletter_success_message':
        case 'cookie_consent_button_text':
        case 'cookie_consent_learn_more_text':
            return sanitize_text_field($value);
        case 'newsletter_hidden_fields':
            return yiontech_lms_sanitize_hidden_fields($value);
        case 'custom_css':
            return wp_strip_all_tags($value);
        case 'copyright_text':
        case 'cookie_consent_text':
            return wp_kses_post($value);
        case 'header_style':
        case 'footer_style':
        case 'newsletter_method':
            return in_array($value, ['default', 'minimal', 'centered', 'post', 'get']) ? $value : $default;
        case 'enable_preloader':
        case 'transparent_header':
        case 'sticky_header':
        case 'enable_back_to_top':
        case 'newsletter_enable':
        case 'enable_privacy_features':
        case 'enable_data_export':
        case 'enable_account_deletion':
        case 'disable_gutenberg':
            return (bool) $value;
        case 'privacy_policy_page':
        case 'terms_of_service_page':
        case 'footer_elementor_template':
            return absint($value);
        case 'header_buttons':
            return yiontech_lms_sanitize_header_buttons($value);
        case 'header_menu':
            return yiontech_lms_sanitize_header_menu($value);
        case 'footer_content':
            return yiontech_lms_sanitize_footer_content($value);
        case 'footer_padding':
            return yiontech_lms_sanitize_footer_padding($value);
        default:
            return sanitize_text_field($value);
    }
}

// Sanitization functions
function yiontech_lms_sanitize_text($input) {
    return sanitize_text_field($input);
}

function yiontech_lms_sanitize_html($input) {
    return wp_kses_post($input);
}

function yiontech_lms_sanitize_url($input) {
    return esc_url_raw($input);
}

function yiontech_lms_sanitize_color($input) {
    return sanitize_hex_color($input);
}

function yiontech_lms_sanitize_checkbox($input) {
    return (bool) $input;
}

function yiontech_lms_sanitize_hidden_fields($input) {
    $sanitized = [];
    if (is_string($input)) {
        $lines = array_filter(array_map('trim', explode("\n", $input)));
        foreach ($lines as $line) {
            if (strpos($line, '=') !== false) {
                [$name, $value] = array_map('trim', explode('=', $line, 2));
                $sanitized[] = [
                    'name' => sanitize_key($name),
                    'value' => sanitize_text_field($value),
                ];
            }
        }
    }
    return $sanitized;
}

function yiontech_lms_sanitize_header_buttons($input) {
    $sanitized = [];
    if (is_array($input)) {
        foreach ($input as $button) {
            $sanitized[] = [
                'text' => sanitize_text_field($button['text'] ?? ''),
                'url' => esc_url_raw($button['url'] ?? ''),
                'style' => in_array($button['style'] ?? '', ['solid', 'outline']) ? $button['style'] : 'solid',
                'show_desktop' => (bool) ($button['show_desktop'] ?? true),
                'show_mobile' => (bool) ($button['show_mobile'] ?? true),
            ];
        }
    }
    return $sanitized;
}

function yiontech_lms_sanitize_header_menu($input) {
    $sanitized = [];
    if (is_array($input)) {
        foreach ($input as $item) {
            $sanitized[] = [
                'text' => sanitize_text_field($item['text'] ?? ''),
                'url' => esc_url_raw($item['url'] ?? ''),
            ];
        }
    }
    return $sanitized;
}

function yiontech_lms_sanitize_footer_content($input) {
    $sanitized = [];
    $defaults = yiontech_lms_get_default_settings()['footer_content'];

    foreach (['column1', 'column2', 'column3', 'column4', 'column5'] as $col) {
        if (isset($input[$col])) {
            $sanitized[$col] = $input[$col];
        } else {
            $sanitized[$col] = $defaults[$col];
        }
    }

    $sanitized['column1'] = [
        'title' => sanitize_text_field($sanitized['column1']['title'] ?? ''),
        'content' => wp_kses_post($sanitized['column1']['content'] ?? ''),
    ];
    $sanitized['column2'] = [
        'title' => sanitize_text_field($sanitized['column2']['title'] ?? ''),
        'links' => yiontech_lms_sanitize_footer_links($sanitized['column2']['links'] ?? []),
    ];
    $sanitized['column3'] = [
        'title' => sanitize_text_field($sanitized['column3']['title'] ?? ''),
        'links' => yiontech_lms_sanitize_footer_links($sanitized['column3']['links'] ?? []),
    ];
    $sanitized['column4'] = [
        'title' => sanitize_text_field($sanitized['column4']['title'] ?? ''),
        'links' => yiontech_lms_sanitize_footer_links($sanitized['column4']['links'] ?? []),
    ];
    $sanitized['column5'] = [
        'title' => sanitize_text_field($sanitized['column5']['title'] ?? ''),
        'content' => wp_kses_post($sanitized['column5']['content'] ?? ''),
        'email' => sanitize_email($sanitized['column5']['email'] ?? ''),
        'phone' => sanitize_text_field($sanitized['column5']['phone'] ?? ''),
    ];

    return $sanitized;
}

function yiontech_lms_sanitize_footer_links($input) {
    $sanitized = [];
    if (is_array($input)) {
        foreach ($input as $link) {
            $sanitized[] = [
                'text' => sanitize_text_field($link['text'] ?? ''),
                'url' => esc_url_raw($link['url'] ?? ''),
            ];
        }
    }
    return $sanitized;
}

function yiontech_lms_sanitize_footer_padding($input) {
    return [
        'top' => absint($input['top'] ?? 48),
        'bottom' => absint($input['bottom'] ?? 48),
    ];
}

// Sanitize theme settings
function yiontech_lms_sanitize_settings($input) {
    $output = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());

    $fields = [
        'enable_preloader' => 'yiontech_lms_sanitize_checkbox',
        'site_icon' => 'yiontech_lms_sanitize_url',
        'header_style' => fn($v) => in_array($v, ['default', 'minimal', 'centered']) ? $v : 'default',
        'transparent_header' => 'yiontech_lms_sanitize_checkbox',
        'sticky_header' => 'yiontech_lms_sanitize_checkbox',
        'header_background_color' => 'yiontech_lms_sanitize_color',
        'sticky_header_background_color' => 'yiontech_lms_sanitize_color',
        'enable_back_to_top' => 'yiontech_lms_sanitize_checkbox',
        'logo_upload' => 'yiontech_lms_sanitize_url',
        'retina_logo_upload' => 'yiontech_lms_sanitize_url',
        'header_buttons' => 'yiontech_lms_sanitize_header_buttons',
        'header_menu' => 'yiontech_lms_sanitize_header_menu',
        'footer_style' => fn($v) => in_array($v, ['default', 'minimal', 'centered']) ? $v : 'default',
        'footer_elementor_template' => 'absint',
        'footer_content' => 'yiontech_lms_sanitize_footer_content',
        'copyright_text' => 'yiontech_lms_sanitize_html',
        'footer_text_color' => 'yiontech_lms_sanitize_color',
        'footer_background_color' => 'yiontech_lms_sanitize_color',
        'copyright_background_color' => 'yiontech_lms_sanitize_color',
        'footer_padding' => 'yiontech_lms_sanitize_footer_padding',
        'newsletter_enable' => 'yiontech_lms_sanitize_checkbox',
        'newsletter_action_url' => 'yiontech_lms_sanitize_url',
        'newsletter_method' => fn($v) => in_array($v, ['post', 'get']) ? $v : 'post',
        'newsletter_email_field' => 'yiontech_lms_sanitize_text',
        'newsletter_hidden_fields' => 'yiontech_lms_sanitize_hidden_fields',
        'newsletter_success_message' => 'yiontech_lms_sanitize_text',
        'custom_css' => fn($v) => wp_strip_all_tags($v),
        'enable_privacy_features' => 'yiontech_lms_sanitize_checkbox',
        'privacy_policy_page' => 'absint',
        'terms_of_service_page' => 'absint',
        'cookie_consent_text' => 'yiontech_lms_sanitize_html',
        'cookie_consent_button_text' => 'yiontech_lms_sanitize_text',
        'cookie_consent_learn_more_text' => 'yiontech_lms_sanitize_text',
        'enable_data_export' => 'yiontech_lms_sanitize_checkbox',
        'enable_account_deletion' => 'yiontech_lms_sanitize_checkbox',
        'disable_gutenberg' => 'yiontech_lms_sanitize_checkbox',
    ];

    foreach ($fields as $key => $sanitize_callback) {
        if (isset($input[$key])) {
            $output[$key] = call_user_func($sanitize_callback, $input[$key]);
        }
    }

    return apply_filters('yiontech_lms_sanitized_settings', $output, $input);
}

// Register settings, sections, and fields
function yiontech_lms_theme_settings_init() {
    register_setting('yiontech_lms_theme_settings', 'yiontech_lms_theme_settings', 'yiontech_lms_sanitize_settings');

    // General section
    add_settings_section(
        'yiontech_lms_general_section',
        __('General', 'yiontech-lms'),
        'yiontech_lms_general_section_callback',
        'yiontech_lms_theme_settings'
    );

    add_settings_field(
        'enable_preloader',
        __('Enable Preloader', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_general_section',
        [
            'id' => 'enable_preloader',
            'name' => 'yiontech_lms_theme_settings[enable_preloader]',
            'description' => __('Enable preloader for the site', 'yiontech-lms'),
            'label_for' => 'enable_preloader',
        ]
    );

    add_settings_field(
        'site_icon',
        __('Site Icon (Favicon)', 'yiontech-lms'),
        'yiontech_lms_media_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_general_section',
        [
            'id' => 'site_icon',
            'name' => 'yiontech_lms_theme_settings[site_icon]',
            'description' => __('Upload site icon for browser tab (recommended 32x32px)', 'yiontech-lms'),
            'label_for' => 'site_icon',
        ]
    );

    add_settings_field(
        'enable_back_to_top',
        __('Enable Back to Top Button', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_general_section',
        [
            'id' => 'enable_back_to_top',
            'name' => 'yiontech_lms_theme_settings[enable_back_to_top]',
            'description' => __('Enable back to top button', 'yiontech-lms'),
            'label_for' => 'enable_back_to_top',
        ]
    );

    add_settings_field(
        'disable_gutenberg',
        __('Disable Gutenberg Editor', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_general_section',
        [
            'id' => 'disable_gutenberg',
            'name' => 'yiontech_lms_theme_settings[disable_gutenberg]',
            'description' => __('Disable the block editor (Gutenberg) for all posts and pages', 'yiontech-lms'),
            'label_for' => 'disable_gutenberg',
        ]
    );

    // Header section
    add_settings_section(
        'yiontech_lms_header_section',
        __('Header', 'yiontech-lms'),
        'yiontech_lms_header_section_callback',
        'yiontech_lms_theme_settings'
    );

    add_settings_field(
        'header_style',
        __('Select Header Style', 'yiontech-lms'),
        'yiontech_lms_select_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'header_style',
            'name' => 'yiontech_lms_theme_settings[header_style]',
            'options' => [
                'default' => __('Default Header', 'yiontech-lms'),
                'minimal' => __('Minimal Header', 'yiontech-lms'),
                'centered' => __('Centered Logo Header', 'yiontech-lms'),
            ],
            'description' => __('Choose header style', 'yiontech-lms'),
            'label_for' => 'header_style',
        ]
    );

    add_settings_field(
        'transparent_header',
        __('Transparent Header', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'transparent_header',
            'name' => 'yiontech_lms_theme_settings[transparent_header]',
            'description' => __('Make header transparent on homepage', 'yiontech-lms'),
            'label_for' => 'transparent_header',
        ]
    );

    add_settings_field(
        'sticky_header',
        __('Sticky Header On/Off', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'sticky_header',
            'name' => 'yiontech_lms_theme_settings[sticky_header]',
            'description' => __('Enable sticky header', 'yiontech-lms'),
            'label_for' => 'sticky_header',
        ]
    );

    add_settings_field(
        'header_background_color',
        __('Header Background Color', 'yiontech-lms'),
        'yiontech_lms_color_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'header_background_color',
            'name' => 'yiontech_lms_theme_settings[header_background_color]',
            'description' => __('Choose header background color', 'yiontech-lms'),
            'label_for' => 'header_background_color',
        ]
    );

    add_settings_field(
        'sticky_header_background_color',
        __('Sticky Header Background Color', 'yiontech-lms'),
        'yiontech_lms_color_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'sticky_header_background_color',
            'name' => 'yiontech_lms_theme_settings[sticky_header_background_color]',
            'description' => __('Choose sticky header background color', 'yiontech-lms'),
            'label_for' => 'sticky_header_background_color',
        ]
    );

    add_settings_field(
        'logo_upload',
        __('Logo Upload', 'yiontech-lms'),
        'yiontech_lms_media_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'logo_upload',
            'name' => 'yiontech_lms_theme_settings[logo_upload]',
            'description' => __('Upload your logo (recommended 200x36px)', 'yiontech-lms'),
            'label_for' => 'logo_upload',
        ]
    );

    add_settings_field(
        'retina_logo_upload',
        __('Retina Logo Upload @2x', 'yiontech-lms'),
        'yiontech_lms_media_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'retina_logo_upload',
            'name' => 'yiontech_lms_theme_settings[retina_logo_upload]',
            'description' => __('Upload retina version of your logo (2x size, recommended 400x72px)', 'yiontech-lms'),
            'label_for' => 'retina_logo_upload',
        ]
    );

    add_settings_field(
        'header_buttons',
        __('Header Buttons', 'yiontech-lms'),
        'yiontech_lms_header_buttons_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'header_buttons',
            'name' => 'yiontech_lms_theme_settings[header_buttons]',
            'description' => __('Configure header buttons', 'yiontech-lms'),
        ]
    );

    add_settings_field(
        'header_menu',
        __('Header Menu', 'yiontech-lms'),
        'yiontech_lms_menu_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_header_section',
        [
            'id' => 'header_menu',
            'name' => 'yiontech_lms_theme_settings[header_menu]',
            'description' => __('Configure header menu items', 'yiontech-lms'),
        ]
    );

    // Footer section
    add_settings_section(
        'yiontech_lms_footer_section',
        __('Footer', 'yiontech-lms'),
        'yiontech_lms_footer_section_callback',
        'yiontech_lms_theme_settings'
    );

    add_settings_field(
        'footer_style',
        __('Select Footer Style', 'yiontech-lms'),
        'yiontech_lms_select_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'footer_style',
            'name' => 'yiontech_lms_theme_settings[footer_style]',
            'options' => [
                'default' => __('Default Footer', 'yiontech-lms'),
                'minimal' => __('Minimal Footer', 'yiontech-lms'),
                'centered' => __('Centered Footer', 'yiontech-lms'),
            ],
            'description' => __('Choose footer style', 'yiontech-lms'),
            'label_for' => 'footer_style',
        ]
    );

    add_settings_field(
        'footer_elementor_template',
        __('Footer Elementor Template', 'yiontech-lms'),
        'yiontech_lms_elementor_template_select_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'footer_elementor_template',
            'name' => 'yiontech_lms_theme_settings[footer_elementor_template]',
            'description' => __('Select an Elementor template for the footer. Leave empty to use the default theme footer.', 'yiontech-lms'),
            'label_for' => 'footer_elementor_template',
        ]
    );

    add_settings_field(
        'footer_content',
        __('Footer Content', 'yiontech-lms'),
        'yiontech_lms_footer_content_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'footer_content',
            'name' => 'yiontech_lms_theme_settings[footer_content]',
            'description' => __('Configure footer columns and content', 'yiontech-lms'),
        ]
    );

    add_settings_field(
        'copyright_text',
        __('Copyright Text', 'yiontech-lms'),
        'yiontech_lms_textarea_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'copyright_text',
            'name' => 'yiontech_lms_theme_settings[copyright_text]',
            'description' => __('Enter copyright text', 'yiontech-lms'),
            'label_for' => 'copyright_text',
            'rows' => 3,
        ]
    );

    add_settings_field(
        'footer_text_color',
        __('Footer Text Color', 'yiontech-lms'),
        'yiontech_lms_color_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'footer_text_color',
            'name' => 'yiontech_lms_theme_settings[footer_text_color]',
            'description' => __('Choose footer text color', 'yiontech-lms'),
            'label_for' => 'footer_text_color',
        ]
    );

    add_settings_field(
        'footer_background_color',
        __('Footer Background Color', 'yiontech-lms'),
        'yiontech_lms_color_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'footer_background_color',
            'name' => 'yiontech_lms_theme_settings[footer_background_color]',
            'description' => __('Choose footer background color', 'yiontech-lms'),
            'label_for' => 'footer_background_color',
        ]
    );

    add_settings_field(
        'copyright_background_color',
        __('Copyright Background Color', 'yiontech-lms'),
        'yiontech_lms_color_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'copyright_background_color',
            'name' => 'yiontech_lms_theme_settings[copyright_background_color]',
            'description' => __('Choose copyright section background color', 'yiontech-lms'),
            'label_for' => 'copyright_background_color',
        ]
    );

    add_settings_field(
        'footer_padding',
        __('Padding Top/Bottom', 'yiontech-lms'),
        'yiontech_lms_spacing_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_footer_section',
        [
            'id' => 'footer_padding',
            'name' => 'yiontech_lms_theme_settings[footer_padding]',
            'description' => __('Set footer padding top and bottom (in pixels)', 'yiontech-lms'),
            'label_for' => 'footer_padding_top',
        ]
    );

    // Newsletter section
    add_settings_section(
        'yiontech_lms_newsletter_section',
        __('Newsletter', 'yiontech-lms'),
        'yiontech_lms_newsletter_section_callback',
        'yiontech_lms_theme_settings'
    );

    add_settings_field(
        'newsletter_enable',
        __('Enable Newsletter', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_newsletter_section',
        [
            'id' => 'newsletter_enable',
            'name' => 'yiontech_lms_theme_settings[newsletter_enable]',
            'description' => __('Enable newsletter subscription', 'yiontech-lms'),
            'label_for' => 'newsletter_enable',
        ]
    );

    add_settings_field(
        'newsletter_action_url',
        __('Newsletter Action URL', 'yiontech-lms'),
        'yiontech_lms_text_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_newsletter_section',
        [
            'id' => 'newsletter_action_url',
            'name' => 'yiontech_lms_theme_settings[newsletter_action_url]',
            'description' => __('Enter the form action URL (e.g., Mailchimp, ConvertKit, etc.)', 'yiontech-lms'),
            'label_for' => 'newsletter_action_url',
        ]
    );

    add_settings_field(
        'newsletter_method',
        __('Form Method', 'yiontech-lms'),
        'yiontech_lms_select_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_newsletter_section',
        [
            'id' => 'newsletter_method',
            'name' => 'yiontech_lms_theme_settings[newsletter_method]',
            'options' => [
                'post' => __('POST', 'yiontech-lms'),
                'get' => __('GET', 'yiontech-lms'),
            ],
            'description' => __('Choose form submission method', 'yiontech-lms'),
            'label_for' => 'newsletter_method',
        ]
    );

    add_settings_field(
        'newsletter_email_field',
        __('Email Field Name', 'yiontech-lms'),
        'yiontech_lms_text_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_newsletter_section',
        [
            'id' => 'newsletter_email_field',
            'name' => 'yiontech_lms_theme_settings[newsletter_email_field]',
            'description' => __('Enter the name attribute for the email field (e.g., EMAIL, email, etc.)', 'yiontech-lms'),
            'label_for' => 'newsletter_email_field',
        ]
    );

    add_settings_field(
        'newsletter_hidden_fields',
        __('Hidden Fields', 'yiontech-lms'),
        'yiontech_lms_textarea_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_newsletter_section',
        [
            'id' => 'newsletter_hidden_fields',
            'name' => 'yiontech_lms_theme_settings[newsletter_hidden_fields]',
            'description' => __('Enter hidden fields required by your newsletter service (one per line in format: name=value)', 'yiontech-lms'),
            'rows' => 5,
            'label_for' => 'newsletter_hidden_fields',
        ]
    );

    add_settings_field(
        'newsletter_success_message',
        __('Success Message', 'yiontech-lms'),
        'yiontech_lms_textarea_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_newsletter_section',
        [
            'id' => 'newsletter_success_message',
            'name' => 'yiontech_lms_theme_settings[newsletter_success_message]',
            'description' => __('Enter the message to show after successful subscription', 'yiontech-lms'),
            'rows' => 3,
            'label_for' => 'newsletter_success_message',
        ]
    );

    // Privacy section
    add_settings_section(
        'yiontech_lms_privacy_section',
        __('Privacy Settings', 'yiontech-lms'),
        'yiontech_lms_privacy_section_callback',
        'yiontech_lms_theme_settings'
    );

    add_settings_field(
        'enable_privacy_features',
        __('Enable Privacy Features', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'enable_privacy_features',
            'name' => 'yiontech_lms_theme_settings[enable_privacy_features]',
            'description' => __('Enable privacy features including cookie consent and data protection', 'yiontech-lms'),
            'label_for' => 'enable_privacy_features',
        ]
    );

    add_settings_field(
        'privacy_policy_page',
        __('Privacy Policy Page', 'yiontech-lms'),
        'yiontech_lms_page_select_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'privacy_policy_page',
            'name' => 'yiontech_lms_theme_settings[privacy_policy_page]',
            'description' => __('Select your privacy policy page', 'yiontech-lms'),
            'label_for' => 'privacy_policy_page',
        ]
    );

    add_settings_field(
        'terms_of_service_page',
        __('Terms of Service Page', 'yiontech-lms'),
        'yiontech_lms_page_select_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'terms_of_service_page',
            'name' => 'yiontech_lms_theme_settings[terms_of_service_page]',
            'description' => __('Select your terms of service page', 'yiontech-lms'),
            'label_for' => 'terms_of_service_page',
        ]
    );

    add_settings_field(
        'cookie_consent_text',
        __('Cookie Consent Text', 'yiontech-lms'),
        'yiontech_lms_textarea_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'cookie_consent_text',
            'name' => 'yiontech_lms_theme_settings[cookie_consent_text]',
            'description' => __('Enter the text to display in the cookie consent banner', 'yiontech-lms'),
            'rows' => 3,
            'label_for' => 'cookie_consent_text',
        ]
    );

    add_settings_field(
        'cookie_consent_button_text',
        __('Cookie Consent Button Text', 'yiontech-lms'),
        'yiontech_lms_text_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'cookie_consent_button_text',
            'name' => 'yiontech_lms_theme_settings[cookie_consent_button_text]',
            'description' => __('Enter the text for the cookie consent accept button', 'yiontech-lms'),
            'label_for' => 'cookie_consent_button_text',
        ]
    );

    add_settings_field(
        'cookie_consent_learn_more_text',
        __('Cookie Consent Learn More Text', 'yiontech-lms'),
        'yiontech_lms_text_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'cookie_consent_learn_more_text',
            'name' => 'yiontech_lms_theme_settings[cookie_consent_learn_more_text]',
            'description' => __('Enter the text for the cookie consent learn more link', 'yiontech-lms'),
            'label_for' => 'cookie_consent_learn_more_text',
        ]
    );

    add_settings_field(
        'enable_data_export',
        __('Enable Data Export', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'enable_data_export',
            'name' => 'yiontech_lms_theme_settings[enable_data_export]',
            'description' => __('Allow users to export their data from their profile page', 'yiontech-lms'),
            'label_for' => 'enable_data_export',
        ]
    );

    add_settings_field(
        'enable_account_deletion',
        __('Enable Account Deletion', 'yiontech-lms'),
        'yiontech_lms_checkbox_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_privacy_section',
        [
            'id' => 'enable_account_deletion',
            'name' => 'yiontech_lms_theme_settings[enable_account_deletion]',
            'description' => __('Allow users to delete their account from their profile page', 'yiontech-lms'),
            'label_for' => 'enable_account_deletion',
        ]
    );

    // CSS Editor section
    add_settings_section(
        'yiontech_lms_css_editor_section',
        __('CSS Editor', 'yiontech-lms'),
        'yiontech_lms_css_editor_section_callback',
        'yiontech_lms_theme_settings'
    );

    add_settings_field(
        'custom_css',
        __('Custom CSS', 'yiontech-lms'),
        'yiontech_lms_textarea_field',
        'yiontech_lms_theme_settings',
        'yiontech_lms_css_editor_section',
        [
            'id' => 'custom_css',
            'name' => 'yiontech_lms_theme_settings[custom_css]',
            'description' => __('Add your custom CSS here (will be minified and scoped to .yiontech-lms)', 'yiontech-lms'),
            'rows' => 20,
            'label_for' => 'custom_css',
        ]
    );
}
add_action('admin_init', 'yiontech_lms_theme_settings_init');

// Customizer integration
function yiontech_lms_customize_register($wp_customize) {
    $wp_customize->add_section('yiontech_lms_general', [
        'title' => __('Yiontech LMS General', 'yiontech-lms'),
        'priority' => 30,
    ]);

    $wp_customize->add_setting('yiontech_lms_theme_settings[header_background_color]', [
        'default' => '#1e40af',
        'sanitize_callback' => 'sanitize_hex_color',
    ]);
    $wp_customize->add_control(new WP_Customize_Color_Control($wp_customize, 'yiontech_lms_theme_settings[header_background_color]', [
        'label' => __('Header Background Color', 'yiontech-lms'),
        'section' => 'yiontech_lms_general',
    ]));

    $wp_customize->add_setting('yiontech_lms_theme_settings[footer_background_color]', [
        'default' => '#111827',
        'sanitize_callback' => 'sanitize_hex_color',
    ]);
    $wp_customize->add_control(new WP_Customize_Color_Control($wp_customize, 'yiontech_lms_theme_settings[footer_background_color]', [
        'label' => __('Footer Background Color', 'yiontech-lms'),
        'section' => 'yiontech_lms_general',
    ]));

    $wp_customize->add_setting('yiontech_lms_theme_settings[logo_upload]', [
        'default' => '',
        'sanitize_callback' => 'esc_url_raw',
    ]);
    $wp_customize->add_control(new WP_Customize_Image_Control($wp_customize, 'yiontech_lms_theme_settings[logo_upload]', [
        'label' => __('Logo Upload', 'yiontech-lms'),
        'section' => 'yiontech_lms_general',
        'settings' => 'yiontech_lms_theme_settings[logo_upload]',
        'description' => __('Upload your logo (recommended 200x36px)', 'yiontech-lms'),
    ]));
}
add_action('customize_register', 'yiontech_lms_customize_register');

// Field callbacks
function yiontech_lms_checkbox_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? false;
    ?>
    <label for="<?php echo esc_attr($args['label_for']); ?>">
        <input type="checkbox" id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" value="1" <?php checked($value, true); ?> aria-describedby="<?php echo esc_attr($args['id']); ?>-description" />
        <?php echo esc_html($args['description']); ?>
    </label>
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

function yiontech_lms_select_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? '';
    ?>
    <select id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" aria-describedby="<?php echo esc_attr($args['id']); ?>-description">
        <?php foreach ($args['options'] as $option_value => $label): ?>
            <option value="<?php echo esc_attr($option_value); ?>" <?php selected($value, $option_value); ?>><?php echo esc_html($label); ?></option>
        <?php endforeach; ?>
    </select>
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

function yiontech_lms_color_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? '#ffffff';
    ?>
    <input type="color" id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" value="<?php echo esc_attr($value); ?>" class="yiontech-color-field" aria-describedby="<?php echo esc_attr($args['id']); ?>-description" />
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

function yiontech_lms_text_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? '';
    ?>
    <input type="text" id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" value="<?php echo esc_attr($value); ?>" class="regular-text" aria-describedby="<?php echo esc_attr($args['id']); ?>-description" />
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

function yiontech_lms_textarea_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? '';
    $rows  = $args['rows'] ?? 5;

    // Fix: convert array values into a readable string
    if (is_array($value)) {
        $value = implode(", ", $value); // join array items with comma and space
    }
    ?>
    <textarea 
        id="<?php echo esc_attr($args['label_for']); ?>" 
        name="<?php echo esc_attr($args['name']); ?>" 
        rows="<?php echo esc_attr($rows); ?>" 
        class="large-text" 
        aria-describedby="<?php echo esc_attr($args['id']); ?>-description"
    ><?php echo esc_textarea($value); ?></textarea>
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description">
        <?php echo esc_html($args['description']); ?>
    </p>
    <?php
}

function yiontech_lms_media_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? '';
    $media_id = attachment_url_to_postid($value);
    ?>
    <div class="media-field" data-field-id="<?php echo esc_attr($args['id']); ?>">
        <input type="hidden" id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" value="<?php echo esc_attr($value); ?>" aria-describedby="<?php echo esc_attr($args['id']); ?>-description" />
        <div class="media-preview">
            <?php if ($value): ?>
                <img src="<?php echo esc_url($value); ?>" alt="<?php echo esc_attr($args['description']); ?>" style="max-width: 200px; max-height: 100px;" />
            <?php endif; ?>
        </div>
        <button type="button" class="button media-upload-button"><?php _e('Upload', 'yiontech-lms'); ?></button>
        <button type="button" class="button media-remove-button" style="<?php echo $value ? '' : 'display:none;'; ?>"><?php _e('Remove', 'yiontech-lms'); ?></button>
        <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    </div>
    <?php
}

function yiontech_lms_spacing_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? ['top' => 48, 'bottom' => 48];
    $top = $value['top'] ?? 48;
    $bottom = $value['bottom'] ?? 48;
    ?>
    <div class="spacing-field">
        <div>
            <label for="<?php echo esc_attr($args['label_for']); ?>"><?php _e('Top (px):', 'yiontech-lms'); ?></label>
            <input type="number" id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>[top]" value="<?php echo esc_attr($top); ?>" min="0" aria-describedby="<?php echo esc_attr($args['id']); ?>-description" />
        </div>
        <div>
            <label for="<?php echo esc_attr($args['id']); ?>_bottom"><?php _e('Bottom (px):', 'yiontech-lms'); ?></label>
            <input type="number" id="<?php echo esc_attr($args['id']); ?>_bottom" name="<?php echo esc_attr($args['name']); ?>[bottom]" value="<?php echo esc_attr($bottom); ?>" min="0" aria-describedby="<?php echo esc_attr($args['id']); ?>-description" />
        </div>
    </div>
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

function yiontech_lms_header_buttons_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $buttons = $options[$args['id']] ?? [];
    ?>
    <div class="header-buttons-field" data-field-name="<?php echo esc_attr($args['name']); ?>">
        <div class="header-buttons">
            <?php foreach ($buttons as $index => $button): ?>
                <div class="header-button-item" data-index="<?php echo esc_attr($index); ?>">
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-text'); ?>"><?php _e('Button Text:', 'yiontech-lms'); ?></label>
                        <input type="text" id="<?php echo esc_attr($args['id'] . '-' . $index . '-text'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][text]" value="<?php echo esc_attr($button['text']); ?>" class="regular-text" />
                    </div>
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-url'); ?>"><?php _e('Button URL:', 'yiontech-lms'); ?></label>
                        <input type="text" id="<?php echo esc_attr($args['id'] . '-' . $index . '-url'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][url]" value="<?php echo esc_attr($button['url']); ?>" class="regular-text" />
                    </div>
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-style'); ?>"><?php _e('Button Style:', 'yiontech-lms'); ?></label>
                        <select id="<?php echo esc_attr($args['id'] . '-' . $index . '-style'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][style]">
                            <option value="solid" <?php selected($button['style'], 'solid'); ?>><?php _e('Solid', 'yiontech-lms'); ?></option>
                            <option value="outline" <?php selected($button['style'], 'outline'); ?>><?php _e('Outline', 'yiontech-lms'); ?></option>
                        </select>
                    </div>
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-show-desktop'); ?>">
                            <input type="checkbox" id="<?php echo esc_attr($args['id'] . '-' . $index . '-show-desktop'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][show_desktop]" value="1" <?php checked($button['show_desktop'] ?? true, true); ?> />
                            <?php _e('Show on Desktop', 'yiontech-lms'); ?>
                        </label>
                    </div>
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-show-mobile'); ?>">
                            <input type="checkbox" id="<?php echo esc_attr($args['id'] . '-' . $index . '-show-mobile'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][show_mobile]" value="1" <?php checked($button['show_mobile'] ?? true, true); ?> />
                            <?php _e('Show on Mobile', 'yiontech-lms'); ?>
                        </label>
                    </div>
                    <button type="button" class="button remove-button"><?php _e('Remove Button', 'yiontech-lms'); ?></button>
                </div>
            <?php endforeach; ?>
        </div>
        <button type="button" class="button add-button"><?php _e('Add Button', 'yiontech-lms'); ?></button>
        <input type="hidden" class="item-counter" value="<?php echo esc_attr(count($buttons)); ?>" />
        <p class="description"><?php echo esc_html($args['description']); ?></p>
    </div>
    <?php
}

function yiontech_lms_menu_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $menu_items = $options[$args['id']] ?? [];
    ?>
    <div class="menu-field" data-field-name="<?php echo esc_attr($args['name']); ?>">
        <div class="menu-items">
            <?php foreach ($menu_items as $index => $item): ?>
                <div class="menu-item" data-index="<?php echo esc_attr($index); ?>">
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-text'); ?>"><?php _e('Menu Text:', 'yiontech-lms'); ?></label>
                        <input type="text" id="<?php echo esc_attr($args['id'] . '-' . $index . '-text'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][text]" value="<?php echo esc_attr($item['text']); ?>" class="regular-text" />
                    </div>
                    <div>
                        <label for="<?php echo esc_attr($args['id'] . '-' . $index . '-url'); ?>"><?php _e('Menu URL:', 'yiontech-lms'); ?></label>
                        <input type="text" id="<?php echo esc_attr($args['id'] . '-' . $index . '-url'); ?>" name="<?php echo esc_attr($args['name']); ?>[<?php echo $index; ?>][url]" value="<?php echo esc_attr($item['url']); ?>" class="regular-text" />
                    </div>
                    <button type="button" class="button remove-menu-item"><?php _e('Remove', 'yiontech-lms'); ?></button>
                </div>
            <?php endforeach; ?>
        </div>
        <button type="button" class="button add-menu-item"><?php _e('Add Menu Item', 'yiontech-lms'); ?></button>
        <input type="hidden" class="item-counter" value="<?php echo esc_attr(count($menu_items)); ?>" />
        <p class="description"><?php echo esc_html($args['description']); ?></p>
    </div>
    <?php
}

function yiontech_lms_elementor_template_select_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? 0;

    $all_templates = [];
    if (did_action('elementor/loaded')) {
        $all_templates = get_posts([
            'post_type' => 'elementor_library',
            'post_status' => 'publish',
            'posts_per_page' => -1,
        ]);
    }

    $theme_builder_templates = [];
    $regular_templates = [];
    foreach ($all_templates as $template) {
        $template_type = get_post_meta($template->ID, '_elementor_template_type', true);
        if ($template_type === 'footer') {
            $theme_builder_templates[] = $template;
        } else {
            $regular_templates[] = $template;
        }
    }
    ?>
    <select id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" aria-describedby="<?php echo esc_attr($args['id']); ?>-description">
        <option value="0"><?php _e('— Default Theme Footer —', 'yiontech-lms'); ?></option>
        <?php if (!empty($theme_builder_templates)): ?>
            <optgroup label="<?php esc_attr_e('Theme Builder Footer Templates', 'yiontech-lms'); ?>">
                <?php foreach ($theme_builder_templates as $template): ?>
                    <option value="<?php echo esc_attr($template->ID); ?>" <?php selected($value, $template->ID); ?>><?php echo esc_html($template->post_title); ?></option>
                <?php endforeach; ?>
            </optgroup>
        <?php endif; ?>
        <?php if (!empty($regular_templates)): ?>
            <optgroup label="<?php esc_attr_e('Other Elementor Templates', 'yiontech-lms'); ?>">
                <?php foreach ($regular_templates as $template): ?>
                    <option value="<?php echo esc_attr($template->ID); ?>" <?php selected($value, $template->ID); ?>><?php echo esc_html($template->post_title); ?></option>
                <?php endforeach; ?>
            </optgroup>
        <?php endif; ?>
    </select>
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php if (empty($all_templates)): ?>
        <p class="description"><?php _e('No templates found. Create templates in Elementor > Templates.', 'yiontech-lms'); ?></p>
    <?php else: ?>
        <p class="description"><?php _e('Create templates in Elementor > Templates or Elementor > Theme Builder.', 'yiontech-lms'); ?></p>
    <?php endif; ?>
    <?php
}

function yiontech_lms_footer_content_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $footer_content = $options[$args['id']] ?? yiontech_lms_get_default_settings()['footer_content'];
    ?>
    <div class="footer-content-field" data-field-name="<?php echo esc_attr($args['name']); ?>">
        <!-- Column 1 -->
        <h4><?php _e('Column 1', 'yiontech-lms'); ?></h4>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column1-title'); ?>"><?php _e('Title:', 'yiontech-lms'); ?></label>
            <input type="text" id="<?php echo esc_attr($args['id'] . '-column1-title'); ?>" name="<?php echo esc_attr($args['name']); ?>[column1][title]" value="<?php echo esc_attr($footer_content['column1']['title'] ?? ''); ?>" class="regular-text" />
        </div>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column1-content'); ?>"><?php _e('Content:', 'yiontech-lms'); ?></label>
            <textarea id="<?php echo esc_attr($args['id'] . '-column1-content'); ?>" name="<?php echo esc_attr($args['name']); ?>[column1][content]" rows="4" class="large-text"><?php echo esc_textarea($footer_content['column1']['content'] ?? ''); ?></textarea>
        </div>

        <!-- Column 2 -->
        <h4><?php _e('Column 2', 'yiontech-lms'); ?></h4>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column2-title'); ?>"><?php _e('Title:', 'yiontech-lms'); ?></label>
            <input type="text" id="<?php echo esc_attr($args['id'] . '-column2-title'); ?>" name="<?php echo esc_attr($args['name']); ?>[column2][title]" value="<?php echo esc_attr($footer_content['column2']['title'] ?? ''); ?>" class="regular-text" />
        </div>
        <div>
            <label><?php _e('Links:', 'yiontech-lms'); ?></label>
            <div class="footer-links" data-column="column2">
                <?php foreach ($footer_content['column2']['links'] ?? [] as $index => $link): ?>
                    <div class="footer-link-item" data-index="<?php echo esc_attr($index); ?>">
                        <input type="text" name="<?php echo esc_attr($args['name']); ?>[column2][links][<?php echo $index; ?>][text]" value="<?php echo esc_attr($link['text'] ?? ''); ?>" placeholder="<?php esc_attr_e('Link Text', 'yiontech-lms'); ?>" class="regular-text" />
                        <input type="text" name="<?php echo esc_attr($args['name']); ?>[column2][links][<?php echo $index; ?>][url]" value="<?php echo esc_attr($link['url'] ?? ''); ?>" placeholder="<?php esc_attr_e('Link URL', 'yiontech-lms'); ?>" class="regular-text" />
                        <button type="button" class="button remove-link"><?php _e('Remove', 'yiontech-lms'); ?></button>
                    </div>
                <?php endforeach; ?>
            </div>
            <button type="button" class="button add-link" data-column="column2"><?php _e('Add Link', 'yiontech-lms'); ?></button>
            <input type="hidden" class="item-counter" data-column="column2" value="<?php echo esc_attr(count($footer_content['column2']['links'] ?? [])); ?>" />
        </div>

        <!-- Column 3 -->
        <h4><?php _e('Column 3', 'yiontech-lms'); ?></h4>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column3-title'); ?>"><?php _e('Title:', 'yiontech-lms'); ?></label>
            <input type="text" id="<?php echo esc_attr($args['id'] . '-column3-title'); ?>" name="<?php echo esc_attr($args['name']); ?>[column3][title]" value="<?php echo esc_attr($footer_content['column3']['title'] ?? ''); ?>" class="regular-text" />
        </div>
        <div>
            <label><?php _e('Links:', 'yiontech-lms'); ?></label>
            <div class="footer-links" data-column="column3">
                <?php foreach ($footer_content['column3']['links'] ?? [] as $index => $link): ?>
                    <div class="footer-link-item" data-index="<?php echo esc_attr($index); ?>">
                        <input type="text" name="<?php echo esc_attr($args['name']); ?>[column3][links][<?php echo $index; ?>][text]" value="<?php echo esc_attr($link['text'] ?? ''); ?>" placeholder="<?php esc_attr_e('Link Text', 'yiontech-lms'); ?>" class="regular-text" />
                        <input type="text" name="<?php echo esc_attr($args['name']); ?>[column3][links][<?php echo $index; ?>][url]" value="<?php echo esc_attr($link['url'] ?? ''); ?>" placeholder="<?php esc_attr_e('Link URL', 'yiontech-lms'); ?>" class="regular-text" />
                        <button type="button" class="button remove-link"><?php _e('Remove', 'yiontech-lms'); ?></button>
                    </div>
                <?php endforeach; ?>
            </div>
            <button type="button" class="button add-link" data-column="column3"><?php _e('Add Link', 'yiontech-lms'); ?></button>
            <input type="hidden" class="item-counter" data-column="column3" value="<?php echo esc_attr(count($footer_content['column3']['links'] ?? [])); ?>" />
        </div>

        <!-- Column 4 -->
        <h4><?php _e('Column 4', 'yiontech-lms'); ?></h4>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column4-title'); ?>"><?php _e('Title:', 'yiontech-lms'); ?></label>
            <input type="text" id="<?php echo esc_attr($args['id'] . '-column4-title'); ?>" name="<?php echo esc_attr($args['name']); ?>[column4][title]" value="<?php echo esc_attr($footer_content['column4']['title'] ?? ''); ?>" class="regular-text" />
        </div>
        <div>
            <label><?php _e('Links:', 'yiontech-lms'); ?></label>
            <div class="footer-links" data-column="column4">
                <?php foreach ($footer_content['column4']['links'] ?? [] as $index => $link): ?>
                    <div class="footer-link-item" data-index="<?php echo esc_attr($index); ?>">
                        <input type="text" name="<?php echo esc_attr($args['name']); ?>[column4][links][<?php echo $index; ?>][text]" value="<?php echo esc_attr($link['text'] ?? ''); ?>" placeholder="<?php esc_attr_e('Link Text', 'yiontech-lms'); ?>" class="regular-text" />
                        <input type="text" name="<?php echo esc_attr($args['name']); ?>[column4][links][<?php echo $index; ?>][url]" value="<?php echo esc_attr($link['url'] ?? ''); ?>" placeholder="<?php esc_attr_e('Link URL', 'yiontech-lms'); ?>" class="regular-text" />
                        <button type="button" class="button remove-link"><?php _e('Remove', 'yiontech-lms'); ?></button>
                    </div>
                <?php endforeach; ?>
            </div>
            <button type="button" class="button add-link" data-column="column4"><?php _e('Add Link', 'yiontech-lms'); ?></button>
            <input type="hidden" class="item-counter" data-column="column4" value="<?php echo esc_attr(count($footer_content['column4']['links'] ?? [])); ?>" />
        </div>

        <!-- Column 5 -->
        <h4><?php _e('Column 5', 'yiontech-lms'); ?></h4>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column5-title'); ?>"><?php _e('Title:', 'yiontech-lms'); ?></label>
            <input type="text" id="<?php echo esc_attr($args['id'] . '-column5-title'); ?>" name="<?php echo esc_attr($args['name']); ?>[column5][title]" value="<?php echo esc_attr($footer_content['column5']['title'] ?? ''); ?>" class="regular-text" />
        </div>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column5-content'); ?>"><?php _e('Content:', 'yiontech-lms'); ?></label>
            <textarea id="<?php echo esc_attr($args['id'] . '-column5-content'); ?>" name="<?php echo esc_attr($args['name']); ?>[column5][content]" rows="4" class="large-text"><?php echo esc_textarea($footer_content['column5']['content'] ?? ''); ?></textarea>
        </div>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column5-email'); ?>"><?php _e('Email:', 'yiontech-lms'); ?></label>
            <input type="email" id="<?php echo esc_attr($args['id'] . '-column5-email'); ?>" name="<?php echo esc_attr($args['name']); ?>[column5][email]" value="<?php echo esc_attr($footer_content['column5']['email'] ?? ''); ?>" class="regular-text" />
        </div>
        <div>
            <label for="<?php echo esc_attr($args['id'] . '-column5-phone'); ?>"><?php _e('Phone:', 'yiontech-lms'); ?></label>
            <input type="text" id="<?php echo esc_attr($args['id'] . '-column5-phone'); ?>" name="<?php echo esc_attr($args['name']); ?>[column5][phone]" value="<?php echo esc_attr($footer_content['column5']['phone'] ?? ''); ?>" class="regular-text" />
        </div>
    </div>
    <p class="description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

function yiontech_lms_page_select_field($args) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    $value = $options[$args['id']] ?? 0;
    $pages = get_pages();
    ?>
    <select id="<?php echo esc_attr($args['label_for']); ?>" name="<?php echo esc_attr($args['name']); ?>" aria-describedby="<?php echo esc_attr($args['id']); ?>-description">
        <option value="0"><?php _e('— Select —', 'yiontech-lms'); ?></option>
        <?php foreach ($pages as $page): ?>
            <option value="<?php echo esc_attr($page->ID); ?>" <?php selected($value, $page->ID); ?>><?php echo esc_html($page->post_title); ?></option>
        <?php endforeach; ?>
    </select>
    <p class="description" id="<?php echo esc_attr($args['id']); ?>-description"><?php echo esc_html($args['description']); ?></p>
    <?php
}

// Section callbacks
function yiontech_lms_general_section_callback() {
    echo '<p>' . esc_html__('General theme settings', 'yiontech-lms') . '</p>';
}

function yiontech_lms_header_section_callback() {
    echo '<p>' . esc_html__('Configure your website header', 'yiontech-lms') . '</p>';
}

function yiontech_lms_footer_section_callback() {
    echo '<p>' . esc_html__('Configure your website footer', 'yiontech-lms') . '</p>';
}

function yiontech_lms_newsletter_section_callback() {
    echo '<p>' . esc_html__('Newsletter configuration settings', 'yiontech-lms') . '</p>';
}

function yiontech_lms_privacy_section_callback() {
    echo '<p>' . esc_html__('Configure privacy settings for GDPR compliance', 'yiontech-lms') . '</p>';
}

function yiontech_lms_css_editor_section_callback() {
    echo '<p>' . esc_html__('Add custom CSS to your theme', 'yiontech-lms') . '</p>';
}

// Add theme settings page to admin menu
function yiontech_lms_add_theme_settings_page() {
    add_menu_page(
        __('Yiontech LMS Settings', 'yiontech-lms'),
        __('Yiontech LMS', 'yiontech-lms'),
        'manage_options',
        'theme-settings-general',
        'yiontech_lms_general_settings_page',
        'dashicons-admin-settings',
        5
    );

    add_submenu_page(
        'theme-settings-general',
        __('General Settings', 'yiontech-lms'),
        __('General', 'yiontech-lms'),
        'manage_options',
        'theme-settings-general',
        'yiontech_lms_general_settings_page'
    );

    add_submenu_page(
        'theme-settings-general',
        __('Header Settings', 'yiontech-lms'),
        __('Header', 'yiontech-lms'),
        'manage_options',
        'theme-settings-header',
        'yiontech_lms_header_settings_page'
    );

    add_submenu_page(
        'theme-settings-general',
        __('Footer Settings', 'yiontech-lms'),
        __('Footer', 'yiontech-lms'),
        'manage_options',
        'theme-settings-footer',
        'yiontech_lms_footer_settings_page'
    );

    add_submenu_page(
        'theme-settings-general',
        __('Newsletter Settings', 'yiontech-lms'),
        __('Newsletter', 'yiontech-lms'),
        'manage_options',
        'theme-settings-newsletter',
        'yiontech_lms_newsletter_settings_page'
    );

    add_submenu_page(
        'theme-settings-general',
        __('Privacy Settings', 'yiontech-lms'),
        __('Privacy', 'yiontech-lms'),
        'manage_options',
        'theme-settings-privacy',
        'yiontech_lms_privacy_settings_page'
    );

    add_submenu_page(
        'theme-settings-general',
        __('CSS Editor', 'yiontech-lms'),
        __('CSS Editor', 'yiontech-lms'),
        'manage_options',
        'theme-settings-css',
        'yiontech_lms_css_settings_page'
    );
}
add_action('admin_menu', 'yiontech_lms_add_theme_settings_page');

// Helper function to output hidden fields for preserving settings
function yiontech_lms_output_hidden_fields($exclude_fields = []) {
    $options = get_option('yiontech_lms_theme_settings', yiontech_lms_get_default_settings());
    foreach ($options as $key => $value) {
        if (!in_array($key, $exclude_fields)) {
            if (is_array($value)) {
                $value = wp_json_encode($value, JSON_UNESCAPED_SLASHES);
            }
            ?>
            <input type="hidden" name="yiontech_lms_theme_settings[<?php echo esc_attr($key); ?>]" value="<?php echo esc_attr($value); ?>" />
            <?php
        }
    }
}

// General settings page
function yiontech_lms_general_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php _e('Yiontech LMS Theme Settings', 'yiontech-lms'); ?></h1>
        <div class="settings-container">
            <form method="post" action="options.php">
                <?php
                wp_nonce_field('yiontech_lms_settings_save', 'yiontech_lms_nonce');
                settings_fields('yiontech_lms_theme_settings');
                yiontech_lms_output_hidden_fields(['enable_preloader', 'site_icon', 'enable_back_to_top', 'disable_gutenberg']);
                yiontech_lms_output_settings_section('yiontech_lms_general_section');
                submit_button();
                ?>
            </form>
        </div>
    </div>
    <?php
}

// Header settings page
function yiontech_lms_header_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php _e('Header Settings', 'yiontech-lms'); ?></h1>
        <div class="settings-container">
            <form method="post" action="options.php">
                <?php
                wp_nonce_field('yiontech_lms_settings_save', 'yiontech_lms_nonce');
                settings_fields('yiontech_lms_theme_settings');
                yiontech_lms_output_hidden_fields(['header_style', 'transparent_header', 'sticky_header', 'header_background_color', 'sticky_header_background_color', 'logo_upload', 'retina_logo_upload', 'header_buttons', 'header_menu']);
                yiontech_lms_output_settings_section('yiontech_lms_header_section');
                submit_button();
                ?>
            </form>
        </div>
    </div>
    <?php
}

// Footer settings page
function yiontech_lms_footer_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php _e('Footer Settings', 'yiontech-lms'); ?></h1>
        <div class="settings-container">
            <form method="post" action="options.php">
                <?php
                wp_nonce_field('yiontech_lms_settings_save', 'yiontech_lms_nonce');
                settings_fields('yiontech_lms_theme_settings');
                yiontech_lms_output_hidden_fields(['footer_style', 'footer_elementor_template', 'footer_content', 'copyright_text', 'footer_text_color', 'footer_background_color', 'copyright_background_color', 'footer_padding']);
                yiontech_lms_output_settings_section('yiontech_lms_footer_section');
                submit_button();
                ?>
            </form>
        </div>
    </div>
    <?php
}

// Newsletter settings page
function yiontech_lms_newsletter_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php _e('Newsletter Settings', 'yiontech-lms'); ?></h1>
        <div class="settings-container">
            <form method="post" action="options.php">
                <?php
                wp_nonce_field('yiontech_lms_settings_save', 'yiontech_lms_nonce');
                settings_fields('yiontech_lms_theme_settings');
                yiontech_lms_output_hidden_fields(['newsletter_enable', 'newsletter_action_url', 'newsletter_method', 'newsletter_email_field', 'newsletter_hidden_fields', 'newsletter_success_message']);
                yiontech_lms_output_settings_section('yiontech_lms_newsletter_section');
                submit_button();
                ?>
            </form>
        </div>
    </div>
    <?php
}

// Privacy settings page
function yiontech_lms_privacy_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php _e('Privacy Settings', 'yiontech-lms'); ?></h1>
        <div class="settings-container">
            <form method="post" action="options.php">
                <?php
                wp_nonce_field('yiontech_lms_settings_save', 'yiontech_lms_nonce');
                settings_fields('yiontech_lms_theme_settings');
                yiontech_lms_output_hidden_fields(['enable_privacy_features', 'privacy_policy_page', 'terms_of_service_page', 'cookie_consent_text', 'cookie_consent_button_text', 'cookie_consent_learn_more_text', 'enable_data_export', 'enable_account_deletion']);
                yiontech_lms_output_settings_section('yiontech_lms_privacy_section');
                submit_button();
                ?>
            </form>
        </div>
    </div>
    <?php
}

// CSS settings page
function yiontech_lms_css_settings_page() {
    ?>
    <div class="wrap">
        <h1><?php _e('CSS Editor', 'yiontech-lms'); ?></h1>
        <div class="settings-container">
            <form method="post" action="options.php">
                <?php
                wp_nonce_field('yiontech_lms_settings_save', 'yiontech_lms_nonce');
                settings_fields('yiontech_lms_theme_settings');
                yiontech_lms_output_hidden_fields(['custom_css']);
                yiontech_lms_output_settings_section('yiontech_lms_css_editor_section');
                submit_button();
                ?>
            </form>
        </div>
    </div>
    <?php
}

// Helper function to output a specific settings section
function yiontech_lms_output_settings_section($section_id) {
    global $wp_settings_sections, $wp_settings_fields;

    if (!isset($wp_settings_sections['yiontech_lms_theme_settings'][$section_id])) {
        return;
    }

    $section = $wp_settings_sections['yiontech_lms_theme_settings'][$section_id];
    ?>
    <div class="settings-section">
        <h2><?php echo esc_html($section['title']); ?></h2>
        <?php
        if (!empty($section['callback']) && is_callable($section['callback'])) {
            call_user_func($section['callback'], $section);
        }

        if (isset($wp_settings_fields['yiontech_lms_theme_settings'][$section_id])) {
            ?>
            <table class="form-table" role="presentation">
                <?php
                foreach ((array) $wp_settings_fields['yiontech_lms_theme_settings'][$section_id] as $field) {
                    ?>
                    <tr>
                        <th scope="row">
                            <?php if (!empty($field['args']['label_for'])): ?>
                                <label for="<?php echo esc_attr($field['args']['label_for']); ?>"><?php echo esc_html($field['title']); ?></label>
                            <?php else: ?>
                                <?php echo esc_html($field['title']); ?>
                            <?php endif; ?>
                        </th>
                        <td>
                            <?php call_user_func($field['callback'], $field['args']); ?>
                        </td>
                    </tr>
                    <?php
                }
                ?>
            </table>
            <?php
        }
        ?>
    </div>
    <?php
}

// Enqueue admin scripts and styles
function yiontech_lms_admin_enqueue_scripts($hook) {
    if (strpos($hook, 'theme-settings') === false) {
        return;
    }

    wp_enqueue_media();
    wp_enqueue_style('wp-color-picker');
    wp_enqueue_script('wp-color-picker');

    wp_enqueue_script(
        'yiontech-lms-admin',
        get_template_directory_uri() . '/js/admin.js',
        ['jquery', 'wp-color-picker'],
        '1.0.1',
        true
    );

    wp_enqueue_style(
        'yiontech-lms-admin',
        get_template_directory_uri() . '/css/admin.css',
        ['wp-color-picker'],
        '1.0.1'
    );

    wp_localize_script('yiontech-lms-admin', 'yiontech_lms_admin', [
        'ajax_url' => admin_url('admin-ajax.php'),
        'nonce' => wp_create_nonce('yiontech_lms_admin_nonce'),
        'i18n' => [
            'upload' => __('Upload', 'yiontech-lms'),
            'remove' => __('Remove', 'yiontech-lms'),
            'add_button' => __('Add Button', 'yiontech-lms'),
            'remove_button' => __('Remove Button', 'yiontech-lms'),
            'add_menu_item' => __('Add Menu Item', 'yiontech-lms'),
            'remove_menu_item' => __('Remove', 'yiontech-lms'),
            'add_link' => __('Add Link', 'yiontech-lms'),
            'remove_link' => __('Remove', 'yiontech-lms'),
        ],
    ]);
}
add_action('admin_enqueue_scripts', 'yiontech_lms_admin_enqueue_scripts');

// Output custom CSS
function yiontech_lms_output_custom_css() {
    $custom_css = yiontech_lms_get_theme_setting('custom_css');
    if (!empty($custom_css)) {
        // Minify CSS (basic minification, consider a library like CSSMin for production)
        $custom_css = preg_replace('/\s+/', ' ', $custom_css);
        $custom_css = trim($custom_css);
        ?>
        <style id="yiontech-lms-custom-css">
            .yiontech-lms { <?php echo esc_html($custom_css); ?> }
        </style>
        <?php
    }
}
add_action('wp_head', 'yiontech_lms_output_custom_css', 100);

// Gutenberg support
function yiontech_lms_gutenberg_support() {
    if (!yiontech_lms_get_theme_setting('disable_gutenberg')) {
        add_theme_support('align-wide');
        add_theme_support('block-template-parts');
        add_theme_support('wp-block-styles');
    }
}
add_action('after_setup_theme', 'yiontech_lms_gutenberg_support');
?>-e 

===== ./inc/features/cookie-consent/cookie-consent.js =====

(function($) {
    'use strict';
    
    $(document).ready(function() {
        // Check if cookie consent banner exists
        const $cookieBanner = $('#cookie-consent-banner');
        
        if ($cookieBanner.length) {
            // Check if user has already consented
            if (document.cookie.indexOf('yiontech_lms_cookie_consent=accepted') > -1) {
                $cookieBanner.hide();
            }
            
            // Cookie consent accept button
            $('#cookie-consent-accept').on('click', function(e) {
                e.preventDefault();
                
                // Send AJAX request
                $.ajax({
                    type: 'POST',
                    url: yiontech_lms_cookie_consent.ajax_url,
                    data: {
                        action: 'yiontech_lms_cookie_consent',
                        nonce: yiontech_lms_cookie_consent.nonce
                    },
                    dataType: 'json',
                    success: function(response) {
                        if (response.success) {
                            // Hide cookie consent banner
                            $cookieBanner.fadeOut();
                            
                            // Set cookie for 1 year
                            var date = new Date();
                            date.setTime(date.getTime() + (365 * 24 * 60 * 60 * 1000));
                            var expires = "expires=" + date.toUTCString();
                            document.cookie = "yiontech_lms_cookie_consent=accepted;" + expires + ";path=/";
                        }
                    },
                    error: function() {
                        console.log('Cookie consent failed');
                        // Fallback - set cookie anyway
                        var date = new Date();
                        date.setTime(date.getTime() + (365 * 24 * 60 * 60 * 1000));
                        var expires = "expires=" + date.toUTCString();
                        document.cookie = "yiontech_lms_cookie_consent=accepted;" + expires + ";path=/";
                        $cookieBanner.fadeOut();
                    }
                });
            });
        }
    });
    
})(jQuery);-e 

===== ./inc/features/cookie-consent/cookie-consent.php =====

<?php
/**
 * Cookie Consent Feature
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Cookie consent AJAX handler
function yiontech_lms_cookie_consent_handler() {
    // Verify nonce
    if (!isset($_POST['nonce']) || !wp_verify_nonce($_POST['nonce'], 'yiontech_lms_cookie_consent_nonce')) {
        wp_send_json_error('Security check failed');
    }
    
    // Set cookie consent for 1 year
    $expiry = time() + YEAR_IN_SECONDS;
    setcookie('yiontech_lms_cookie_consent', 'accepted', $expiry, '/');
    
    wp_send_json_success('Cookie consent accepted');
}
add_action('wp_ajax_yiontech_lms_cookie_consent', 'yiontech_lms_cookie_consent_handler');
add_action('wp_ajax_nopriv_yiontech_lms_cookie_consent', 'yiontech_lms_cookie_consent_handler');

// Add cookie consent banner to footer
function yiontech_lms_cookie_consent_banner() {
    $enable_privacy_features = yiontech_lms_get_theme_setting('enable_privacy_features');
    
    if ($enable_privacy_features && !isset($_COOKIE['yiontech_lms_cookie_consent'])) {
        $privacy_policy_url = yiontech_lms_get_privacy_policy_url();
        ?>
        <div id="cookie-consent-banner" class="cookie-consent-banner">
            <div class="cookie-consent-content">
                <?php echo wp_kses_post(yiontech_lms_get_theme_setting('cookie_consent_text', 'We use cookies to ensure you get the best experience on our website. By continuing to use this site, you consent to our use of cookies.')); ?>
            </div>
            <div class="cookie-consent-buttons">
                <?php if ($privacy_policy_url) : ?>
                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="button cookie-consent-learn" target="_blank">
                        <?php echo esc_html(yiontech_lms_get_theme_setting('cookie_consent_learn_more_text', 'Learn More')); ?>
                    </a>
                <?php endif; ?>
                <button id="cookie-consent-accept" class="button cookie-consent-accept">
                    <?php echo esc_html(yiontech_lms_get_theme_setting('cookie_consent_button_text', 'Accept')); ?>
                </button>
            </div>
        </div>
        <?php
    }
}
add_action('wp_footer', 'yiontech_lms_cookie_consent_banner');

// Enqueue cookie consent script if privacy features are enabled
function yiontech_lms_enqueue_cookie_consent_script() {
    $enable_privacy_features = yiontech_lms_get_theme_setting('enable_privacy_features');
    if ($enable_privacy_features) {
        $theme_version = wp_get_theme()->get('Version');
        wp_enqueue_script('yiontech-lms-cookie-consent', get_template_directory_uri() . '/inc/features/cookie-consent/cookie-consent.js', array('jquery'), $theme_version, true);
        wp_localize_script('yiontech-lms-cookie-consent', 'yiontech_lms_cookie_consent', array(
            'ajax_url' => admin_url('admin-ajax.php'),
            'nonce' => wp_create_nonce('yiontech_lms_cookie_consent_nonce'),
        ));
    }
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_cookie_consent_script');-e 

===== ./inc/features/header-scroll/header-scroll.js =====

(function($) {
    'use strict';

    // Function to initialize header scroll functionality
    function initHeaderScroll() {
        const $header = $('.site-header');
        const $window = $(window);
        const stickyHeaderBackground = '<?php echo esc_js(yiontech_lms_get_theme_setting("sticky_header_background_color", "#1e40af")); ?>';
        const headerBackground = '<?php echo esc_js(yiontech_lms_get_theme_setting("header_background_color", "#1e40af")); ?>';
        const stickyHeader = '<?php echo esc_js(yiontech_lms_get_theme_setting("sticky_header", true)); ?>';
        const transparentHeader = '<?php echo esc_js(yiontech_lms_get_theme_setting("transparent_header", false)); ?>';

        // Only add scroll behavior if sticky header is enabled
        if (stickyHeader === '1') {
            // Set initial background without triggering transitions
            if (transparentHeader === '1' && $header.hasClass('header-transparent')) {
                $header.css({
                    'background-color': 'transparent',
                    'box-shadow': 'none'
                });
            } else {
                $header.css({
                    'background-color': headerBackground,
                    'box-shadow': 'none'
                });
            }
            
            // Force a reflow to apply the initial styles
            $header[0].offsetHeight;
            
            // Set initial state based on scroll position
            if ($window.scrollTop() > 50) {
                $header.css({
                    'background-color': stickyHeaderBackground,
                    'box-shadow': '0 4px 6px rgba(0, 0, 0, 0.1)'
                }).addClass('scrolled');
            }
            
            // Throttle scroll event for better performance
            let ticking = false;
            
            function updateHeader() {
                const scrollTop = $window.scrollTop();

                if (scrollTop > 50) {
                    $header.css({
                        'background-color': stickyHeaderBackground,
                        'box-shadow': '0 4px 6px rgba(0, 0, 0, 0.1)'
                    }).addClass('scrolled');
                } else {
                    if (transparentHeader === '1' && $header.hasClass('header-transparent')) {
                        $header.css({
                            'background-color': 'transparent',
                            'box-shadow': 'none'
                        }).removeClass('scrolled');
                    } else {
                        $header.css({
                            'background-color': headerBackground,
                            'box-shadow': 'none'
                        }).removeClass('scrolled');
                    }
                }
                
                ticking = false;
            }
            
            $window.on('scroll', function() {
                if (!ticking) {
                    window.requestAnimationFrame(function() {
                        updateHeader();
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        }
    }

    // Initialize header scroll in multiple scenarios
    
    // Scenario 1: After preloader is removed (if preloader is enabled)
    $(document).on('preloaderRemoved', function() {
        initHeaderScroll();
    });
    
    // Scenario 2: On document ready (if preloader is disabled)
    $(document).ready(function() {
        // Check if preloader exists
        var preloader = $('#preloader');
        
        // If preloader doesn't exist or is not visible, initialize header scroll immediately
        if (!preloader.length || preloader.is(':hidden')) {
            // Wait a bit to ensure all other scripts are loaded
            setTimeout(function() {
                initHeaderScroll();
            }, 100);
        }
    });
    
    // Scenario 3: Fallback - ensure header scroll is initialized even if other methods fail
    $(window).on('load', function() {
        // Check if header scroll is already initialized
        var $header = $('.site-header');
        if ($header.length && !$header.hasClass('header-scroll-initialized')) {
            setTimeout(function() {
                initHeaderScroll();
                $header.addClass('header-scroll-initialized');
            }, 500);
        }
    });

})(jQuery);-e 

===== ./inc/features/header-scroll/header-scroll.php =====

<?php
/**
 * Header Scroll Feature
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Enqueue header scroll script if enabled
function yiontech_lms_enqueue_header_scroll_script() {
    $transparent_header = yiontech_lms_get_theme_setting('transparent_header');
    $sticky_header = yiontech_lms_get_theme_setting('sticky_header');
    if ($transparent_header || $sticky_header) {
        $theme_version = wp_get_theme()->get('Version');
        wp_enqueue_script('yiontech-lms-header-scroll', get_template_directory_uri() . '/inc/features/header-scroll/header-scroll.js', array('jquery'), $theme_version, true);
    }
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_header_scroll_script');-e 

===== ./inc/features/preloader/preloader.php =====

<?php
/**
 * Preloader Feature
 *
 * @package Yiontech_LMS
 */

// Exit if accessed directly
if (!defined('ABSPATH')) {
    exit;
}

// Enqueue preloader script if enabled
function yiontech_lms_enqueue_preloader_script() {
    $enable_preloader = yiontech_lms_get_theme_setting('enable_preloader');
    if ($enable_preloader) {
        $theme_version = wp_get_theme()->get('Version');
        wp_enqueue_script('yiontech-lms-preloader', get_template_directory_uri() . '/inc/features/preloader/preloader.js', array('jquery'), $theme_version, true);
    }
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_preloader_script');

// Add preloader to header
function yiontech_lms_add_preloader() {
    $enable_preloader = yiontech_lms_get_theme_setting('enable_preloader');
    if ($enable_preloader) {
        ?>
        <div id="preloader">
            <div class="preloader-spinner">
                <div class="spinner"></div>
            </div>
        </div>
        <?php
    }
}
add_action('wp_body_open', 'yiontech_lms_add_preloader');-e 

===== ./inc/features/preloader/preloader.js =====

/* ==========================
   Preloader Script
========================== */
(function ($) {
    'use strict';

    // Function to restore scroll position
    function restoreScrollPosition() {
        const scrollPosition = sessionStorage.getItem('scrollPosition');
        if (scrollPosition) {
            window.scrollTo(0, parseInt(scrollPosition));
            sessionStorage.removeItem('scrollPosition');
        }
    }

    $(window).on('load', function () {
        if ($('#preloader').length) {
            // Remove preloader immediately when content is loaded
            $('#preloader').fadeOut('slow', function () {
                $(this).remove();
                $('body').removeClass('preloader-active');
                
                // Restore scroll position after preloader is removed
                restoreScrollPosition();
                
                // Trigger event for other scripts that depend on preloader removal
                $(document).trigger('preloaderRemoved');
            });
        } else {
            $('body').removeClass('preloader-active');
            
            // Restore scroll position if no preloader
            restoreScrollPosition();
            
            // Trigger event for consistency
            $(document).trigger('preloaderRemoved');
        }
    });

    // Fallback in case window.load never triggers
    $(document).ready(function() {
        setTimeout(function() {
            if ($('#preloader').length && $('#preloader').is(':visible')) {
                $('#preloader').fadeOut('slow', function () {
                    $(this).remove();
                    $('body').removeClass('preloader-active');
                    
                    // Restore scroll position after preloader is removed
                    restoreScrollPosition();
                    
                    // Trigger event for other scripts that depend on preloader removal
                    $(document).trigger('preloaderRemoved');
                });
            } else if (!$('#preloader').length) {
                // Restore scroll position if no preloader
                restoreScrollPosition();
                
                // Trigger event for consistency
                $(document).trigger('preloaderRemoved');
            }
        }, 1000); // Reduced timeout to 1 second
    });

})(jQuery);-e 

===== ./inc/features/login-modifier/login-modifier.php =====

<?php
/**
 * Login modifier module
 *
 * - Registers [custom_login_form] shortcode on init
 * - Handles AJAX login
 * - Auto-creates /login page and assigns login-blank-template.php
 * - Ensures template include points to this module's templates/login-blank-template.php
 */

if (!defined('ABSPATH')) exit;

/*--------------------------------------------------------------
# 2. Shortcode function (define, but register on init)
--------------------------------------------------------------*/
function yiontech_lms_custom_login_form_shortcode() {
    if (is_user_logged_in()) {
        return '<div class="flex justify-center bg-blue-50 border-l-4 border-blue-500 p-4 mb-4 rounded-lg flex"><div class="flex-shrink-0"><svg class="h-5 w-5 text-blue-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg></div><div class="ml-3"><p class="text-sm text-blue-700">You are already logged in. <a href="' . esc_url(yiontech_get_tutor_dashboard_url()) . '" class="font-medium underline hover:text-blue-800">Go to Dashboard</a></p></div></div>';
    }

    ob_start(); ?>
    <style>
      input{border: solid 2px #fcf8ff !important;}
    </style>
    <div id="tutor-login-wrap" class="custom-auth-form w-full my-10 px-4 sm:px-6">
        <div class="bg-white rounded-2xl w-full overflow-hidden shadow-xl">
            
            <!-- Two-column content -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-0 w-full">
                <!-- Left column: Marketing section -->
                <div class="bg-gradient-to-br from-purple-50 to-indigo-50 p-8 lg:p-12 flex flex-col justify-center w-full">
                    <div class="max-w-md mx-auto w-full">
                        <!-- Header with brand color -->
                        <div class="py-5 px-6 relative overflow-hidden lg:-mx-10 lg:-mt-12 mb-0">
                       
                         <h1 class="text-4xl font-bold text-gray-800 mb-4"> <?php echo esc_html(get_bloginfo('name')); ?></h1>
                       
                        </div>
                        
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">Welcome Back</h3>
                        <p class="text-gray-600 mb-6">Sign in to access your courses and continue your learning journey.</p>
                        
                        <div class="space-y-4 w-full">
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    <div class="flex items-center justify-center h-6 w-6 rounded-full bg-purple-100 text-purple-600">
                                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <h4 class="text-sm font-medium text-gray-800">Access Your Courses</h4>
                                    <p class="text-sm text-gray-600 mt-1">Continue from where you left off in your learning journey.</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    <div class="flex items-center justify-center h-6 w-6 rounded-full bg-purple-100 text-purple-600">
                                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <h4 class="text-sm font-medium text-gray-800">Track Your Progress</h4>
                                    <p class="text-sm text-gray-600 mt-1">Monitor your learning progress and achievements.</p>
                                </div>
                            </div>
                            
                            <div class="flex items-start">
                                <div class="flex-shrink-0 mt-1">
                                    <div class="flex items-center justify-center h-6 w-6 rounded-full bg-purple-100 text-purple-600">
                                        <svg class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                        </svg>
                                    </div>
                                </div>
                                <div class="ml-3">
                                    <h4 class="text-sm font-medium text-gray-800">Join Discussions</h4>
                                    <p class="text-sm text-gray-600 mt-1">Participate in course discussions and connect with peers.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-8 w-full">
                            <div class="bg-white rounded-lg shadow-sm p-4 border border-gray-200 w-full">
                                <div class="flex items-center">
                                    <div class="flex-shrink-0">
                                        <img class="h-10 w-10 rounded-full" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80" alt="Testimonial">
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm font-medium text-gray-900">Michael Chen</p>
                                        <div class="flex items-center">
                                            <div class="flex text-yellow-400">
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                                <svg class="h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <p class="mt-3 text-sm text-gray-600">"The learning platform has transformed how I approach professional development. The courses are top-notch!"</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Right column: Form -->
                <div class="p-8 w-full">
                    <form id="custom_login_form" method="post" class="space-y-6 w-full">
                        <?php wp_nonce_field('custom_login_action', 'custom_login_nonce'); ?>
                        <div class="w-full">
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="username">Username or Email</label>
                            <input type="text" name="username" id="username" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                        </div>

                        <div class="w-full">
                            <label class="block text-sm font-medium text-gray-700 mb-2" for="password">Password</label>
                            <input type="password" name="password" id="password" required class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition duration-200">
                        </div>

                        <div class="flex items-center justify-between">
                            <div class="flex items-center">
                                <input id="remember-me" name="remember" type="checkbox" class="h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded">
                                <label for="remember-me" class="ml-2 block text-sm text-gray-700">Remember me</label>
                            </div>
                            <div class="text-sm">
                                <a href="<?php echo esc_url(wp_lostpassword_url()); ?>" class="font-medium text-purple-600 hover:text-purple-500">Forgot your password?</a>
                            </div>
                        </div>

                        <div class="mt-8 w-full">
                            <button type="submit" class="w-full flex justify-center py-3 px-4 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 transition duration-200">
                                Sign in
                            </button>
                        </div>
                    </form>

                    <div id="login_result" class="mt-4 w-full"></div>
                    <p class="mt-6 text-center text-sm text-gray-600 w-full">
                        Don't have an account? 
                        <a href="<?php echo esc_url(get_permalink(get_option('yiontech_page_register_id'))); ?>" class="font-medium text-purple-600 hover:text-purple-500">
                            Register
                        </a>
                    </p>
                </div>
            </div>
        </div>
        
        <!-- Footer with Yiontech branding -->
        <div class="mt-8 text-center text-gray-500 text-sm w-full">
            <p>© <?php echo date('Y'); ?> <?php echo esc_html(get_bloginfo('name')); ?>. All rights reserved.</p>
        </div>
    </div>
    <?php
    return ob_get_clean();
}

/*--------------------------------------------------------------
# 3. Register shortcode early (init)
--------------------------------------------------------------*/
add_action('init', function() {
    // register shortcode here so it's available before templates render
    add_shortcode('custom_login_form', 'yiontech_lms_custom_login_form_shortcode');
});

/*--------------------------------------------------------------
# 4. Enqueue login scripts (ajax)
--------------------------------------------------------------*/
function yiontech_lms_enqueue_login_scripts() {
    wp_enqueue_script('jquery');

    wp_add_inline_script('jquery', "
        jQuery(document).ready(function($){
            // Login AJAX
            $('#custom_login_form').on('submit', function(e){
                e.preventDefault();
                
                // Show loading state
                var submitBtn = $(this).find('button[type=\"submit\"]');
                var originalText = submitBtn.text();
                submitBtn.prop('disabled', true).html('<svg class=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\"><circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle><path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path></svg> Signing in...');
                
                var data = $(this).serialize() + '&action=yiontech_login';
                $.post('" . admin_url('admin-ajax.php') . "', data, function(response){
                    if(response.success){
                        $('#login_result').html('<div class=\"bg-green-50 border-l-4 border-green-500 p-4 mb-4 rounded flex\"><div class=\"flex-shrink-0\"><svg class=\"h-5 w-5 text-green-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\" /></svg></div><div class=\"ml-3\"><p class=\"text-sm text-green-700\">Login successful! Redirecting...</p></div></div>');
                        setTimeout(function(){
                            window.location.href = response.data.redirect;
                        }, 1500);
                    } else {
                        $('#login_result').html('<div class=\"bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded flex\"><div class=\"flex-shrink-0\"><svg class=\"h-5 w-5 text-red-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" /></svg></div><div class=\"ml-3\"><p class=\"text-sm text-red-700\">'+response.data+'</p></div></div>');
                        submitBtn.prop('disabled', false).text(originalText);
                    }
                }, 'json');
            });
        });
    ");
}
add_action('wp_enqueue_scripts', 'yiontech_lms_enqueue_login_scripts');

/*--------------------------------------------------------------
# 5. AJAX Login Handler
--------------------------------------------------------------*/
// Nonce verification in the AJAX login handler section
function yiontech_lms_ajax_login() {
    // Verify nonce
    if (!wp_verify_nonce($_POST['custom_login_nonce'], 'custom_login_action')) {
        wp_send_json_error('Security check failed');
    }
    
    $creds = [
        'user_login'    => isset($_POST['username']) ? sanitize_text_field($_POST['username']) : '',
        'user_password' => isset($_POST['password']) ? $_POST['password'] : '',
        'remember'      => isset($_POST['remember']) ? true : false
    ];

    $user = wp_signon($creds, false);
    if (is_wp_error($user)) {
        wp_send_json_error($user->get_error_message());
    } else {
        wp_send_json_success([
            'redirect' => yiontech_get_tutor_dashboard_url()
        ]);
    }
}
add_action('wp_ajax_nopriv_yiontech_login', 'yiontech_lms_ajax_login');
add_action('wp_ajax_yiontech_login', 'yiontech_lms_ajax_login');

/*--------------------------------------------------------------
# 6. Auto-create login page & assign template (init)
#    Use init so shortcode registration and filters are available.
--------------------------------------------------------------*/
add_action('init', function () {
    $slug      = 'login';
    $title     = 'Login';
    $shortcode = '[custom_login_form]';

    $page = get_page_by_path($slug);

    if (!$page) {
        $page_id = wp_insert_post([
            'post_title'   => $title,
            'post_name'    => $slug,
            'post_content' => $shortcode,
            'post_status'  => 'publish',
            'post_type'    => 'page',
        ]);

        if ($page_id && !is_wp_error($page_id)) {
            update_option("yiontech_page_{$slug}_id", $page_id);
            update_post_meta($page_id, '_wp_page_template', 'login-blank-template.php');
        }
    } else {
        if (strpos($page->post_content, $shortcode) === false) {
            wp_update_post([
                'ID'           => $page->ID,
                'post_content' => $shortcode,
            ]);
            // Refresh $page variable if needed
            $page = get_post($page->ID);
        }
        update_option("yiontech_page_{$slug}_id", $page->ID);
        update_post_meta($page->ID, '_wp_page_template', 'login-blank-template.php');
    }
});

/*--------------------------------------------------------------
# 7. Register and load custom blank template from this module
--------------------------------------------------------------*/
add_filter('theme_page_templates', function ($templates) {
    // expose the template name in Page > Template dropdown (optional)
    $templates['login-blank-template.php'] = 'Blank (No Header/Footer)';
    return $templates;
});

add_filter('template_include', function ($template) {
    if (is_page_template('login-blank-template.php')) {
        $module_template = __DIR__ . '/templates/login-blank-template.php';
        if (file_exists($module_template)) {
            return $module_template;
        }
    }
    return $template;
});

/**
 * Always override Tutor LMS login URL
 * This prevents links with `#`
 */
add_filter('tutor_login_url', function($url) {
    // Redirect to our custom login template page
    return site_url('/login'); // you can change this slug
});

/**
 * Force Tutor LMS to load our custom blank login template
 */
add_action('template_redirect', function() {
    if ( function_exists('tutor_utils') && tutor_utils()->is_login_page() ) {
        $template_file = get_template_directory() . '/inc/features/login-modifier/templates/login-blank-template.php';
        if ( file_exists($template_file) ) {
            include $template_file;
            exit;
        }
    }
});-e 

===== ./inc/features/login-modifier/templates/login-blank-template.php =====

<?php
/**
 * Blank Template (No Header/Footer) for Login
 */
if (!defined('ABSPATH')) exit;

// Get your login page
 $login_page = get_page_by_path('login');
 $login_page_id = $login_page ? $login_page->ID : 0;

// If user is not logged in AND not already on the login page → redirect
if (!is_user_logged_in() && !is_page($login_page_id)) {
    if ($login_page) {
        // Preserve current URL
        $redirect_to = urlencode(home_url(add_query_arg(null, null)));
        wp_redirect(add_query_arg('redirect_to', $redirect_to, get_permalink($login_page)));
        exit;
    } else {
        // fallback to default WordPress login
        auth_redirect();
    }
}
?>
<!DOCTYPE html>
<html <?php language_attributes(); ?>>
<head>
    <meta charset="<?php bloginfo('charset'); ?>">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .site-content {
            max-width: 100% !important;
            width: 100% !important;
        }
        .form-wrapper {
            max-width: 100% !important;
            width: 100% !important;
            background: transparent;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #tutor-login-wrap {
            max-width: 100% !important;
            width: 100% !important;
        }
        input {
            border: solid 2px #fcf8ff !important;
        }
    </style>
    <?php wp_head(); ?>
</head>
<body <?php body_class('blank-template login-page bg-gray-50'); ?>>

<div class="site-content w-full flex items-center justify-center min-h-screen bg-gray-50">
    <div class="form-wrapper w-full">
        <?php
        if (have_posts()) :
            while (have_posts()) : the_post();
                // If you're using Tutor's [custom_login_form], make sure it respects redirect_to
                // If not, you can swap it with wp_login_form like this:
                if (has_shortcode(get_the_content(), 'custom_login_form')) {
                    the_content();
                } else {
                    wp_login_form([
                        'redirect' => isset($_GET['redirect_to']) ? esc_url_raw($_GET['redirect_to']) : home_url(),
                    ]);
                }
            endwhile;
        endif;
        ?>
    </div>
</div>

<?php wp_footer(); ?>
</body>
</html>-e 

===== ./template-parts/footer-menu-widget.php =====

<?php
/**
 * Footer menu widget template
 *
 * @package Yiontech_LMS
 */

// Args for the menu
$menu_args = array(
    'theme_location' => isset($args['menu_location']) ? $args['menu_location'] : 'footer',
    'menu_class'     => isset($args['menu_class']) ? $args['menu_class'] : 'space-y-2',
    'container'      => false,
    'fallback_cb'    => false,
    'echo'           => true,
    'walker'         => new Yiontech_LMS_Footer_Menu_Walker(),
);

// Display the menu
wp_nav_menu($menu_args);

// Custom footer menu walker class
class Yiontech_LMS_Footer_Menu_Walker extends Walker_Nav_Menu {
    function start_el(&$output, $item, $depth = 0, $args = array(), $id = 0) {
        $output .= '<li class="mb-1">';
        $attributes  = ! empty($item->attr_title) ? ' title="'  . esc_attr($item->attr_title) .'"' : '';
        $attributes .= ! empty($item->target)     ? ' target="' . esc_attr($item->target)     .'"' : '';
        $attributes .= ! empty($item->xfn)        ? ' rel="'    . esc_attr($item->xfn)        .'"' : '';
        $attributes .= ! empty($item->url)        ? ' href="'   . esc_attr($item->url)        .'"' : '';
        $attributes .= ' class="text-gray-400 hover:text-white transition"';
        
        $item_output = $args->before;
        $item_output .= '<a'. $attributes .'>';
        $item_output .= $args->link_before . apply_filters('the_title', $item->title, $item->ID) . $args->link_after;
        $item_output .= '</a>';
        $item_output .= $args->after;
        
        $output .= apply_filters('walker_nav_menu_start_el', $item_output, $item, $depth, $args);
    }
}-e 

===== ./template-parts/content-none.php =====

<div class="bg-white rounded-lg shadow-md p-8 text-center">
    <h2 class="text-2xl font-bold mb-4"><?php _e('Nothing Found', 'yiontech-lms'); ?></h2>
    <?php if (is_home() && current_user_can('publish_posts')) : ?>
        <p class="mb-4"><?php printf(__('Ready to publish your first course? <a href="%s" class="text-blue-600 hover:underline">Get started here</a>.', 'yiontech-lms'), esc_url(admin_url('post-new.php'))); ?></p>
    <?php elseif (is_search()) : ?>
        <p class="mb-4"><?php _e('Sorry, but nothing matched your search terms. Please try again with some different keywords.', 'yiontech-lms'); ?></p>
        <?php get_search_form(); ?>
    <?php else : ?>
        <p class="mb-4"><?php _e('It seems we can&rsquo;t find what you&rsquo;re looking for. Perhaps searching can help.', 'yiontech-lms'); ?></p>
        <?php get_search_form(); ?>
    <?php endif; ?>
</div>-e 

===== ./template-parts/content-course.php =====

<?php
/**
 * Template part for displaying course content in the course archive page
 *
 * @link https://developer.wordpress.org/themes/basics/template-hierarchy/
 *
 * @package Yiontech_LMS
 */
?>

<article id="post-<?php the_ID(); ?>" <?php post_class('bg-white rounded-lg shadow-md overflow-hidden transition-transform duration-300 hover:shadow-lg hover:-translate-y-1'); ?>>
    <?php if (has_post_thumbnail()) : ?>
        <div class="course-thumbnail h-48 overflow-hidden">
            <?php the_post_thumbnail('medium', array('class' => 'w-full h-full object-cover')); ?>
        </div>
    <?php endif; ?>
    
    <div class="p-6">
        <header>
            <h2 class="text-xl font-bold mb-2"><a href="<?php the_permalink(); ?>" class="text-blue-600 hover:text-blue-800"><?php the_title(); ?></a></h2>
            <div class="flex items-center text-gray-600 text-sm mb-3">
                <?php
                // Display course instructor if Tutor LMS is active
                if (function_exists('tutor_utils')) {
                    $instructor_id = get_post_field('post_author', get_the_ID());
                    ?>
                    <span>by <?php echo get_the_author_meta('display_name', $instructor_id); ?></span>
                    <span class="mx-2">•</span>
                    <?php
                }
                ?>
                <span><?php echo get_the_date(); ?></span>
            </div>
        </header>
        
        <div class="content mb-4">
            <?php the_excerpt(); ?>
        </div>
        
        <div class="flex items-center justify-between mb-4">
            <?php
            // Display course rating if Tutor LMS is active
            if (function_exists('tutor_utils')) {
                $course_rating = tutor_utils()->get_course_rating();
                if ($course_rating->rating_count > 0) {
                    ?>
                    <div class="flex items-center">
                        <div class="flex text-yellow-400">
                            <?php for ($i = 1; $i <= 5; $i++) : ?>
                                <?php if ($i <= round($course_rating->rating_avg)) : ?>
                                    <svg class="w-4 h-4 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                                    </svg>
                                <?php else : ?>
                                    <svg class="w-4 h-4 text-gray-300 fill-current" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                                    </svg>
                                <?php endif; ?>
                            <?php endfor; ?>
                        </div>
                        <span class="text-sm text-gray-600 ml-1">(<?php echo $course_rating->rating_count; ?>)</span>
                    </div>
                    <?php
                }
            }
            ?>
            
            <?php
            // Display course price if Tutor LMS is active
            if (function_exists('tutor_utils')) {
                $price = tutor_utils()->get_course_price();
                if ($price) {
                    ?>
                    <div class="text-lg font-bold text-blue-600">
                        <?php echo $price; ?>
                    </div>
                    <?php
                }
            }
            ?>
        </div>
        
        <footer>
            <a href="<?php the_permalink(); ?>" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded transition duration-300">View Course</a>
        </footer>
    </div>
</article>-e 

===== ./template-parts/content.php =====

<article id="post-<?php the_ID(); ?>" <?php post_class('bg-white rounded-lg shadow-md overflow-hidden'); ?>>
    <?php if (has_post_thumbnail()) : ?>
        <div class="post-thumbnail h-48 overflow-hidden">
            <?php the_post_thumbnail('medium', array('class' => 'w-full h-full object-cover')); ?>
        </div>
    <?php endif; ?>
    
    <div class="p-6">
        <header>
            <h2 class="text-xl font-bold mb-2"><a href="<?php the_permalink(); ?>" class="text-blue-600 hover:text-blue-800"><?php the_title(); ?></a></h2>
            <div class="text-gray-600 text-sm mb-3">
                <?php echo get_the_date(); ?> by <?php the_author(); ?>
            </div>
        </header>
        
        <div class="content mb-4">
            <?php the_excerpt(); ?>
        </div>
        
        <footer>
            <a href="<?php the_permalink(); ?>" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded">View Course</a>
        </footer>
    </div>
</article>-e 

===== ./js/main.js =====

// Combined essential scripts
(function($) {
    'use strict';

    // 1. Mobile Menu Functionality
    function initMobileMenu() {
        const menuToggle = $('#mobile-menu-toggle');
        const menuClose = $('#mobile-menu-close');
        const menuSidebar = $('#mobile-menu-sidebar');
        const menuOverlay = $('#mobile-menu-overlay');
        const body = $('body');
        
        if (!menuToggle.length) return;
        
        function openMenu() {
            menuSidebar.removeClass('translate-x-full');
            menuOverlay.removeClass('hidden');
            body.addClass('mobile-menu-open');
        }
        
        function closeMenu() {
            menuSidebar.addClass('translate-x-full');
            menuOverlay.addClass('hidden');
            body.removeClass('mobile-menu-open');
        }
        
        menuToggle.on('click', openMenu);
        menuClose.on('click', closeMenu);
        menuOverlay.on('click', closeMenu);
        
        $(document).on('keydown', function(e) {
            if (e.key === 'Escape') closeMenu();
        });
        
        $(window).on('resize', function() {
            if (window.innerWidth >= 1280) closeMenu();
        });
    }
    // Initialize all components
    $(document).ready(function() {
        initMobileMenu();
    });

})(jQuery);-e 

===== ./js/admin.js =====

(function($) {
    'use strict';

    $(document).ready(function() {
        // Initialize color picker fields
        $('.yiontech-color-field').wpColorPicker();

        // Media upload functionality
        $(document).on('click', '.media-upload-button', function(e) {
            e.preventDefault();
            
            var button = $(this);
            var fieldContainer = button.closest('.media-field');
            var fieldId = fieldContainer.data('field-id');
            var preview = fieldContainer.find('.media-preview');
            var removeButton = fieldContainer.find('.media-remove-button');
            
            // Create media uploader
            var mediaUploader = wp.media({
                title: 'Select Image',
                button: {
                    text: 'Use this image'
                },
                multiple: false
            });
            
            // When an image is selected
            mediaUploader.on('select', function() {
                var attachment = mediaUploader.state().get('selection').first().toJSON();
                
                // Update hidden field with image URL
                fieldContainer.find('input[type="hidden"]').val(attachment.url);
                
                // Update preview
                preview.html('<img src="' + attachment.url + '" alt="" style="max-width: 200px; max-height: 100px;" />');
                
                // Show remove button
                removeButton.show();
                
                // Close the media uploader
                mediaUploader.close();
            });
            
            // Open the media uploader
            mediaUploader.open();
        });

        // Remove media functionality
        $(document).on('click', '.media-remove-button', function(e) {
            e.preventDefault();
            
            var button = $(this);
            var fieldContainer = button.closest('.media-field');
            var preview = fieldContainer.find('.media-preview');
            
            // Clear hidden field
            fieldContainer.find('input[type="hidden"]').val('');
            
            // Clear preview
            preview.html('');
            
            // Hide remove button
            button.hide();
        });

        // Header buttons functionality
        $(document).on('click', '.header-buttons-field .add-button', function(e) {
            e.preventDefault();
            
            var container = $(this).closest('.header-buttons-field');
            var buttonsContainer = container.find('.header-buttons');
            var fieldName = container.data('field-name');
            var counter = container.find('.item-counter');
            var index = parseInt(counter.val());
            
            // Create new button HTML
            var newButtonHtml = '<div class="header-button-item" data-index="' + index + '">';
            newButtonHtml += '<div><label>Button Text:</label><input type="text" name="' + fieldName + '[' + index + '][text]" class="regular-text" /></div>';
            newButtonHtml += '<div><label>Button URL:</label><input type="text" name="' + fieldName + '[' + index + '][url]" class="regular-text" /></div>';
            newButtonHtml += '<div><label>Button Style:</label><select name="' + fieldName + '[' + index + '][style]"><option value="solid">Solid</option><option value="outline">Outline</option></select></div>';
            newButtonHtml += '<div><label><input type="checkbox" name="' + fieldName + '[' + index + '][show_desktop]" value="1" checked /> Show on Desktop</label></div>';
            newButtonHtml += '<div><label><input type="checkbox" name="' + fieldName + '[' + index + '][show_mobile]" value="1" checked /> Show on Mobile</label></div>';
            newButtonHtml += '<button type="button" class="button remove-button">Remove Button</button>';
            newButtonHtml += '</div>';
            
            // Append new button
            buttonsContainer.append(newButtonHtml);
            
            // Update counter
            counter.val(index + 1);
        });

        // Remove header button
        $(document).on('click', '.header-button-item .remove-button', function(e) {
            e.preventDefault();
            $(this).closest('.header-button-item').remove();
        });

        // Menu items functionality
        $(document).on('click', '.menu-field .add-menu-item', function(e) {
            e.preventDefault();
            
            var container = $(this).closest('.menu-field');
            var menuContainer = container.find('.menu-items');
            var fieldName = container.data('field-name');
            var counter = container.find('.item-counter');
            var index = parseInt(counter.val());
            
            // Create new menu item HTML
            var newMenuItemHtml = '<div class="menu-item" data-index="' + index + '">';
            newMenuItemHtml += '<div><label>Menu Text:</label><input type="text" name="' + fieldName + '[' + index + '][text]" class="regular-text" /></div>';
            newMenuItemHtml += '<div><label>Menu URL:</label><input type="text" name="' + fieldName + '[' + index + '][url]" class="regular-text" /></div>';
            newMenuItemHtml += '<button type="button" class="button remove-menu-item">Remove</button>';
            newMenuItemHtml += '</div>';
            
            // Append new menu item
            menuContainer.append(newMenuItemHtml);
            
            // Update counter
            counter.val(index + 1);
        });

        // Remove menu item
        $(document).on('click', '.menu-item .remove-menu-item', function(e) {
            e.preventDefault();
            $(this).closest('.menu-item').remove();
        });

        // Footer links functionality
        $(document).on('click', '.footer-content-field .add-link', function(e) {
            e.preventDefault();
            
            var button = $(this);
            var column = button.data('column');
            var container = button.closest('.footer-content-field');
            var linksContainer = container.find('.footer-links[data-column="' + column + '"]');
            var fieldName = container.data('field-name');
            var counter = container.find('.item-counter[data-column="' + column + '"]');
            var index = parseInt(counter.val());
            
            // Create new link HTML
            var newLinkHtml = '<div class="footer-link-item" data-index="' + index + '">';
            newLinkHtml += '<input type="text" name="' + fieldName + '[' + column + '][links][' + index + '][text]" placeholder="Link Text" class="regular-text" />';
            newLinkHtml += '<input type="text" name="' + fieldName + '[' + column + '][links][' + index + '][url]" placeholder="Link URL" class="regular-text" />';
            newLinkHtml += '<button type="button" class="button remove-link">Remove</button>';
            newLinkHtml += '</div>';
            
            // Append new link
            linksContainer.append(newLinkHtml);
            
            // Update counter
            counter.val(index + 1);
        });

        // Remove footer link
        $(document).on('click', '.footer-link-item .remove-link', function(e) {
            e.preventDefault();
            $(this).closest('.footer-link-item').remove();
        });
        
        // Handle form submission to ensure proper checkbox handling
        $('form').on('submit', function() {
            // Ensure unchecked checkboxes are included in the form data
            $(this).find('input[type="checkbox"]').each(function() {
                var checkbox = $(this);
                var name = checkbox.attr('name');
                
                // If checkbox is not checked, add a hidden field with value 0
                if (!checkbox.is(':checked')) {
                    var hiddenField = $('<input>')
                        .attr('type', 'hidden')
                        .attr('name', name)
                        .val('0');
                    
                    checkbox.after(hiddenField);
                }
            });
        });
    });

})(jQuery);-e 

===== ./archive.php =====

<?php get_header(); ?>
<div class="max-w-7xl mx-auto px-4 py-8">
    <div class="flex flex-col md:flex-row">
        <div class="w-full md:w-2/3 md:pr-8">
            <header class="mb-6">
                <h1 class="text-3xl font-bold">
                    <?php
                    if (is_category()) :
                        single_cat_title();
                    elseif (is_tag()) :
                        single_tag_title();
                    elseif (is_author()) :
                        the_post();
                        echo 'Author Archives: ' . get_the_author();
                        rewind_posts();
                    elseif (is_day()) :
                        echo 'Daily Archives: ' . get_the_date();
                    elseif (is_month()) :
                        echo 'Monthly Archives: ' . get_the_date('F Y');
                    elseif (is_year()) :
                        echo 'Yearly Archives: ' . get_the_date('Y');
                    elseif (is_search()) :
                        echo 'Search Results for: ' . get_search_query();
                    else :
                        _e('Archives', 'yiontech-lms');
                    endif;
                    ?>
                </h1>
            </header>
            
            <?php if (have_posts()) : ?>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <?php while (have_posts()) : the_post(); ?>
                        <?php get_template_part('template-parts/content', get_post_format()); ?>
                    <?php endwhile; ?>
                </div>
                
                <div class="mt-8">
                    <?php the_posts_pagination(array(
                        'mid_size' => 2,
                        'prev_text' => __('&laquo; Previous', 'yiontech-lms'),
                        'next_text' => __('Next &raquo;', 'yiontech-lms'),
                    )); ?>
                </div>
            <?php else : ?>
                <?php get_template_part('template-parts/content', 'none'); ?>
            <?php endif; ?>
        </div>
        <div class="w-full md:w-1/3 mt-8 md:mt-0">
            <?php get_sidebar(); ?>
        </div>
    </div>
</div>
<?php get_footer(); ?>-e 

===== ./readme.md =====

# Yiontech LMS Theme

A WordPress theme for Learning Management Systems with Tutor LMS integration.

## Installation
1. Upload the theme to `/wp-content/themes/`.
2. Activate via Appearance > Themes.
3. Configure settings at Yiontech LMS menu or Customizer.

## Features
- Tutor LMS overrides (dashboard, login, registration).
- Custom auth pages with privacy integration.
- GDPR compliance (cookie consent, data export/deletion).
- Elementor support for pages and footer.
- Responsive design with sticky header, back-to-top.
- Newsletter subscription with custom form.
- Custom CSS editor.
- Optional Gutenberg disable with block styling support.

## Requirements
- WordPress 6.4+
- PHP 8.2+
- Tutor LMS (optional for LMS features)
- Elementor (optional for advanced layouts)

## Documentation
- Settings: Use the Yiontech LMS admin menu for configuration.
- Privacy: Enable features in Privacy Settings for GDPR.
- Customizer: Colors and logos can be adjusted in Appearance > Customize.

## Changelog
- 1.0.0: Initial release.
- 1.1.0: Security fixes, performance optimizations, accessibility improvements.

## Support
Contact support@yiontech.com for help.

## License
GNU GPL v2 or later (see license.txt).-e 

===== ./footer.php =====

<?php
/**
 * Footer template for Yiontech LMS
 */

// Check if this is a login or register page
 $is_auth_page = is_page_template('page-login.php') || is_page_template('page-register.php');

// Don't load footer for auth pages
if ($is_auth_page) {
    wp_footer();
    echo '</body></html>';
    return;
}

// Get theme settings with defaults
 $footer_style = yiontech_lms_get_theme_setting('footer_style', 'default');
 $footer_elementor_template = yiontech_lms_get_theme_setting('footer_elementor_template', 0);
 $footer_content = yiontech_lms_get_theme_setting('footer_content', [
    'column1' => ['title' => 'About Us', 'content' => 'A powerful learning management system designed for educators and students.'],
    'column2' => ['title' => 'Quick Links', 'links' => [
        ['text' => 'Home', 'url' => '/'],
        ['text' => 'Courses', 'url' => '/courses'],
        ['text' => 'About', 'url' => '/about'],
        ['text' => 'Contact', 'url' => '/contact'],
    ]],
    'column3' => ['title' => 'Company', 'links' => [
        ['text' => 'About Us', 'url' => '/about'],
        ['text' => 'Our Team', 'url' => '/team'],
        ['text' => 'Careers', 'url' => '/careers'],
        ['text' => 'Blog', 'url' => '/blog'],
    ]],
    'column4' => ['title' => 'User Portal', 'links' => [
        ['text' => 'Login', 'url' => '/login'],
        ['text' => 'Register', 'url' => '/register'],
        ['text' => 'Dashboard', 'url' => '/dashboard'],
        ['text' => 'Profile', 'url' => '/profile'],
    ]],
    'column5' => ['title' => 'Newsletter', 'content' => 'Get the latest news and updates delivered right to your inbox.', 'email' => 'info@yiontech.com', 'phone' => '+1 (555) 123-4567'],
]);
 $copyright_text = yiontech_lms_get_theme_setting('copyright_text', '&copy; ' . date('Y') . ' ' . get_bloginfo('name') . '. All rights reserved.');
 $footer_text_color = yiontech_lms_get_theme_setting('footer_text_color', '#ffffff');
 $footer_background_color = yiontech_lms_get_theme_setting('footer_background_color', '#111827');
 $copyright_background_color = yiontech_lms_get_theme_setting('copyright_background_color', '#0f172a');
 $footer_padding = yiontech_lms_get_theme_setting('footer_padding', ['top' => 48, 'bottom' => 48]);
 $logo = yiontech_lms_get_theme_setting('logo_upload');
 $newsletter_enable = yiontech_lms_get_theme_setting('newsletter_enable');
 $enable_back_to_top = yiontech_lms_get_theme_setting('enable_back_to_top');

// Get privacy settings
 $enable_privacy_features = yiontech_lms_get_theme_setting('enable_privacy_features');
 $privacy_policy_url = yiontech_lms_get_privacy_policy_url();
 $terms_of_service_url = yiontech_lms_get_terms_of_service_url();

// Ensure footer_content is an array
if (!is_array($footer_content)) {
    $footer_content = array(
        'column1' => array(
            'title' => 'About Us',
            'content' => 'A powerful learning management system designed for educators and students.',
        ),
        'column2' => array(
            'title' => 'Quick Links',
            'links' => array(
                array('text' => 'Home', 'url' => '/'),
                array('text' => 'Courses', 'url' => '/courses'),
                array('text' => 'About', 'url' => '/about'),
                array('text' => 'Contact', 'url' => '/contact'),
            ),
        ),
        'column3' => array(
            'title' => 'Company',
            'links' => array(
                array('text' => 'About Us', 'url' => '/about'),
                array('text' => 'Our Team', 'url' => '/team'),
                array('text' => 'Careers', 'url' => '/careers'),
                array('text' => 'Blog', 'url' => '/blog'),
            ),
        ),
        'column4' => array(
            'title' => 'User Portal',
            'links' => array(
                array('text' => 'Login', 'url' => '/login'),
                array('text' => 'Register', 'url' => '/register'),
                array('text' => 'Dashboard', 'url' => '/dashboard'),
                array('text' => 'Profile', 'url' => '/profile'),
            ),
        ),
        'column5' => array(
            'title' => 'Newsletter',
            'content' => 'Get the latest news and updates delivered right to your inbox.',
            'email' => 'info@yiontech.com',
            'phone' => '+1 (555) 123-4567',
        ),
    );
}

// Ensure each column exists and has proper structure
 $columns = array('column1', 'column2', 'column3', 'column4', 'column5');
foreach ($columns as $column) {
    if (!isset($footer_content[$column])) {
        $footer_content[$column] = array();
    }
    
    // Ensure title exists for each column
    if (!isset($footer_content[$column]['title'])) {
        $footer_content[$column]['title'] = '';
    }
    
    // Ensure content exists for column1 and column5
    if (($column === 'column1' || $column === 'column5') && !isset($footer_content[$column]['content'])) {
        $footer_content[$column]['content'] = '';
    }
    
    // Ensure links exist for column2, column3, and column4
    if (in_array($column, array('column2', 'column3', 'column4'))) {
        if (!isset($footer_content[$column]['links']) || !is_array($footer_content[$column]['links'])) {
            $footer_content[$column]['links'] = array();
        }
    }
    
    // Ensure email and phone exist for column5
    if ($column === 'column5') {
        if (!isset($footer_content[$column]['email'])) {
            $footer_content[$column]['email'] = '';
        }
        if (!isset($footer_content[$column]['phone'])) {
            $footer_content[$column]['phone'] = '';
        }
    }
}

// Check if an Elementor footer template is selected
if ($footer_elementor_template > 0) {
    // Get the template post
    $template_post = get_post($footer_elementor_template);
    
    // Check if the template exists and is published
    if ($template_post && $template_post->post_status === 'publish') {
        // Try to get Elementor content using the frontend renderer
        if (class_exists('\\Elementor\\Plugin')) {
            $elementor = \Elementor\Plugin::instance();
            
            // Make sure Elementor frontend is initialized
            if (method_exists($elementor, 'frontend')) {
                $elementor->frontend->init();
            }
            
            // Get the document
            $document = $elementor->documents->get($footer_elementor_template);
            
            if ($document) {
                // Get the builder content for display
                if (method_exists($elementor->frontend, 'get_builder_content_for_display')) {
                    $content = $elementor->frontend->get_builder_content_for_display($footer_elementor_template);
                    
                    if (!empty($content)) {
                        // Display the Elementor template
                        echo '<footer class="elementor-footer-template">';
                        echo $content;
                        echo '</footer>';
                    } else {
                        // Fall back to default footer if content is empty
                        yiontech_lms_display_default_footer($footer_style, $footer_content, $copyright_text, $footer_text_color, $footer_background_color, $copyright_background_color, $footer_padding, $logo, $newsletter_enable, $enable_privacy_features, $privacy_policy_url, $terms_of_service_url);
                    }
                } else {
                    // Fallback for older Elementor versions
                    echo '<footer class="elementor-footer-template">';
                    echo apply_filters('the_content', $template_post->post_content);
                    echo '</footer>';
                }
            } else {
                // Document not found, fall back to default footer
                yiontech_lms_display_default_footer($footer_style, $footer_content, $copyright_text, $footer_text_color, $footer_background_color, $copyright_background_color, $footer_padding, $logo, $newsletter_enable, $enable_privacy_features, $privacy_policy_url, $terms_of_service_url);
            }
        } else {
            // Elementor not active, fall back to default footer
            yiontech_lms_display_default_footer($footer_style, $footer_content, $copyright_text, $footer_text_color, $footer_background_color, $copyright_background_color, $footer_padding, $logo, $newsletter_enable, $enable_privacy_features, $privacy_policy_url, $terms_of_service_url);
        }
    } else {
        // Template not found or not published, fall back to default footer
        yiontech_lms_display_default_footer($footer_style, $footer_content, $copyright_text, $footer_text_color, $footer_background_color, $copyright_background_color, $footer_padding, $logo, $newsletter_enable, $enable_privacy_features, $privacy_policy_url, $terms_of_service_url);
    }
} else {
    // No Elementor template selected, use default footer
    yiontech_lms_display_default_footer($footer_style, $footer_content, $copyright_text, $footer_text_color, $footer_background_color, $copyright_background_color, $footer_padding, $logo, $newsletter_enable, $enable_privacy_features, $privacy_policy_url, $terms_of_service_url);
}
?>

<!-- Back to top button - only show if enabled in theme settings -->
<?php if ($enable_back_to_top) : ?>
<a href="#" id="back-to-top" class="back-to-top">
    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 15l7-7 7 7"></path>
    </svg>
</a>
<?php endif; ?>

<?php wp_footer(); ?>
</body>
</html>

<?php
/**
 * Function to display the default theme footer
 */
function yiontech_lms_display_default_footer($footer_style, $footer_content, $copyright_text, $footer_text_color, $footer_background_color, $copyright_background_color, $footer_padding, $logo, $newsletter_enable, $enable_privacy_features, $privacy_policy_url, $terms_of_service_url) {
    $padding_top = isset($footer_padding['top']) ? $footer_padding['top'] : 48;
    $padding_bottom = isset($footer_padding['bottom']) ? $footer_padding['bottom'] : 48;
    
    if ($footer_style == 'default') : ?>
    <footer class="text-white" style="background-color: <?php echo esc_attr($footer_background_color); ?>; color: <?php echo esc_attr($footer_text_color); ?>; ">
        <?php 
        if ( function_exists( 'elementor_theme_do_location' ) && elementor_theme_do_location( 'footer' ) ) {
            // Elementor footer
        } else {
            // Default theme footer
            ?>
            <div class="max-w-7xl  mx-auto px-4" style="padding-top: <?php echo esc_attr($padding_top); ?>px; padding-bottom: <?php echo esc_attr($padding_bottom); ?>px;">
                <div class="grid grid-cols-1 md:grid-cols-5 gap-8">
                    <!-- Column 1: Logo and Description -->
                    <div>
                        <?php if ($logo) : ?>
                            <div class="mb-4">
                                <img src="<?php echo esc_url($logo); ?>" class="custom-logo" alt="<?php bloginfo('name'); ?>" style="max-height: 36px; width: auto;">
                            </div>
                        <?php elseif ( has_custom_logo() ) : ?>
                            <div class="mb-4">
                                <?php the_custom_logo(); ?>
                            </div>
                        <?php else : ?>
                            <h3 class="text-xl font-bold mb-4"><?php bloginfo( 'name' ); ?></h3>
                        <?php endif; ?>
                        <p class="text-gray-400 mb-4"><?php echo esc_html($footer_content['column1']['content']); ?></p>
                        <div class="flex space-x-4">
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
                                </svg>
                            </a>
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                                </svg>
                            </a>
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zM5.838 12a6.162 6.162 0 1112.324 0 6.162 6.162 0 01-12.324 0zM12 16a4 4 0 110-8 4 4 0 010 8zm4.965-10.405a1.44 1.44 0 112.881.001 1.44 1.44 0 01-2.881-.001z"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Column 2: Quick Links -->
                    <div>
                        <h3 class="text-xl font-bold mb-4"><?php echo esc_html($footer_content['column2']['title']); ?></h3>
                        <ul class="space-y-2">
                            <?php if (!empty($footer_content['column2']['links']) && is_array($footer_content['column2']['links'])) : ?>
                                <?php foreach ($footer_content['column2']['links'] as $link) : ?>
                                    <li>
                                        <a href="<?php echo esc_url($link['url']); ?>" class="text-gray-400 hover:text-white transition">
                                            <?php echo esc_html($link['text']); ?>
                                        </a>
                                    </li>
                                <?php endforeach; ?>
                            <?php endif; ?>
                            
                            <!-- Add privacy links if enabled -->
                            <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-gray-400 hover:text-white transition">
                                        Privacy Policy
                                    </a>
                                </li>
                            <?php endif; ?>
                            
                            <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-gray-400 hover:text-white transition">
                                        Terms of Service
                                    </a>
                                </li>
                            <?php endif; ?>
                        </ul>
                    </div>
                    
                    <!-- Column 3: Company -->
                    <div>
                        <h3 class="text-xl font-bold mb-4"><?php echo esc_html($footer_content['column3']['title']); ?></h3>
                        <ul class="space-y-2">
                            <?php if (!empty($footer_content['column3']['links']) && is_array($footer_content['column3']['links'])) : ?>
                                <?php foreach ($footer_content['column3']['links'] as $link) : ?>
                                    <li>
                                        <a href="<?php echo esc_url($link['url']); ?>" class="text-gray-400 hover:text-white transition">
                                            <?php echo esc_html($link['text']); ?>
                                        </a>
                                    </li>
                                <?php endforeach; ?>
                            <?php endif; ?>
                        </ul>
                    </div>
                    
                    <!-- Column 4: User Portal -->
                    <div>
                        <h3 class="text-xl font-bold mb-4"><?php echo esc_html($footer_content['column4']['title']); ?></h3>
                        <ul class="space-y-2">
                            <?php if (!empty($footer_content['column4']['links']) && is_array($footer_content['column4']['links'])) : ?>
                                <?php foreach ($footer_content['column4']['links'] as $link) : ?>
                                    <li>
                                        <a href="<?php echo esc_url($link['url']); ?>" class="text-gray-400 hover:text-white transition">
                                            <?php echo esc_html($link['text']); ?>
                                        </a>
                                    </li>
                                <?php endforeach; ?>
                            <?php endif; ?>
                        </ul>
                    </div>
                    
                    <!-- Column 5: Newsletter -->
                    <div>
                        <h3 class="text-xl font-bold mb-4"><?php echo esc_html($footer_content['column5']['title']); ?></h3>
                        <p class="text-gray-400 mb-4"><?php echo esc_html($footer_content['column5']['content']); ?></p>
                        <?php if ($newsletter_enable) : ?>
                            <?php get_template_part('template-parts/newsletter-form'); ?>
                        <?php endif; ?>
                        
                        <div class="mt-6">
                            <h4 class="text-lg font-medium mb-2">Contact Us</h4>
                            <ul class="space-y-2 text-gray-400">
                                <li class="flex items-start">
                                    <svg class="w-5 h-5 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                                    </svg>
                                    <span><?php echo esc_html($footer_content['column5']['email']); ?></span>
                                </li>
                                <li class="flex items-start">
                                    <svg class="w-5 h-5 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                                    </svg>
                                    <span><?php echo esc_html($footer_content['column5']['phone']); ?></span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <?php
        }
        ?>
        
        <!-- Copyright -->
        <div class="mt-0  text-center text-gray-400" style="background-color: <?php echo esc_attr($copyright_background_color); ?>;">
            <div class="max-w-7xl mx-auto px-4 py-4">
                <p><?php echo $copyright_text; ?></p>
                
                <!-- Add privacy links if enabled -->
                <?php if ($enable_privacy_features && ($privacy_policy_url || $terms_of_service_url)) : ?>
                    <p class="mt-2 text-sm">
                        <?php if ($privacy_policy_url) : ?>
                            <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-gray-400 hover:text-white transition">
                                Privacy Policy
                            </a>
                        <?php endif; ?>
                        
                        <?php if ($privacy_policy_url && $terms_of_service_url) : ?>
                            <span class="mx-2">|</span>
                        <?php endif; ?>
                        
                        <?php if ($terms_of_service_url) : ?>
                            <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-gray-400 hover:text-white transition">
                                Terms of Service
                            </a>
                        <?php endif; ?>
                    </p>
                <?php endif; ?>
            </div>
        </div>
    </footer>
    <?php elseif ($footer_style == 'minimal') : ?>
    <footer class="text-white" style="background-color: <?php echo esc_attr($footer_background_color); ?>; color: <?php echo esc_attr($footer_text_color); ?>; padding-top: <?php echo esc_attr($padding_top); ?>px; padding-bottom: <?php echo esc_attr($padding_bottom); ?>px;">
        <?php 
        if ( function_exists( 'elementor_theme_do_location' ) && elementor_theme_do_location( 'footer' ) ) {
            // Elementor footer
        } else {
            // Minimal theme footer
            ?>
            <div class="max-w-7xl mx-auto px-4">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <!-- Logo and Copyright -->
                    <div class="mb-4 md:mb-0">
                        <?php if ($logo) : ?>
                            <div class="mb-2">
                                <img src="<?php echo esc_url($logo); ?>" class="custom-logo" alt="<?php bloginfo('name'); ?>" style="max-height: 36px; width: auto;">
                            </div>
                        <?php elseif ( has_custom_logo() ) : ?>
                            <div class="mb-2">
                                <?php the_custom_logo(); ?>
                            </div>
                        <?php else : ?>
                            <h3 class="text-xl font-bold mb-2"><?php bloginfo( 'name' ); ?></h3>
                        <?php endif; ?>
                        <p class="text-gray-400 text-sm"><?php echo $copyright_text; ?></p>
                    </div>
                    
                    <!-- Quick Links -->
                    <div class="mb-4 md:mb-0">
                        <ul class="flex flex-wrap justify-center gap-4">
                            <?php if (!empty($footer_content['column2']['links']) && is_array($footer_content['column2']['links'])) : ?>
                                <?php foreach ($footer_content['column2']['links'] as $link) : ?>
                                    <li>
                                        <a href="<?php echo esc_url($link['url']); ?>" class="text-gray-400 hover:text-white transition">
                                            <?php echo esc_html($link['text']); ?>
                                        </a>
                                    </li>
                                <?php endforeach; ?>
                            <?php endif; ?>
                            
                            <!-- Add privacy links if enabled -->
                            <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-gray-400 hover:text-white transition">
                                        Privacy Policy
                                    </a>
                                </li>
                            <?php endif; ?>
                            
                            <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-gray-400 hover:text-white transition">
                                        Terms of Service
                                    </a>
                                </li>
                            <?php endif; ?>
                        </ul>
                    </div>
                    
                    <!-- Social Media -->
                    <div>
                        <div class="flex space-x-4">
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
                                </svg>
                            </a>
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                                </svg>
                            </a>
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zM5.838 12a6.162 6.162 0 1112.324 0 6.162 6.162 0 01-12.324 0zM12 16a4 4 0 110-8 4 4 0 010 8zm4.965-10.405a1.44 1.44 0 112.881.001 1.44 1.44 0 01-2.881-.001z"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <?php
        }
        ?>
    </footer>
    <?php elseif ($footer_style == 'centered') : ?>
    <footer class="text-white" style="background-color: <?php echo esc_attr($footer_background_color); ?>; color: <?php echo esc_attr($footer_text_color); ?>; padding-top: <?php echo esc_attr($padding_top); ?>px; padding-bottom: <?php echo esc_attr($padding_bottom); ?>px;">
        <?php 
        if ( function_exists( 'elementor_theme_do_location' ) && elementor_theme_do_location( 'footer' ) ) {
            // Elementor footer
        } else {
            // Centered theme footer
            ?>
            <div class="max-w-7xl mx-auto px-4">
                <div class="text-center">
                    <!-- Logo -->
                    <div class="mb-6">
                        <?php if ($logo) : ?>
                            <img src="<?php echo esc_url($logo); ?>" class="custom-logo mx-auto" alt="<?php bloginfo('name'); ?>" style="max-height: 36px; width: auto;">
                        <?php elseif ( has_custom_logo() ) : ?>
                            <div class="flex justify-center">
                                <?php the_custom_logo(); ?>
                            </div>
                        <?php else : ?>
                            <h3 class="text-xl font-bold mb-4"><?php bloginfo( 'name' ); ?></h3>
                        <?php endif; ?>
                    </div>
                    
                    <!-- Description -->
                    <p class="text-gray-400 max-w-2xl mx-auto mb-6"><?php echo esc_html($footer_content['column1']['content']); ?></p>
                    
                    <!-- Quick Links -->
                    <div class="mb-6">
                        <ul class="flex flex-wrap justify-center gap-6">
                            <?php if (!empty($footer_content['column2']['links']) && is_array($footer_content['column2']['links'])) : ?>
                                <?php foreach ($footer_content['column2']['links'] as $link) : ?>
                                    <li>
                                        <a href="<?php echo esc_url($link['url']); ?>" class="text-gray-400 hover:text-white transition">
                                            <?php echo esc_html($link['text']); ?>
                                        </a>
                                    </li>
                                <?php endforeach; ?>
                            <?php endif; ?>
                            
                            <!-- Add privacy links if enabled -->
                            <?php if ($enable_privacy_features && $privacy_policy_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-gray-400 hover:text-white transition">
                                        Privacy Policy
                                    </a>
                                </li>
                            <?php endif; ?>
                            
                            <?php if ($enable_privacy_features && $terms_of_service_url) : ?>
                                <li>
                                    <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-gray-400 hover:text-white transition">
                                        Terms of Service
                                    </a>
                                </li>
                            <?php endif; ?>
                        </ul>
                    </div>
                    
                    <!-- Newsletter -->
                    <?php if ($newsletter_enable) : ?>
                        <div class="mb-6 max-w-md mx-auto">
                            <?php get_template_part('template-parts/newsletter-form'); ?>
                        </div>
                    <?php endif; ?>
                    
                    <!-- Social Media -->
                    <div class="mb-6">
                        <div class="flex justify-center space-x-4">
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.771-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z"/>
                                </svg>
                            </a>
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"/>
                                </svg>
                            </a>
                            <a href="#" class="text-gray-400 hover:text-white transition">
                                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zM5.838 12a6.162 6.162 0 1112.324 0 6.162 6.162 0 01-12.324 0zM12 16a4 4 0 110-8 4 4 0 010 8zm4.965-10.405a1.44 1.44 0 112.881.001 1.44 1.44 0 01-2.881-.001z"/>
                                </svg>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Contact Info -->
                    <div class="text-gray-400 text-sm mb-6">
                        <p><?php echo esc_html($footer_content['column5']['email']); ?> | <?php echo esc_html($footer_content['column5']['phone']); ?></p>
                    </div>
                </div>
            </div>
            
            <!-- Copyright -->
            <div class="mt-0 pt-6 text-center text-gray-400 text-sm" style="background-color: <?php echo esc_attr($copyright_background_color); ?>;">
                <div class="max-w-7xl mx-auto px-4 py-4">
                    <p><?php echo $copyright_text; ?></p>
                    
                    <!-- Add privacy links if enabled -->
                    <?php if ($enable_privacy_features && ($privacy_policy_url || $terms_of_service_url)) : ?>
                        <p class="mt-2">
                            <?php if ($privacy_policy_url) : ?>
                                <a href="<?php echo esc_url($privacy_policy_url); ?>" class="text-gray-400 hover:text-white transition">
                                    Privacy Policy
                                </a>
                            <?php endif; ?>
                            
                            <?php if ($privacy_policy_url && $terms_of_service_url) : ?>
                                <span class="mx-2">|</span>
                            <?php endif; ?>
                            
                            <?php if ($terms_of_service_url) : ?>
                                <a href="<?php echo esc_url($terms_of_service_url); ?>" class="text-gray-400 hover:text-white transition">
                                    Terms of Service
                                </a>
                            <?php endif; ?>
                        </p>
                    <?php endif; ?>
                </div>
            </div>
            <?php
        }
        ?>
    </footer>
    <?php endif; ?>
    <?php
}
?>-e 

===== ./sidebar.php =====

<aside class="sidebar">
    <?php dynamic_sidebar('main-sidebar'); ?>
</aside>-e 

===== ./404.php =====

<?php get_header(); ?>
<div class="container mx-auto px-4 py-16">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-md p-8 text-center">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">404 - Page Not Found</h1>
        <p class="text-gray-600 mb-6">The page you are looking for might have been removed, had its name changed, or is temporarily unavailable.</p>
        <a href="<?php echo esc_url(home_url('/')); ?>" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded">Go to Homepage</a>
    </div>
</div>
<?php get_footer(); ?>-e 

===== ./style.css =====

/*
Theme Name: Yiontech LMS
Theme URI: https://yiontech.com/
Author: Yiontech Team
Author URI: https://yiontech.com/
Description: A Learning Management System theme by Yiontech
Version: 1.0.0
License: GNU General Public License v2 or later
License URI: http://www.gnu.org/licenses/gpl-2.0.html
Text Domain: yiontech-lms
Tags: lms, education, e-learning, blog, custom-background, custom-logo, custom-menu, featured-images, threaded-comments, translation-ready

This theme, like WordPress, is licensed under the GPL.
Use it to make something cool, have fun, and share what you've learned.
*/

/* Reset and base styles */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html, body {
    height: 100%;
    overflow-x: hidden;
    width: 100%;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    line-height: 1.6;
    color: #333;
    background-color: #fff;
    display: flex;
    flex-direction: column;
}

.site-content {
    flex: 1;
    overflow: hidden;
    width: 100%;
}

/* Custom Logo Size */
.custom-logo {
    max-height: 36px;
    width: auto;
}

/* Header Adjustments */
.site-header {
    padding: 0;
    border: none;
    box-shadow: none;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    z-index: 999;
    will-change: transform;
    transform: translateZ(0);
    -webkit-transform: translateZ(0);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

.site-branding img {
    max-height: 36px;
    width: auto;
}

/* Navigation Menu */
.main-navigation ul {
    list-style: none;
    margin: 0;
    padding: 0;
    border: none;
}

.main-navigation ul li {
    position: relative;
    border: none;
}

.main-navigation ul li a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    padding: 0.25rem 0;
    border: none;
}

.main-navigation ul li a:hover {
    color: rgba(255, 255, 255, 0.8);
    border: none;
}

/* Mobile Menu Toggle */
#mobile-menu-toggle {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: background-color 0.2s;
}

#mobile-menu-toggle:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

/* Mobile Menu Sidebar */
#mobile-menu-sidebar {
    width: 80%;
    max-width: 320px;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
    z-index: 9999;
    transform: translateX(100%);
    transition: transform 0.3s ease-in-out;
}

#mobile-menu-sidebar.translate-x-full {
    transform: translateX(100%);
    margin-right: -15px;
}

#mobile-menu-sidebar:not(.translate-x-full) {
    transform: translateX(0);
    margin-right: -15px;
}

#mobile-menu-sidebar ul {
    list-style: none;
    margin: 0;
    padding: 0;
    border: none;
}

#mobile-menu-sidebar ul li {
    margin-bottom: 0.5rem;
}

#mobile-menu-sidebar ul li a {
    color: #4B5563;
    text-decoration: none;
    font-weight: 500;
    padding: 0.5rem 0;
    display: block;
    border: none;
    transition: color 0.3s ease;
}

#mobile-menu-sidebar ul li a:hover {
    color: #2563EB;
    border: none;
}

/* Mobile Menu Sections */
#mobile-menu-sidebar .border-b {
    border-bottom: 1px solid #E5E7EB;
}

#mobile-menu-sidebar h3 {
    color: #1F2937;
    font-weight: 600;
}

/* Mobile Menu Overlay */
#mobile-menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 9998;
}

/* Course Card Adjustments */
.course-thumbnail {
    height: 180px;
    border: none;
}

/* Pagination Adjustments */
.page-numbers {
    display: inline-block;
    padding: 0.5rem 0.75rem;
    margin: 0 0.25rem;
    border-radius: 0.375rem;
    background-color: #f3f4f6;
    color: #4b5563;
    text-decoration: none;
    border: none;
}

.page-numbers.current {
    background-color: #2563eb;
    color: white;
    border: none;
}

.page-numbers:hover {
    background-color: #e5e7eb;
    border: none;
}

.page-numbers.current:hover {
    background-color: #1d4ed8;
    border: none;
}

/* Footer Adjustments */
footer {
    border: none;
    box-shadow: none;
}

footer ul {
    list-style: none;
    margin: 0;
    padding: 0;
    border: none;
}

footer ul li {
    margin-bottom: 0.5rem;
}

footer ul li a {
    color: #9CA3AF;
    text-decoration: none;
    transition: color 0.3s ease;
    border: none;
    display: inline-block;
}

footer ul li a:hover {
    color: white;
    border: none;
}

/* Newsletter Form */
.newsletter-form input[type="email"] {
    background-color: #1F2937;
    border: 1px solid #374151;
}

.newsletter-form input[type="email"]:focus {
    border-color: #3B82F6;
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.newsletter-form button {
    background-color: #2563EB;
    border: none;
}

.newsletter-form button:hover {
    background-color: #1D4ED8;
}

/* Mobile Menu Newsletter Form */
#mobile-menu-sidebar form input[type="email"] {
    border: 1px solid #D1D5DB;
}

#mobile-menu-sidebar form input[type="email"]:focus {
    border-color: #3B82F6;
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

#mobile-menu-sidebar form button {
    background-color: #2563EB;
    border: none;
}

#mobile-menu-sidebar form button:hover {
    background-color: #1D4ED8;
}

/* Preloader Styles */
#preloader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #ffffff;
    z-index: 99999 !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
}

.preloader-spinner {
    width: 80px;
    height: 80px;
    position: relative;
    display: block !important;
}

.spinner {
    width: 80px !important;
    height: 80px !important;
    border: 8px solid rgba(30, 64, 175, 0.2) !important;
    border-top: 8px solid #1e40af !important;
    border-radius: 50% !important;
    animation: spin 1s linear infinite !important;
    display: block !important;
    box-sizing: border-box !important;
    background-color: transparent !important;
}

.spinner::before {
    content: "";
    position: absolute;
    top: 5px;
    left: 5px;
    right: 5px;
    bottom: 5px;
    border-radius: 50%;
    border: 4px solid transparent;
    border-top-color: #3b82f6;
    animation: spin 2s linear infinite;
}

.spinner::after {
    content: "";
    position: absolute;
    top: 15px;
    left: 15px;
    right: 15px;
    bottom: 15px;
    border-radius: 50%;
    border: 2px solid transparent;
    border-top-color: #60a5fa;
    animation: spin 3s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Back to top button */
.back-to-top {
    position: fixed !important;
    bottom: 30px !important;
    right: 30px !important;
    background-color: #1e40af !important;
    color: white !important;
    width: 50px !important;
    height: 50px !important;
    border-radius: 50% !important;
    display: flex !important;
    justify-content: center !important;
    align-items: center !important;
    z-index: 99999 !important;
    opacity: 0 !important;
    visibility: hidden !important;
    transition: opacity 0.3s, visibility 0.3s, transform 0.3s !important;
    transform: translateY(20px) !important;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3) !important;
    cursor: pointer !important;
    text-decoration: none !important;
    pointer-events: none !important;
}

.back-to-top.visible {
    opacity: 1 !important;
    visibility: visible !important;
    transform: translateY(0) !important;
    pointer-events: auto !important;
}

.back-to-top:hover {
    background-color: #1e3a8a !important;
    transform: translateY(-5px) !important;
    text-decoration: none !important;
    color: white !important;
}

.back-to-top svg {
    width: 24px !important;
    height: 24px !important;
    pointer-events: none !important;
}

/* Sticky header styles */
.site-header.sticky {
    position: sticky;
    top: 0;
    z-index: 999;
    width: 100%;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

/* Ensure body can scroll if needed */
html, body {
    height: auto;
    min-height: 100vh;
    overflow-x: hidden;
}
mark{
    background: transparent !important;
    color: initial !important;
}

/* Cookie consent banner */
.cookie-consent-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #1e293b;
    color: white;
    padding: 15px;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
    flex-direction: row;
}

.cookie-consent-content {
    flex: 1;
    margin-right: 15px;
}

.cookie-consent-buttons {
    display: flex;
    gap: 10px;
}

.cookie-consent-buttons .button {
    padding: 8px 16px;
    border-radius: 4px;
    font-weight: 500;
    cursor: pointer;
    border: none;
}

.cookie-consent-accept {
    background: #3b82f6;
    color: white;
}

.cookie-consent-accept:hover {
    background: #2563eb;
}

.cookie-consent-learn {
    background: transparent;
    color: white;
    border: 1px solid white;
}

.cookie-consent-learn:hover {
    background: rgba(255,255,255,0.1);
}-e 

===== ./functions.php =====

<?php
/**
 * Yiontech LMS Theme Functions
 *
 * @package Yiontech_LMS
 */

// Include core functionality
require_once get_template_directory() . '/inc/core/theme-setup.php';
require_once get_template_directory() . '/inc/core/assets-loader.php';
require_once get_template_directory() . '/inc/core/template-functions.php';

// Include feature loader
require_once get_template_directory() . '/inc/features-loader.php';

// Theme Support
function yiontech_lms_setup_theme() {
    // Core WordPress features
    add_theme_support('post-thumbnails');
    add_theme_support('custom-logo', [
        'height' => 36,
        'width' => 200,
        'flex-height' => true,
        'flex-width' => true,
    ]);
    add_theme_support('title-tag');
    add_theme_support('html5', ['search-form', 'comment-form', 'comment-list', 'gallery', 'caption']);
    add_theme_support('custom-background', ['default-color' => '#ffffff']);
    add_theme_support('custom-header', ['default-image' => '', 'width' => 1200, 'height' => 300, 'flex-height' => true]);
    add_theme_support('editor-styles');
    add_theme_support('woocommerce');
    add_theme_support('automatic-feed-links');

    // Custom image sizes for performance
    add_image_size('yiontech_course_thumbnail', 600, 400, true);
    add_image_size('yiontech_post_thumbnail', 800, 600, true);

    // Load editor styles
    add_editor_style('css/editor-style.css');
}
add_action('after_setup_theme', 'yiontech_lms_setup_theme');

// Theme activation hook
function yiontech_lms_activate() {
    // Set default options if they don't exist
    if (!get_option('yiontech_lms_theme_settings')) {
        $defaults = yiontech_lms_get_default_settings();
        add_option('yiontech_lms_theme_settings', wp_kses_post_deep($defaults));
    }

    // Create front page only if it doesn't exist
    if (!get_page_by_path('front-page', OBJECT, 'page')) {
        $front_page_id = wp_insert_post([
            'post_title' => __('Front Page', 'yiontech-lms'),
            'post_content' => '',
            'post_status' => 'publish',
            'post_author' => 1,
            'post_type' => 'page',
            'post_name' => 'front-page',
        ]);
        update_option('page_on_front', $front_page_id);
        update_option('show_on_front', 'page');
    }

    // Flush rewrite rules
    flush_rewrite_rules();
}
register_activation_hook(__FILE__, 'yiontech_lms_activate');


// Add dynamic styles to head
function yiontech_lms_dynamic_styles() {
    $header_background_color = yiontech_lms_get_theme_setting('header_background_color', '#1e40af');
    $sticky_header_background_color = yiontech_lms_get_theme_setting('sticky_header_background_color', '#1e40af');
    $transparent_header = yiontech_lms_get_theme_setting('transparent_header', false);
    $footer_background_color = yiontech_lms_get_theme_setting('footer_background_color', '#111827');
    $footer_text_color = yiontech_lms_get_theme_setting('footer_text_color', '#ffffff');
    $copyright_background_color = yiontech_lms_get_theme_setting('copyright_background_color', '#0f172a');

    $css = "
        .site-header:not(.header-transparent) {
            background-color: {$header_background_color};
        }
        .site-header.sticky {
            background-color: {$sticky_header_background_color};
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        footer {
            background-color: {$footer_background_color};
            color: {$footer_text_color};
        }
        .copyright-section {
            background-color: {$copyright_background_color};
        }
        /* Gutenberg block styles (when not disabled) */
        .wp-block-quote { border-left: 4px solid {$header_background_color}; padding-left: 1rem; }
        .wp-block-button__link { background-color: {$header_background_color}; color: {$footer_text_color}; }
    ";

    wp_add_inline_style('yiontech-lms-style', $css);
}
add_action('wp_enqueue_scripts', 'yiontech_lms_dynamic_styles');

// Fix WooCommerce translation loading
function yiontech_lms_woocommerce_translation() {
    if (defined('WC_PLUGIN_FILE') && function_exists('load_plugin_textdomain')) {
        load_plugin_textdomain('woocommerce', false, dirname(plugin_basename(WC_PLUGIN_FILE)) . '/i18n/languages/');
    }
}
add_action('init', 'yiontech_lms_woocommerce_translation', 5);

// Optional Gutenberg Disable
function yiontech_lms_maybe_disable_gutenberg() {
    if (yiontech_lms_get_theme_setting('disable_gutenberg', false)) {
        add_filter('use_block_editor_for_post', '__return_false', 10);
        add_filter('use_block_editor_for_post_type', '__return_false', 10);
        add_action('wp_enqueue_scripts', 'yiontech_lms_disable_gutenberg_frontend_styles', 100);
        add_action('admin_enqueue_scripts', 'yiontech_lms_disable_gutenberg_admin_styles', 100);
        add_action('admin_enqueue_scripts', 'yiontech_lms_disable_gutenberg_admin_scripts', 100);
    }
}
add_action('init', 'yiontech_lms_maybe_disable_gutenberg');

// Remove Gutenberg CSS from frontend
function yiontech_lms_disable_gutenberg_frontend_styles() {
    wp_dequeue_style('wp-block-library');
    wp_dequeue_style('wp-block-library-theme');
    wp_dequeue_style('wc-block-style');
}

// Remove Gutenberg editor styles from admin
function yiontech_lms_disable_gutenberg_admin_styles() {
    wp_dequeue_style('wp-block-library');
    wp_dequeue_style('wp-edit-blocks');
}

// Remove Gutenberg scripts for a cleaner admin
function yiontech_lms_disable_gutenberg_admin_scripts() {
    wp_dequeue_script('wp-blocks');
    wp_dequeue_script('wp-edit-post');
}

// Child theme support
function yiontech_lms_child_theme_styles() {
    if (is_child_theme()) {
        wp_enqueue_style('yiontech-lms-parent-style', get_template_directory_uri() . '/style.min.css', [], '1.1.0');
    }
}
add_action('wp_enqueue_scripts', 'yiontech_lms_child_theme_styles', 5);

// Generate .pot file on theme update
function yiontech_lms_generate_pot_file() {
    if (current_user_can('manage_options')) {
        // Suggest running `wp i18n make-pot . languages/yiontech-lms.pot` via CLI
        // Or automate with a plugin like WP-CLI
    }
}
add_action('after_switch_theme', 'yiontech_lms_generate_pot_file');

-e 

===== ./page.php =====

<?php get_header(); ?>
<div class="site-content w-full overflow-hidden">
    <?php 
    while (have_posts()) : the_post(); 
        if (function_exists('\\Elementor\\Plugin') 
            && \Elementor\Plugin::$instance->documents->get(get_the_ID())->is_built_with_elementor()) {
            
            // Elementor-built page → render directly
            the_content();

        } else {
            ?>
            
            <?php if (has_post_thumbnail()) : ?>
                <!-- Full width hero background -->
                <section class="relative w-full overflow-hidden">
                    <?php the_post_thumbnail('full', [
                        'class' => 'w-full h-[500px] object-cover'
                    ]); ?>

                    <!-- Content container inside hero -->
                    <div class="absolute inset-0 flex items-center justify-center">
                        <div class="max-w-7xl mx-auto px-4 text-center">
                            <h1 class="text-4xl md:text-5xl font-bold text-white drop-shadow-lg">
                                <?php the_title(); ?>
                            </h1>
                        </div>
                    </div>
                </section>
            <?php endif; ?>
            
            <!-- Page content -->
            <div class="max-w-7xl mx-auto px-4 py-12 overflow-hidden">
                <article id="post-<?php the_ID(); ?>" <?php post_class('bg-white shadow-md rounded-lg overflow-hidden'); ?>>
                    
                    <div class="content p-6 prose max-w-none overflow-hidden">
                        <?php the_content(); ?>
                    </div>
                </article>
            </div>
            
            <?php
        }
    endwhile; 
    ?>
</div>
<?php get_footer(); ?>-e 

===== ./css/editor-style.css =====


        /* Improved admin styles for theme settings */
        .wrap h1 {
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .form-table {
            background: #fff;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .form-table th {
            padding: 20px;
            background: #f9f9f9;
            border-bottom: 1px solid #eee;
            font-weight: 600;
        }
        
        .form-table td {
            padding: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .form-table tr:last-child td {
            border-bottom: none;
        }
        
        input[type="text"], 
        input[type="email"], 
        input[type="url"], 
        input[type="password"], 
        input[type="number"], 
        textarea, 
        select {
            width: 100%;
            max-width: 400px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: inset 0 1px 2px rgba(0,0,0,0.07);
        }
        
        input[type="color"] {
            height: 40px;
            width: 80px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
        }
        
        input[type="checkbox"] {
            margin-right: 10px;
        }
        
        .description {
            color: #666;
            font-style: italic;
            margin-top: 5px;
        }
        
        .button {
            padding: 8px 16px;
            border-radius: 4px;
            font-weight: 500;
            text-decoration: none;
        }
        
        .button-primary {
            background: #0085ba;
            color: #fff;
            border: 1px solid #0085ba;
        }
        
        .button-primary:hover {
            background: #0073a8;
            border-color: #0073a8;
        }
        
        .button-secondary {
            background: #f7f7f7;
            color: #555;
            border: 1px solid #ccc;
        }
        
        .button-secondary:hover {
            background: #f0f0f0;
            border-color: #999;
        }
        
        /* Media field styles */
        .media-field {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .media-preview {
            width: 200px;
            height: 100px;
            border: 1px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .media-preview img {
            max-width: 100%;
            max-height: 100%;
        }
        
        /* Header buttons field styles */
        .header-buttons-field, .menu-field {
            margin-top: 10px;
        }
        
        .header-buttons, .menu-items {
            margin-bottom: 10px;
            max-height: 300px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid #ddd;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .header-button-item, .menu-item {
            margin-bottom: 15px;
            padding: 15px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 4px;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        
        .header-button-item:last-child, .menu-item:last-child {
            margin-bottom: 0;
        }
        
        .header-button-item div, .menu-item div {
            margin-bottom: 10px;
        }
        
        .header-button-item div:last-child, .menu-item div:last-child {
            margin-bottom: 0;
        }
        
        .header-button-item label, .menu-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        .remove-button, .remove-menu-item, .remove-link {
            background: #ff4d4d;
            color: #fff;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
        }
        
        .remove-button:hover, .remove-menu-item:hover, .remove-link:hover {
            background: #ff1a1a;
        }
        
        .add-button, .add-menu-item, .add-link {
            background: #5cb85c;
            color: #fff;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .add-button:hover, .add-menu-item:hover, .add-link:hover {
            background: #4cae4c;
        }
        
        /* Footer content field styles */
        .footer-content-field h4 {
            margin: 20px 0 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            font-size: 16px;
            color: #23282d;
        }
        
        .footer-links {
            margin-bottom: 10px;
            max-height: 200px;
            overflow-y: auto;
            padding: 15px;
            border: 1px solid #ddd;
            background: #f9f9f9;
            border-radius: 4px;
        }
        
        .footer-link-item {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            padding: 10px;
            border: 1px solid #ddd;
            background: #fff;
            border-radius: 4px;
        }
        
        .footer-link-item:last-child {
            margin-bottom: 0;
        }
        
        .footer-link-item input {
            flex: 1;
        }
        
        /* Spacing field styles */
        .spacing-field {
            display: flex;
            gap: 20px;
        }
        
        .spacing-field > div {
            flex: 1;
        }
        
        .spacing-field label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }
        
        /* Item Counter (hidden field for tracking dynamic items) */
        .item-counter {
            display: none;
        }
-e 

===== ./css/admin.css =====

/* Theme Settings Page Styles */
.settings-container {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    padding: 20px;
    margin-top: 20px;
}

.settings-section {
    margin-bottom: 30px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
}

.settings-section:last-child {
    margin-bottom: 0;
    padding-bottom: 0;
    border-bottom: none;
}

.settings-section h2 {
    margin: 0 0 15px 0;
    padding: 0;
    font-size: 1.5em;
    color: #23282d;
}

.settings-section p {
    margin: 0 0 15px 0;
    color: #666;
    font-style: italic;
}

/* Form Table Styles */
.form-table {
    border-collapse: collapse;
    margin: 0;
    padding: 0;
    width: 100%;
}

.form-table th {
    vertical-align: top;
    text-align: left;
    padding: 20px 10px 20px 0;
    width: 200px;
    background: #f9f9f9;
    border-bottom: 1px solid #eee;
    font-weight: 600;
}

.form-table td {
    vertical-align: top;
    padding: 20px 10px;
    border-bottom: 1px solid #eee;
}

.form-table tr:last-child th,
.form-table tr:last-child td {
    border-bottom: none;
}

/* Form Field Styles */
input[type="text"],
input[type="email"],
input[type="url"],
input[type="number"],
textarea,
select {
    width: 100%;
    max-width: 400px;
    padding: 8px 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    background-color: #fff;
    box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.07);
    transition: border-color 0.15s ease-in-out;
}

input[type="text"]:focus,
input[type="email"]:focus,
input[type="url"]:focus,
input[type="number"]:focus,
textarea:focus,
select:focus {
    border-color: #00a0d2;
    outline: none;
    box-shadow: 0 0 0 1px #00a0d2;
}

input[type="color"] {
    height: 35px;
    width: 80px;
    border: 1px solid #ddd;
    border-radius: 4px;
    cursor: pointer;
    vertical-align: middle;
}

input[type="checkbox"] {
    margin-right: 8px;
}

.description {
    color: #666;
    font-style: italic;
    margin-top: 5px;
    font-size: 13px;
}

/* Button Styles */
.button {
    display: inline-block;
    text-decoration: none;
    font-size: 13px;
    line-height: 26px;
    height: 28px;
    margin: 0;
    padding: 0 10px 1px;
    cursor: pointer;
    border-width: 1px;
    border-style: solid;
    -webkit-appearance: none;
    border-radius: 3px;
    white-space: nowrap;
    box-sizing: border-box;
    background: #f7f7f7;
    color: #555;
    border-color: #ccc;
    box-shadow: 0 1px 0 #ccc;
    vertical-align: top;
}

.button:hover,
.button:focus {
    background: #fafafa;
    border-color: #999;
    color: #23282d;
}

.button-primary {
    background: #0085ba;
    border-color: #0073a8;
    color: #fff;
    box-shadow: 0 1px 0 #0073a8;
    text-shadow: 0 -1px 1px #006799, 1px 0 1px #006799, 0 1px 1px #006799, -1px 0 1px #006799;
}

.button-primary:hover,
.button-primary:focus {
    background: #0073a8;
    border-color: #006799;
    color: #fff;
}

.button.remove-button,
.button.remove-menu-item,
.button.remove-link {
    background: #ff4d4d;
    border-color: #ff1a1a;
    color: #fff;
    box-shadow: 0 1px 0 #ff1a1a;
}

.button.remove-button:hover,
.button.remove-menu-item:hover,
.button.remove-link:hover {
    background: #ff1a1a;
    border-color: #e60000;
    color: #fff;
}

.button.add-button,
.button.add-menu-item,
.button.add-link {
    background: #5cb85c;
    border-color: #4cae4c;
    color: #fff;
    box-shadow: 0 1px 0 #4cae4c;
}

.button.add-button:hover,
.button.add-menu-item:hover,
.button.add-link:hover {
    background: #4cae4c;
    border-color: #3d8b3d;
    color: #fff;
}

/* Media Field Styles */
.media-field {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
}

.media-preview {
    width: 200px;
    height: 100px;
    border: 1px solid #ddd;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    background: #f9f9f9;
    border-radius: 4px;
}

.media-preview img {
    max-width: 100%;
    max-height: 100%;
    height: auto;
}

/* Header Buttons Field Styles */
.header-buttons-field,
.menu-field {
    margin-top: 10px;
}

.header-buttons,
.menu-items {
    margin-bottom: 10px;
    max-height: 300px;
    overflow-y: auto;
    padding: 15px;
    border: 1px solid #ddd;
    background: #f9f9f9;
    border-radius: 4px;
}

.header-button-item,
.menu-item {
    margin-bottom: 15px;
    padding: 15px;
    border: 1px solid #ddd;
    background: #fff;
    border-radius: 4px;
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
}

.header-button-item:last-child,
.menu-item:last-child {
    margin-bottom: 0;
}

.header-button-item div,
.menu-item div {
    margin-bottom: 10px;
}

.header-button-item div:last-child,
.menu-item div:last-child {
    margin-bottom: 0;
}

.header-button-item label,
.menu-item label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

/* Footer Content Field Styles */
.footer-content-field h4 {
    margin: 20px 0 10px;
    padding-bottom: 10px;
    border-bottom: 1px solid #eee;
    font-size: 16px;
    color: #23282d;
}

.footer-links {
    margin-bottom: 10px;
    max-height: 200px;
    overflow-y: auto;
    padding: 15px;
    border: 1px solid #ddd;
    background: #f9f9f9;
    border-radius: 4px;
}

.footer-link-item {
    display: flex;
    gap: 10px;
    margin-bottom: 10px;
    padding: 10px;
    border: 1px solid #ddd;
    background: #fff;
    border-radius: 4px;
}

.footer-link-item:last-child {
    margin-bottom: 0;
}

.footer-link-item input {
    flex: 1;
}

/* Spacing Field Styles */
.spacing-field {
    display: flex;
    gap: 20px;
}

.spacing-field > div {
    flex: 1;
}

.spacing-field label {
    display: block;
    margin-bottom: 5px;
    font-weight: 500;
}

/* Item Counter (hidden field for tracking dynamic items) */
.item-counter {
    display: none;
}-e 

===== ./css/fixes.css =====

/*
Theme Name: Yiontech LMS Fixes
Description: Fixes for theme layout and functionality issues
Version: 1.0.0
*/

/* Reset and base styles */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html, body {
    height: 100%;
    overflow-x: hidden;
    width: 100%;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    line-height: 1.6;
    color: #333;
    background-color: #fff;
    display: flex;
    flex-direction: column;
}

.site-content {
    flex: 1;
    overflow: hidden;
    width: 100%;
}

/* Custom Logo Size */
.custom-logo {
    max-height: 36px;
    width: auto;
}

/* Header Adjustments */
.site-header {
    padding: 0;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    z-index: 999;
}

.site-branding img {
    max-height: 36px;
    width: auto;
}

/* Navigation Menu */
.main-navigation ul {
    list-style: none;
    margin: 0;
    padding: 0;
}

.main-navigation ul li {
    position: relative;
}

.main-navigation ul li a {
    color: white;
    text-decoration: none;
    font-weight: 500;
    font-size: 0.95rem;
    transition: all 0.3s ease;
    padding: 0.25rem 0;
}

.main-navigation ul li a:hover {
    color: rgba(255, 255, 255, 0.8);
}

/* Mobile Menu Toggle */
#mobile-menu-toggle {
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 0.25rem;
    border-radius: 0.25rem;
    transition: background-color 0.2s;
}

#mobile-menu-toggle:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

/* Mobile Menu Sidebar */
#mobile-menu-sidebar {
    width: 80%;
    max-width: 320px;
    box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
    z-index: 9999;
    transform: translateX(100%);
    transition: transform 0.3s ease-in-out;
}

#mobile-menu-sidebar.translate-x-full {
    transform: translateX(100%);
}

#mobile-menu-sidebar:not(.translate-x-full) {
    transform: translateX(0);
}

#mobile-menu-sidebar ul {
    list-style: none;
    margin: 0;
    padding: 0;
}

#mobile-menu-sidebar ul li {
    margin-bottom: 0.5rem;
}

#mobile-menu-sidebar ul li a {
    color: #4B5563;
    text-decoration: none;
    font-weight: 500;
    padding: 0.5rem 0;
    display: block;
    transition: color 0.3s ease;
}

#mobile-menu-sidebar ul li a:hover {
    color: #2563EB;
}

/* Mobile Menu Sections */
#mobile-menu-sidebar .border-b {
    border-bottom: 1px solid #E5E7EB;
}

#mobile-menu-sidebar h3 {
    color: #1F2937;
    font-weight: 600;
}

/* Mobile Menu Overlay */
#mobile-menu-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 9998;
}

/* Course Card Adjustments */
.course-thumbnail {
    height: 180px;
}

/* Pagination Adjustments */
.page-numbers {
    display: inline-block;
    padding: 0.5rem 0.75rem;
    margin: 0 0.25rem;
    border-radius: 0.375rem;
    background-color: #f3f4f6;
    color: #4b5563;
    text-decoration: none;
}

.page-numbers.current {
    background-color: #2563eb;
    color: white;
}

.page-numbers:hover {
    background-color: #e5e7eb;
}

.page-numbers.current:hover {
    background-color: #1d4ed8;
}

/* Footer Adjustments */
footer ul {
    list-style: none;
    margin: 0;
    padding: 0;
}

footer ul li {
    margin-bottom: 0.5rem;
}

footer ul li a {
    color: #9CA3AF;
    text-decoration: none;
    transition: color 0.3s ease;
    display: inline-block;
}

footer ul li a:hover {
    color: white;
}

/* Newsletter Form */
.newsletter-form input[type="email"] {
    background-color: #1F2937;
    border: 1px solid #374151;
}

.newsletter-form input[type="email"]:focus {
    border-color: #3B82F6;
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.newsletter-form button {
    background-color: #2563EB;
    border: none;
}

.newsletter-form button:hover {
    background-color: #1D4ED8;
}

/* Mobile Menu Newsletter Form */
#mobile-menu-sidebar form input[type="email"] {
    border: 1px solid #D1D5DB;
}

#mobile-menu-sidebar form input[type="email"]:focus {
    border-color: #3B82F6;
    outline: none;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

#mobile-menu-sidebar form button {
    background-color: #2563EB;
    border: none;
}

#mobile-menu-sidebar form button:hover {
    background-color: #1D4ED8;
}

/* Preloader Styles */
#preloader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #ffffff;
    z-index: 99999;
    display: flex;
    justify-content: center;
    align-items: center;
}

.preloader-spinner {
    width: 80px;
    height: 80px;
    position: relative;
    display: block;
}

.spinner {
    width: 80px;
    height: 80px;
    border: 8px solid rgba(30, 64, 175, 0.2);
    border-top: 8px solid #1e40af;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    display: block;
    box-sizing: border-box;
    background-color: transparent;
}

.spinner::before {
    content: "";
    position: absolute;
    top: 5px;
    left: 5px;
    right: 5px;
    bottom: 5px;
    border-radius: 50%;
    border: 4px solid transparent;
    border-top-color: #3b82f6;
    animation: spin 2s linear infinite;
}

.spinner::after {
    content: "";
    position: absolute;
    top: 15px;
    left: 15px;
    right: 15px;
    bottom: 15px;
    border-radius: 50%;
    border: 2px solid transparent;
    border-top-color: #60a5fa;
    animation: spin 3s linear infinite;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Sticky header styles */
.site-header.sticky {
    position: sticky;
    top: 0;
    z-index: 999;
    width: 100%;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}

.site-header.scrolled {
    background-color: #1e40af;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

/* Ensure body can scroll if needed */
html, body {
    height: auto;
    min-height: 100vh;
    overflow-x: hidden;
}

/* Responsive adjustments */
@media (max-width: 1279px) {
    .site-header .flex.items-center.space-x-3 {
        gap: 0.5rem;
        flex-wrap: wrap;
        justify-content: flex-end;
    }
    
    .site-header .flex.items-center.space-x-3 a {
        margin-left: 0.25rem;
    }
}

/* Fix for overflow issues */
.container, .max-w-7xl {
    overflow: hidden;
    width: 100%;
}

/* Remove all horizontal lines and unnecessary borders */
hr {
    display: none;
}

/* Remove borders from specific elements that might be causing the issue */
.site-header, footer, .site-content, .container, 
.main-navigation, .sidebar, .widget, .course-thumbnail,
.post-thumbnail, .content, .comments-area, .comment-list,
.comment-form, .page-links, .tagcloud, .wp-block,
.entry-content, .entry-header, .entry-footer, .entry-summary {
    border: none;
    box-shadow: none;
}

/* Remove any background images that might look like lines */
body, .site-header, footer, .site-content, .container {
    background-image: none;
}

/* Remove any text-decoration that might look like lines */
a, a:hover, a:focus, a:active {
    text-decoration: none;
    border-bottom: none;
}

/* Remove any outlines */
:focus {
    outline: none;
    outline-width: 0;
    outline-style: none;
    outline-color: transparent;
}

/* Remove any pseudo-elements that might be adding lines */
::before, ::after {
    border: none;
    border-top: none;
    border-bottom: none;
    border-left: none;
    border-right: none;
}

/* Cookie consent banner */
.cookie-consent-banner {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: #1e293b;
    color: white;
    padding: 15px;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
    flex-direction: row;
}

.cookie-consent-content {
    flex: 1;
    margin-right: 15px;
}

.cookie-consent-buttons {
    display: flex;
    gap: 10px;
}

.cookie-consent-buttons .button {
    padding: 8px 16px;
    border-radius: 4px;
    font-weight: 500;
    cursor: pointer;
    border: none;
}

.cookie-consent-accept {
    background: #3b82f6;
    color: white;
}

.cookie-consent-accept:hover {
    background: #2563eb;
}

.cookie-consent-learn {
    background: transparent;
    color: white;
    border: 1px solid white;
}

.cookie-consent-learn:hover {
    background: rgba(255,255,255,0.1);
}

/* Auth page specific styles */
.login-page, .register-page {
    background-color: #f9fafb;
}

.login-page .site-content, .register-page .site-content {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem 0;
}

.login-page .custom-auth-form, .register-page .custom-auth-form {
    background: #fff;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    padding: 2rem;
    width: 100%;
    max-width: 28rem;
}

.login-page .custom-auth-form h2, .register-page .custom-auth-form h2 {
    text-align: center;
    margin-bottom: 1.5rem;
    color: #1f2937;
    font-size: 1.5rem;
    font-weight: 700;
}

.login-page .auth-form .form-group, .register-page .auth-form .form-group {
    margin-bottom: 1.25rem;
}

.login-page .auth-form label, .register-page .auth-form label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: #374151;
}

.login-page .auth-form input[type="text"],
.login-page .auth-form input[type="email"],
.login-page .auth-form input[type="password"],
.login-page .auth-form input[type="tel"],
.register-page .auth-form input[type="text"],
.register-page .auth-form input[type="email"],
.register-page .auth-form input[type="password"],
.register-page .auth-form input[type="tel"],
.register-page .auth-form textarea {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 1rem;
    transition: border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
}

.login-page .auth-form input:focus,
.register-page .auth-form input:focus,
.register-page .auth-form textarea:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.login-page .auth-form .button, .register-page .auth-form .button {
    display: block;
    width: 100%;
    padding: 0.75rem;
    background-color: #1e40af;
    color: white;
    border: none;
    border-radius: 0.375rem;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.15s ease-in-out;
}

.login-page .auth-form .button:hover, .register-page .auth-form .button:hover {
    background-color: #1e3a8a;
}

.login-page .auth-links, .register-page .auth-links {
    text-align: center;
    margin-top: 1.5rem;
    color: #6b7280;
}

.login-page .auth-links a, .register-page .auth-links a {
    color: #1e40af;
    text-decoration: none;
    font-weight: 500;
}

.login-page .auth-links a:hover, .register-page .auth-links a:hover {
    text-decoration: underline;
}

.login-page .auth-message, .register-page .auth-message {
    margin-top: 1rem;
    padding: 0.75rem;
    border-radius: 0.375rem;
    text-align: center;
}

.login-page .error-message, .register-page .error-message {
    background-color: #fee;
    color: #c33;
    border: 1px solid #fcc;
}

/* Fix